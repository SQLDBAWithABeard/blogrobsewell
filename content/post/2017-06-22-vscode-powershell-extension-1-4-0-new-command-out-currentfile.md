---
title: "VSCode â€“ PowerShell extension 1.4.0 new command Out-CurrentFile"
date: "2017-06-22" 
categories:
  - Blog

tags:
  - dbatools
  - pester
  - PowerShell

---
<P>Yesterday <A href="https://twitter.com/daviwil" rel=noopener target=_blank>David Wilson</A> announced version 1.4.0 of the <A href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.PowerShell" rel=noopener target=_blank>PowerShell extension for VSCode</A></P>
<BLOCKQUOTE class=twitter-tweet data-width="550">
<P lang=en dir=ltr>Just released <A href="https://twitter.com/hashtag/PowerShell?src=hash">#PowerShell</A> for VS <A href="https://twitter.com/code">@Code</A> 1.4.0 with new code formatting presets and custom HTML content view APIs! <A href="https://t.co/RPLcIYqBYL">https://t.co/RPLcIYqBYL</A> <A href="https://t.co/FnnNLjVyMo">pic.twitter.com/FnnNLjVyMo</A></P>
<P>â€” David Wilson (@daviwil) <A href="https://twitter.com/daviwil/status/877559988809457671">June 21, 2017</A></P></BLOCKQUOTE>
<P>
<SCRIPT charset=utf-8 src="//platform.twitter.com/widgets.js" async></SCRIPT>
</P>
<P>He also pointed out that there have been over 1 million installs of the extension. ðŸ™‚</P>
<P>If you want to install the PowerShell extension you can hit F1 in VSCode and type</P><PRE class="lang:ps decode:true">ext install PowerShell</PRE>
<P>or CTRL + SHIFT + X to open the extensions side bar and search for PowerShell and click the green install button.</P>
<P>There are a few enhancements in this release <A href="https://github.com/PowerShell/PowerShellEditorServices/blob/master/CHANGELOG.md" rel=noopener target=_blank>which you can read about here</A> but I noticed the New File API and <A href="https://github.com/PowerShell/PowerShellEditorServices/blob/7eca46fc7484e5a080e2476ee0ddc5298954216b/module/docs/Out-CurrentFile.md" rel=noopener target=_blank>Out-CurrentFile </A>command that were contributed by <A href="https://twitter.com/dfinke" rel=noopener target=_blank>Doug Finke</A>.</P>
<P>If your focus is in the editor in VSCode, you can simply CTRL + N and create a new file. You can alter the language that the file uses with CTRL + K, M (thatâ€™s CTRL and K and then M not CTRL and K and M!) or set the default new file language <A href="https://blog.robsewell.com/setting-the-default-file-type-for-a-new-file-in-vs-code/">as I described here</A>.</P>
<P><IMG class="alignnone size-full wp-image-6247" alt="01 -new file.gif" src="https://blog.robsewell.com/assets/uploads/2017/06/01-new-file.gif?resize=630%2C341&amp;ssl=1" width=630 height=341 data-recalc-dims="1" loading="lazy" data-large-file="https://blog.robsewell.com/assets/uploads/2017/06/01-new-file.gif?fit=630%2C341&amp;ssl=1" data-medium-file="https://blog.robsewell.com/assets/uploads/2017/06/01-new-file.gif?fit=300%2C162&amp;ssl=1" data-image-description="" data-image-title="01 -new file" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-comments-opened="1" data-orig-size="2202,1192" data-orig-file="https://blog.robsewell.com/assets/uploads/2017/06/01-new-file.gif?fit=2202%2C1192&amp;ssl=1" data-permalink="https://blog.robsewell.com/vscode-powershell-extension-1-4-0-new-command-out-currentfile/01-new-file/#main" data-attachment-id="6247"></P>
<P>If you are using VSCode as your daily PowerShell command line though, you would have to alter your focus from the terminal panel into the editor to do this. Now though you have</P><PRE class="lang:ps decode:true">$psEditor.Workspace.NewFile()</PRE>
<P>which enables you to create a new file from the terminal</P>
<P><IMG class="alignnone size-full wp-image-6256" alt="02- Another new file.gif" src="https://blog.robsewell.com/assets/uploads/2017/06/02-another-new-file.gif?resize=630%2C341&amp;ssl=1" width=630 height=341 data-recalc-dims="1" loading="lazy" data-large-file="https://blog.robsewell.com/assets/uploads/2017/06/02-another-new-file.gif?fit=630%2C341&amp;ssl=1" data-medium-file="https://blog.robsewell.com/assets/uploads/2017/06/02-another-new-file.gif?fit=300%2C162&amp;ssl=1" data-image-description="" data-image-title="02- Another new file" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-comments-opened="1" data-orig-size="2202,1192" data-orig-file="https://blog.robsewell.com/assets/uploads/2017/06/02-another-new-file.gif?fit=2202%2C1192&amp;ssl=1" data-permalink="https://blog.robsewell.com/vscode-powershell-extension-1-4-0-new-command-out-currentfile/02-another-new-file/#main" data-attachment-id="6256"></P>
<P>The&nbsp;<A href="https://github.com/PowerShell/PowerShellEditorServices/blob/7eca46fc7484e5a080e2476ee0ddc5298954216b/module/docs/Out-CurrentFile.md" rel=noopener target=_blank>Out-CurrentFile</A> command sends the output of a command through Out-String to a new file. This makes it much easier to keep the results of some commands. You donâ€™t have to pipe them to clip or highlight and CTRL + C to copy them and then open a&nbsp; file and paste them. Of course you can use <A href="https://msdn.microsoft.com/en-us/powershell/reference/5.1/microsoft.powershell.utility/out-file" rel=noopener target=_blank>Out-File</A> and then open the file but this is another way.</P>
<P>Lets see how it works. In this example, I want to export the T-SQL for creating the logins on an instance and add some comments to the code before saving it somewhere safely. I am going to use the <A href="https://dbatools.io/functions/export-sqllogin/" rel=noopener target=_blank>Export-SQLLogin</A> command from the <A href="https://dbatools.io" rel=noopener target=_blank>dbatools </A>module. <A href="https://twitter.com/ClaudioESSilva" rel=noopener target=_blank>MVP ClÃ¡udio Silva</A> has <A href="http://redglue.eu/have-you-backed-up-your-sql-logins-today/" rel=noopener target=_blank>written a great post on that command today</A>.</P>
<P>First create a new file</P><PRE class="lang:ps decode:true">$psEditor.Workspace.NewFile()</PRE>
<P>and then</P><PRE class="lang:ps decode:true">Export-SqlLogin -SqlInstance . | Out-CurrentFile</PRE>
<P><IMG class="alignnone wp-image-6311" alt="" src="https://blog.robsewell.com/assets/uploads/2017/06/03-sql-file.gif?resize=630%2C366&amp;ssl=1" width=630 height=366 data-recalc-dims="1" loading="lazy" data-large-file="https://blog.robsewell.com/assets/uploads/2017/06/03-sql-file.gif?fit=630%2C365&amp;ssl=1" data-medium-file="https://blog.robsewell.com/assets/uploads/2017/06/03-sql-file.gif?fit=300%2C174&amp;ssl=1" data-image-description="" data-image-title="03 â€“ sql file" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-comments-opened="1" data-orig-size="2182,1265" data-orig-file="https://blog.robsewell.com/assets/uploads/2017/06/03-sql-file.gif?fit=2182%2C1265&amp;ssl=1" data-permalink="https://blog.robsewell.com/vscode-powershell-extension-1-4-0-new-command-out-currentfile/03-sql-file/#main" data-attachment-id="6311"></P>
<P>In the gif above</P>
<UL>
<LI>I create a new file, 
<LI>Export the logins to it 
<LI>change the language of the file to T-SQL 
<LI>remove the string quotes and 
<LI>add some comments. </LI></UL>
<P>All without leaving VSCode, just another reason that <A href="https://blog.robsewell.com/why-vs-code-increases-my-productivity/" rel=noopener target=_blank>my productivity is increased using VSCode!</A></P>
<P>Unfortunately, it doesnâ€™t work so well with Pester. (Of course I was going to try Pester!). This makes sense though, as Pester uses Write-Host to display the test results so nothing is going to the output stream so</P><PRE class="lang:ps decode:true">Invoke-Pester '.\SQL Grillen\Demo Number 3.Tests.ps1' | Out-CurrentFile</PRE>
<P>returns this</P>
<P><IMG class="alignnone size-full wp-image-6295" alt="04 - pester.PNG" src="https://blog.robsewell.com/assets/uploads/2017/06/04-pester.png?resize=630%2C377&amp;ssl=1" width=630 height=377 data-recalc-dims="1" loading="lazy" data-large-file="https://blog.robsewell.com/assets/uploads/2017/06/04-pester.png?fit=630%2C377&amp;ssl=1" data-medium-file="https://blog.robsewell.com/assets/uploads/2017/06/04-pester.png?fit=300%2C179&amp;ssl=1" data-image-description="" data-image-title="04 â€“ pester" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-comments-opened="1" data-orig-size="2380,1424" data-orig-file="https://blog.robsewell.com/assets/uploads/2017/06/04-pester.png?fit=2380%2C1424&amp;ssl=1" data-permalink="https://blog.robsewell.com/vscode-powershell-extension-1-4-0-new-command-out-currentfile/04-pester/#main" data-attachment-id="6295"></P>
<P>and if you use the -PassThru parameter then you get the $Tests object as a string so</P><PRE class="lang:ps decode:true ">&amp;nbsp;Invoke-Pester '.\SQL Grillen\Demo Number 3.Tests.ps1'-Show Summary -PassThru | Out-CurrentFile</PRE>
<P>shows</P>
<P><IMG class="alignnone size-full wp-image-6301" alt="05 - pester object.PNG" src="https://blog.robsewell.com/assets/uploads/2017/06/05-pester-object.png?resize=630%2C263&amp;ssl=1" width=630 height=263 data-recalc-dims="1" loading="lazy" data-large-file="https://blog.robsewell.com/assets/uploads/2017/06/05-pester-object.png?fit=630%2C263&amp;ssl=1" data-medium-file="https://blog.robsewell.com/assets/uploads/2017/06/05-pester-object.png?fit=300%2C125&amp;ssl=1" data-image-description="" data-image-title="05 â€“ pester object" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-comments-opened="1" data-orig-size="2933,1226" data-orig-file="https://blog.robsewell.com/assets/uploads/2017/06/05-pester-object.png?fit=2933%2C1226&amp;ssl=1" data-permalink="https://blog.robsewell.com/vscode-powershell-extension-1-4-0-new-command-out-currentfile/05-pester-object/#main" data-attachment-id="6301"></P>
<P>Which isnâ€™t what I would need but I have other ways of working with Pester output.</P>

