---
title: "#TSQL2sDay ‚Äì Starting Out with PowerShell"
slug: "TSQL2sDay ‚Äì Starting Out with PowerShell"
date: "2017-09-12"
categories:
  - Blog

tags:
  - TSql2sDay
  - dbatools
  - PowerShell
  - sqlserver

---
<P><A href="https://blog.robsewell.com/tsql2sday-94-lets-get-all-posh/" rel=noopener target=_blank><IMG class=" size-full wp-image-7206 alignright" alt=tsql2sday src="https://blog.robsewell.com/assets/uploads/2017/08/tsql2sday.jpg?resize=244%2C244&amp;ssl=1" width=244 height=244 data-recalc-dims="1" loading="lazy" data-large-file="https://blog.robsewell.com/assets/uploads/2017/08/tsql2sday.jpg?fit=244%2C244&amp;ssl=1" data-medium-file="https://blog.robsewell.com/assets/uploads/2017/08/tsql2sday.jpg?fit=244%2C244&amp;ssl=1" data-image-description="" data-image-title="tsql2sday" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-comments-opened="1" data-orig-size="244,244" data-orig-file="https://blog.robsewell.com/assets/uploads/2017/08/tsql2sday.jpg?fit=244%2C244&amp;ssl=1" data-permalink="https://blog.robsewell.com/i-hate-interviews-tsql2sday/tsql2sday/#main" data-attachment-id="7206"></A>This months TSQL2sday is hosted by me!</P>
<P>Surprise! ‚Äì <A href="https://blog.robsewell.com/tsql2sday-94-lets-get-all-posh/" rel=noopener target=_blank>I chose PowerShell</A></P>
<P>I am really looking forward to seeing what other people post. Some advanced scripts that will help you and show you how you can use PowerShell to save you time and hopefully some beginner posts explaining experiences or showing you how to start with PowerShell and SQL Server. I decided to go with the latter.</P>
<H2>First though a warning.</H2>
<P>PowerShell is another language, you are not going to be as proficient in a new language as you are in the language you spend all day working with. You will have to go through the learning curve and you will have to understand how to interpret errors. There is a learning curve just like with any language. Undoubtedly you will get frustrated at times. Reach out for help. Use twitter, use the #powershellhelp in the <A href="https://sqlps.io/slack" rel=noopener target=_blank>SQL Server Community Slack channel</A>. There are many other places and plenty of people who will be glad to help you.</P>
<H2>Open the Editor</H2>
<P>If you are using a Windows machine you will have PowerShell installed. You will find it in your start menu on Windows 7 under All Programs, Accessories, Windows PowerShell folder, and then click Windows PowerShell or Windows PowerShell ISE. On Windows 8 or 10 search for PowerShell.</P>
<P>PowerShell or PowerShell ISE? Use PowerShell instead of cmd.exe for command line usage and ISE for developing scripts, functions and modules. (However, read on before making your choice)</P>
<H2>PowerShell on Other O/S‚Äôs (and Windows!)</H2>
<P>Just as <A href="http://sqlserveronlinux.com" rel=noopener target=_blank>SQL Server is available on Linux</A> PowerShell is also available cross-platform, you can run and edit PowerShell on Linux and on Mac natively. The best editor to use is <A href="https://code.visualstudio.com/" rel=noopener target=_blank>VS Code</A> which is also available cross-platform. In fact, as Microsofts <A href="https://twitter.com/daviwil" rel=noopener target=_blank>David Wilson</A> says in this <A href="https://blogs.msdn.microsoft.com/powershell/2017/05/10/announcing-powershell-for-visual-studio-code-1-0/" rel=noopener target=_blank>blog post</A></P>
<BLOCKQUOTE>
<P>The PowerShell ISE has been the official editor for PowerShell throughout most of the history of Windows PowerShell. Now with the advent of the cross-platform PowerShell Core, we need a new official editor that‚Äôs available across all supported OS platforms and versions. Visual Studio Code is now that editor and the majority of our effort will be focused there.</P></BLOCKQUOTE>
<P>So my advice is, whichever operating system you are using, use VS Code to write, edit, debug and run your PowerShell as that is the editor where Microsoft are spending the majority of their effort in development. <A href="https://github.com/PowerShell/vscode-powershell#quick-installation" rel=noopener target=_blank>Follow the instructions here to install</A> You can also use it with <A href="https://blog.robsewell.com/running-sql-queries-with-visual-studio-code/" rel=noopener target=_blank>many other languages including T-SQL</A>. I find it a <A href="https://blog.robsewell.com/why-vs-code-increases-my-productivity/" rel=noopener target=_blank>very useful tool</A></P>
<H2>Where to start?</H2>
<P>Well that depends what you want to do. Start by reading. Start by trying to accomplish something in PowerShell even if you know how to do it another way. This will also help you to realise when you are trying to use a hammer to put in a screw (using the wrong tool for the job)</P>
<H2>What Command?</H2>
<P>You don‚Äôt know where to start so how do you know the command to use? Here is a first command. You will use it often. I use it everyday still despite using PowerShell daily for many years. But don‚Äôt run it yet!</P><PRE class="lang:ps decode:true">Get-Command</PRE>
<P>PowerShell is quite intuitive in it‚Äôs command naming. It uses a Verb-Noun syntax. You know without me explaining what this command will do. It will ‚ÄúGet‚Äù the ‚ÄúCommand‚Äù (s). PowerShell uses singular nouns for its commands. I have 8000+ commands on my machine so it would have overloaded you with commands if you had run it without filters!</P>
<P>We use * as a wildcard in PowerShell so we can use that with our <A href="https://docs.microsoft.com/powershell/module/Microsoft.PowerShell.Core/Get-Command?view=powershell-5.1" rel=noopener target=_blank>Get-Command </A>command to find some commands to run. Type Get-Com and then hit the tab button. This will not only help you as it will auto-complete, it will reduce the number of errors as it will only auto-complete correct command names :-).</P><PRE class="lang:ps decode:true">Get-Command *service</PRE>
<P>This will show all commands which end with service. The results will have some different headings. The screenshot below shows just one command to reduce confusion.</P>
<P><IMG class="alignnone size-full wp-image-7909" alt="03 - get-service.png" src="https://blog.robsewell.com/assets/uploads/2017/09/03-get-service.png?resize=630%2C70&amp;ssl=1" width=630 height=70 sizes="(max-width: 630px) 100vw, 630px" data-recalc-dims="1" loading="lazy" data-large-file="https://blog.robsewell.com/assets/uploads/2017/09/03-get-service.png?fit=630%2C70&amp;ssl=1" data-medium-file="https://blog.robsewell.com/assets/uploads/2017/09/03-get-service.png?fit=300%2C34&amp;ssl=1" data-image-description="" data-image-title="03 ‚Äì get-service" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-comments-opened="1" data-orig-size="2603,291" data-orig-file="https://blog.robsewell.com/assets/uploads/2017/09/03-get-service.png?fit=2603%2C291&amp;ssl=1" data-permalink="https://blog.robsewell.com/03-get-service/" data-attachment-id="7909" srcset="https://blog.robsewell.com/assets/uploads/2017/09/03-get-service.png?w=2603&amp;ssl=1 2603w,https://blog.robsewell.com/assets/uploads/2017/09/03-get-service.png?resize=300%2C34&amp;ssl=1 300w,https://blog.robsewell.com/assets/uploads/2017/09/03-get-service.png?resize=768%2C86&amp;ssl=1 768w,https://blog.robsewell.com/assets/uploads/2017/09/03-get-service.png?resize=1024%2C114&amp;ssl=1 1024w,https://blog.robsewell.com/assets/uploads/2017/09/03-get-service.png?w=1260&amp;ssl=1 1260w,https://blog.robsewell.com/assets/uploads/2017/09/03-get-service.png?w=1890&amp;ssl=1 1890w"></P>
<P>The type of command, the name of the command, the version of the command and the module it is in. PowerShell uses modules to group commands together and to enable you to install the ones that you require from a repository like the <A href="https://www.powershellgallery.com/" rel=noopener target=_blank>PowerShell Gallery</A> (more on this later).</P>
<P>You can find all of the commands in a module with the <A href="https://docs.microsoft.com/powershell/module/Microsoft.PowerShell.Core/Get-Command?view=powershell-5.1" rel=noopener target=_blank>Get-Command</A> command like this</P><PRE class="lang:ps decode:true">Get-Command -Module microsoft.powershell.management</PRE>
<P>This will show you all of the commands in the management module which may be a good place to start exploring. In this module for example</P>
<UL>
<LI><A href="https://docs.microsoft.com/powershell/module/Microsoft.PowerShell.Management/Test-Connection?view=powershell-5.1" rel=noopener target=_blank>Test-Connection</A> is like ping but better
<LI><A href="https://docs.microsoft.com/powershell/module/Microsoft.PowerShell.Management/Test-Path?view=powershell-5.1" rel=noopener target=_blank>Test-Path</A> tests the existence of files and file paths
<LI>*-Service works with services
<LI>*-Process works with processes
<LI>*-Computer for power options for a computer
<LI><A href="https://docs.microsoft.com/powershell/module/Microsoft.PowerShell.Management/Get-ComputerInfo?view=powershell-5.1" rel=noopener target=_blank>Get-ComputerInfo</A> which will give you computer information (surprisingly üôÇ ) </LI></UL>
<P>This is also something to remember in the future when you want to know what commands a module has or what the precise name of the command is.</P>
<P>Maybe once you install the <A href="https://dbatools.io" rel=noopener target=_blank>dbatools module</A>, the <A href="https://docs.microsoft.com/en-us/powershell/module/sqlserver/?view=sqlserver-ps" rel=noopener target=_blank>sqlserver module </A>or the <A href="https://github.com/Microsoft/ReportingServicesTools" rel=noopener target=_blank>SSRS module</A>??</P>
<P>HOMEWORK ‚Äì Examine the names of commands in other modules that you find in</P><PRE class="lang:ps decode:true">Get-Module</PRE>
<P>or for more choices</P><PRE class="lang:ps decode:true">Get-Module -ListAvailable</PRE>
<H2>How do I use that command though?</H2>
<P>You need to read! PowerShell comes with a lot of documentation, a lot of it is available on your machine. Lets introduce another command</P><PRE class="lang:ps decode:true">Get-Help</PRE>
<P>As you can imagine, this gets the help for a command or returns help topics about PowerShell. Again, I use this every single day and you should too. Lets start with the first one. Lets get help for the <A href="https://docs.microsoft.com/en-gb/powershell/module/Microsoft.PowerShell.Management/Get-ChildItem?view=powershell-5.1" rel=noopener target=_blank>Get-ChildItem</A> command</P><PRE class="lang:ps decode:true">Get-Help Get-ChildItem</PRE>
<P>Now, some of you may not get very much returned and a message at the bottom which says</P>
<BLOCKQUOTE>
<P>Get-Help cannot find the Help files for this cmdlet on this computer. It is displaying only partial help.<BR>‚Äî To download and install Help files for the module that includes this cmdlet, use Update-Help.<BR>‚Äî To view the Help topic for this cmdlet online, type: ‚ÄúGet-Help Get-ChildItem -Online‚Äù or<BR>go to <A href="https://go.microsoft.com/fwlink/?LinkID=113308" rel=nofollow>https://go.microsoft.com/fwlink/?LinkID=113308</A>.</P></BLOCKQUOTE>
<P>When you have something else to do I would recommend running <A href="https://docs.microsoft.com/en-gb/powershell/module/microsoft.powershell.core/update-help?view=powershell-5.1" rel=noopener target=_blank>Update-Help </A>as it suggests (It can take a few minutes to run) but for now make use of the -Online switch.</P>
<P>HOMEWORK ‚Äì Run <A href="https://docs.microsoft.com/en-gb/powershell/module/microsoft.powershell.core/update-help?view=powershell-5.1" rel=noopener target=_blank>Update-Help</A></P><PRE class="lang:ps decode:true">Get-Help Get-ChildItem -Online</PRE>
<P>This is available for all of the Microsoft modules and some of the better open source modules, <A href="https://dbatools.io" rel=noopener target=_blank>dbatools</A> is an example of a (brilliant) community module which has -Online URLs for it‚Äôs commands. Running <A href="https://docs.microsoft.com/en-gb/powershell/module/Microsoft.PowerShell.Core/Get-Help?view=powershell-5.1" rel=noopener target=_blank>Get-Help</A> (with or without the -Online switch) will give you plenty of information about the command, the switches available, the inputs and outputs.</P>
<P>Maybe start by using the -examples switch</P><PRE class="lang:ps decode:true">Get-Help Get-ChildItem -Examples</PRE>
<P>will show you some examples of how to use the command</P>
<P><IMG class="alignnone size-full wp-image-7963" alt="05 gethelp examples" src="https://blog.robsewell.com/assets/uploads/2017/09/05-gethelp-examples.png?resize=630%2C221&amp;ssl=1" width=630 height=221 sizes="(max-width: 630px) 100vw, 630px" data-recalc-dims="1" loading="lazy" data-large-file="https://blog.robsewell.com/assets/uploads/2017/09/05-gethelp-examples.png?fit=630%2C221&amp;ssl=1" data-medium-file="https://blog.robsewell.com/assets/uploads/2017/09/05-gethelp-examples.png?fit=300%2C105&amp;ssl=1" data-image-description="" data-image-title="05 gethelp examples" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-comments-opened="1" data-orig-size="2955,1036" data-orig-file="https://blog.robsewell.com/assets/uploads/2017/09/05-gethelp-examples.png?fit=2955%2C1036&amp;ssl=1" data-permalink="https://blog.robsewell.com/05-gethelp-examples/" data-attachment-id="7963" srcset="https://blog.robsewell.com/assets/uploads/2017/09/05-gethelp-examples.png?w=2955&amp;ssl=1 2955w,https://blog.robsewell.com/assets/uploads/2017/09/05-gethelp-examples.png?resize=300%2C105&amp;ssl=1 300w,https://blog.robsewell.com/assets/uploads/2017/09/05-gethelp-examples.png?resize=768%2C269&amp;ssl=1 768w,https://blog.robsewell.com/assets/uploads/2017/09/05-gethelp-examples.png?resize=1024%2C359&amp;ssl=1 1024w,https://blog.robsewell.com/assets/uploads/2017/09/05-gethelp-examples.png?w=1260&amp;ssl=1 1260w,https://blog.robsewell.com/assets/uploads/2017/09/05-gethelp-examples.png?w=1890&amp;ssl=1 1890w"></P>
<P>Now you can start to explore the file system with this command (also the SQL Server, Registry, Certificate Store and many more things)</P>
<P>I also like to use the ShowWindow switch</P><PRE class="lang:ps decode:true">Get-Help Get-ChildItem -ShowWindow</PRE>
<P>which will open up the help in a separate window which can be useful when you are writing a script and it is searchable</P>
<P><IMG class="alignnone size-full wp-image-7955" alt="04 - gethelp showwindo" src="https://blog.robsewell.com/assets/uploads/2017/09/04-gethelp-showwindo.png?resize=630%2C170&amp;ssl=1" width=630 height=170 sizes="(max-width: 630px) 100vw, 630px" data-recalc-dims="1" loading="lazy" data-large-file="https://blog.robsewell.com/assets/uploads/2017/09/04-gethelp-showwindo.png?fit=630%2C170&amp;ssl=1" data-medium-file="https://blog.robsewell.com/assets/uploads/2017/09/04-gethelp-showwindo.png?fit=300%2C81&amp;ssl=1" data-image-description="" data-image-title="04 ‚Äì gethelp showwindo" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-comments-opened="1" data-orig-size="3016,813" data-orig-file="https://blog.robsewell.com/assets/uploads/2017/09/04-gethelp-showwindo.png?fit=3016%2C813&amp;ssl=1" data-permalink="https://blog.robsewell.com/04-gethelp-showwindo/" data-attachment-id="7955" srcset="https://blog.robsewell.com/assets/uploads/2017/09/04-gethelp-showwindo.png?w=3016&amp;ssl=1 3016w,https://blog.robsewell.com/assets/uploads/2017/09/04-gethelp-showwindo.png?resize=300%2C81&amp;ssl=1 300w,https://blog.robsewell.com/assets/uploads/2017/09/04-gethelp-showwindo.png?resize=768%2C207&amp;ssl=1 768w,https://blog.robsewell.com/assets/uploads/2017/09/04-gethelp-showwindo.png?resize=1024%2C276&amp;ssl=1 1024w,https://blog.robsewell.com/assets/uploads/2017/09/04-gethelp-showwindo.png?w=1260&amp;ssl=1 1260w,https://blog.robsewell.com/assets/uploads/2017/09/04-gethelp-showwindo.png?w=1890&amp;ssl=1 1890w"></P>
<P>But Chrissy prefers to use the -Detailed switch</P><PRE class="lang:ps decode:true ">Get-Help Get-ChildItem -Detailed</PRE>
<P>You can decide which way you like best.</P>
<P>Now you know how to find a command and hot to find out how to use it. If you are using VS Code (or ISE) you have access to Intellisense and snippets to help you with the syntax. You can run a command and get some results.</P>
<P>HOMEWORK ‚Äì Use <A href="https://docs.microsoft.com/en-gb/powershell/module/Microsoft.PowerShell.Core/Get-Help?view=powershell-5.1" rel=noopener target=_blank>Get-Help </A>to understand how to use commands. ( Extra merit marks for teachers pets who read the topics they find using Get-Help About_*) Also, instant demerit points throughout the course (your career) for students who do not use Get-Help when using any command for the first time.</P>
<P>Hopefully you are confident enough to have run some commands. If you are worried about breaking things only run the commands which start with Get- as these should only be returning information or objects and not changing anything.</P>
<H2>This isn‚Äôt cmd&nbsp;<IMG class=alignright src="https://i2.wp.com/i.pinimg.com/736x/bc/96/f8/bc96f8013cc72b871d86a8536b0d6838--text-back-kid-memes.jpg?w=630&amp;ssl=1" data-recalc-dims="1"></H2>
<P>This isn‚Äôt cmd. What you are getting back is not text.</P>
<P>It is an object.</P>
<P>Unless you choose to use one of the formatting commands or the command you are using outputs using a formatting command (pro-tip don‚Äôt do that) then what you will receive as the results of your command is an object.</P>
<P>This means that there is more that you can do with the results than just have them in text format. You want Text File,JSON, XML, CSV, Excel output or to write to a database? <A href="https://blog.robsewell.com/taking-dbatools-test-dbalastbackup-a-little-further/">Look here for ideas</A></P>
<H2>Objects,Objects,Objects</H2>
<P>Objects are awesome. Lets start with a SQL Server Instance object to show you how to explore objects. You will need to install the most useful PowerShell module you will find if you are working with SQL Server ‚Äì <A href="https://dbatools.io" rel=noopener target=_blank>dbatools</A></P>
<BLOCKQUOTE>
<P>Disclosure ‚Äì I am a contributor to the open source module dbatools. I am presenting a <A href="https://www.meetup.com/mssgug/events/242636018/" rel=noopener target=_blank>full day workshop in Singapore for the PowerShell Conference Asia in October</A>. I am also proctoring at <A href="http://sqlps.io/precon" rel=noopener target=_blank>Chrissy and CK‚Äôs PASS Summit in Seattle</A>. I highly recommend that you come and join us at one of those events if you can to further learn how you can use PowerShell to administer SQL Server</P></BLOCKQUOTE>
<P>You can install it from the PowerShell Gallery using</P><PRE class="lang:ps decode:true">Install-Module dbatools -Scope CurrentUser</PRE>
<P>You will be asked if you want to trust the repository, say Yes. If this doesn‚Äôt work on your machine (you are on an older version of PowerShell) follow the instructions <A href="https://dbatools.io/download/" rel=noopener target=_blank>on this page.&nbsp;</A> Or ask for help in #powershellhelp in <A href="https://sqlps.io/slack" rel=noopener target=_blank>Slack</A></P>
<P>Now that the module is installed we can create a SQL Server Instance object by assigning the results of a command to a variable.</P>
<P>A variable in PowerShell is designated by a $.</P>
<P>I suggest that you get used to following this step as well. This is a great way of exploring the results of any command and understanding what you can do with it.</P>
<P>We will use the <A href="https://docs.microsoft.com/en-gb/powershell/module/Microsoft.PowerShell.Utility/Get-Member?view=powershell-5.1" rel=noopener target=_blank>Get-Member</A> command. Another one that I use every single day.</P>
<P>Warning ‚Äì You do not <STRONG>have</STRONG> to use these methods to accomplish tasks in PowerShell against SQL Server as both Microsoft and the community have released modules which will enable you to general tasks without ‚Äúcoding‚Äù</P>
<P>This is an example to get you comfortable with PowerShell by using a target that you are comfortable with and can recognise.</P><PRE class="lang:ps decode:true">## Create a smo object provide your host\instance after -SqlInstance
$SMO = Connect-DbaSqlServer -SqlInstance ROB-XPS\sql2016</PRE>
<P>Now that we have an object we can explore it</P><PRE class="lang:ps decode:true">$SMO</PRE>
<P>By just calling the variable it will display the default properties</P>
<P><IMG class="alignnone size-full wp-image-8016" alt="06 - default properties.png" src="https://blog.robsewell.com/assets/uploads/2017/09/06-default-properties.png?resize=630%2C330&amp;ssl=1" width=630 height=330 sizes="(max-width: 630px) 100vw, 630px" data-recalc-dims="1" loading="lazy" data-large-file="https://blog.robsewell.com/assets/uploads/2017/09/06-default-properties.png?fit=630%2C330&amp;ssl=1" data-medium-file="https://blog.robsewell.com/assets/uploads/2017/09/06-default-properties.png?fit=300%2C157&amp;ssl=1" data-image-description="" data-image-title="06 ‚Äì default properties" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-comments-opened="1" data-orig-size="1371,718" data-orig-file="https://blog.robsewell.com/assets/uploads/2017/09/06-default-properties.png?fit=1371%2C718&amp;ssl=1" data-permalink="https://blog.robsewell.com/06-default-properties/" data-attachment-id="8016" srcset="https://blog.robsewell.com/assets/uploads/2017/09/06-default-properties.png?w=1371&amp;ssl=1 1371w,https://blog.robsewell.com/assets/uploads/2017/09/06-default-properties.png?resize=300%2C157&amp;ssl=1 300w,https://blog.robsewell.com/assets/uploads/2017/09/06-default-properties.png?resize=768%2C402&amp;ssl=1 768w,https://blog.robsewell.com/assets/uploads/2017/09/06-default-properties.png?resize=1024%2C536&amp;ssl=1 1024w,https://blog.robsewell.com/assets/uploads/2017/09/06-default-properties.png?w=1260&amp;ssl=1 1260w"></P>
<P>If you want to see what else is available you can use <A href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/get-member?view=powershell-5.1" rel=noopener target=_blank>Get-Member </A>You just pipe | to Get-Member</P><PRE class="lang:ps decode:true">$SMO | Get-Member</PRE>
<P>This will show you all of the events, methods and properties available on the object.&nbsp; Methods are really useful, enabling you to do things like start agent jobs or enumerate permissions or members</P>
<P>If you wish to see all of the processes that are running on the instance</P><PRE class="lang:ps decode:true">$SMO.EnumProcesses() | Out-GridView</PRE>
<P><A href="https://docs.microsoft.com/en-gb/powershell/module/Microsoft.PowerShell.Utility/Out-GridView?view=powershell-5.1" rel=noopener target=_blank>Out-GridView</A> is a useful command allowing you to see the results of your command in a graphical format and easily filter using the search bar at the top.</P>
<P><IMG class="alignnone size-full wp-image-8026" alt="07 - ogv.png" src="https://blog.robsewell.com/assets/uploads/2017/09/07-ogv.png?resize=630%2C222&amp;ssl=1" width=630 height=222 sizes="(max-width: 630px) 100vw, 630px" data-recalc-dims="1" loading="lazy" data-large-file="https://blog.robsewell.com/assets/uploads/2017/09/07-ogv.png?fit=630%2C222&amp;ssl=1" data-medium-file="https://blog.robsewell.com/assets/uploads/2017/09/07-ogv.png?fit=300%2C106&amp;ssl=1" data-image-description="" data-image-title="07 ‚Äì ogv" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-comments-opened="1" data-orig-size="3111,1097" data-orig-file="https://blog.robsewell.com/assets/uploads/2017/09/07-ogv.png?fit=3111%2C1097&amp;ssl=1" data-permalink="https://blog.robsewell.com/07-ogv/" data-attachment-id="8026" srcset="https://blog.robsewell.com/assets/uploads/2017/09/07-ogv.png?w=3111&amp;ssl=1 3111w,https://blog.robsewell.com/assets/uploads/2017/09/07-ogv.png?resize=300%2C106&amp;ssl=1 300w,https://blog.robsewell.com/assets/uploads/2017/09/07-ogv.png?resize=768%2C271&amp;ssl=1 768w,https://blog.robsewell.com/assets/uploads/2017/09/07-ogv.png?resize=1024%2C361&amp;ssl=1 1024w,https://blog.robsewell.com/assets/uploads/2017/09/07-ogv.png?w=1260&amp;ssl=1 1260w,https://blog.robsewell.com/assets/uploads/2017/09/07-ogv.png?w=1890&amp;ssl=1 1890w"></P>
<P>Other things you can do include reading the errorlog</P><PRE class="lang:ps decode:true">$SMO.ReadErrorLog() | Out-GridView</PRE>
<P><IMG class="alignnone size-full wp-image-8031" alt="08 - errorlog.png" src="https://blog.robsewell.com/assets/uploads/2017/09/08-errorlog.png?resize=630%2C284&amp;ssl=1" width=630 height=284 sizes="(max-width: 630px) 100vw, 630px" data-recalc-dims="1" loading="lazy" data-large-file="https://blog.robsewell.com/assets/uploads/2017/09/08-errorlog.png?fit=630%2C284&amp;ssl=1" data-medium-file="https://blog.robsewell.com/assets/uploads/2017/09/08-errorlog.png?fit=300%2C135&amp;ssl=1" data-image-description="" data-image-title="08 ‚Äì errorlog" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-comments-opened="1" data-orig-size="2912,1313" data-orig-file="https://blog.robsewell.com/assets/uploads/2017/09/08-errorlog.png?fit=2912%2C1313&amp;ssl=1" data-permalink="https://blog.robsewell.com/08-errorlog/" data-attachment-id="8031" srcset="https://blog.robsewell.com/assets/uploads/2017/09/08-errorlog.png?w=2912&amp;ssl=1 2912w,https://blog.robsewell.com/assets/uploads/2017/09/08-errorlog.png?resize=300%2C135&amp;ssl=1 300w,https://blog.robsewell.com/assets/uploads/2017/09/08-errorlog.png?resize=768%2C346&amp;ssl=1 768w,https://blog.robsewell.com/assets/uploads/2017/09/08-errorlog.png?resize=1024%2C462&amp;ssl=1 1024w,https://blog.robsewell.com/assets/uploads/2017/09/08-errorlog.png?w=1260&amp;ssl=1 1260w,https://blog.robsewell.com/assets/uploads/2017/09/08-errorlog.png?w=1890&amp;ssl=1 1890w"></P>
<P>Get the connections to a database</P><PRE class="lang:ps decode:true">$smo.GetActiveDBConnectionCount('master')</PRE>
<P>Get the current Traceflags</P><PRE class="lang:ps decode:true">$smo.EnumActiveCurrentSessionTraceFlags()
$smo.EnumActiveGlobalTraceFlags()</PRE>
<P>The properties that are available at this level are similar to the view that you see in SSMS Object Explorer for the instance. You can see a databases folder in SSMS and you can expand it. You can do the same in PowerShell</P><PRE class="lang:ps decode:true">$SMO.Databases.Name</PRE>
<P>That is going to just show you the names of the databases on that instance. You can do the same thing using the pipe | again and <A href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/select-object?view=powershell-5.1" rel=noopener target=_blank>Select-Object</A></P><PRE class="lang:ps decode:true">$Smo.Databases | Select-Object Name</PRE>
<P>This will pass the Databases array of objects ‚Äúalong the pipeline‚Äù and then you can use Select-Object to choose them. Multiple properties can be chosen with commas.</P><PRE class="lang:ps decode:true">$smo.Databases|Select-Object Name, Collation, CreateDate, Owner, version</PRE>
<P><IMG class="alignnone size-full wp-image-8057" alt="09 - databases.png" src="https://blog.robsewell.com/assets/uploads/2017/09/09-databases.png?resize=630%2C259&amp;ssl=1" width=630 height=259 sizes="(max-width: 630px) 100vw, 630px" data-recalc-dims="1" loading="lazy" data-large-file="https://blog.robsewell.com/assets/uploads/2017/09/09-databases.png?fit=630%2C259&amp;ssl=1" data-medium-file="https://blog.robsewell.com/assets/uploads/2017/09/09-databases.png?fit=300%2C123&amp;ssl=1" data-image-description="" data-image-title="09 ‚Äì databases" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-comments-opened="1" data-orig-size="1931,794" data-orig-file="https://blog.robsewell.com/assets/uploads/2017/09/09-databases.png?fit=1931%2C794&amp;ssl=1" data-permalink="https://blog.robsewell.com/09-databases/" data-attachment-id="8057" srcset="https://blog.robsewell.com/assets/uploads/2017/09/09-databases.png?w=1931&amp;ssl=1 1931w,https://blog.robsewell.com/assets/uploads/2017/09/09-databases.png?resize=300%2C123&amp;ssl=1 300w,https://blog.robsewell.com/assets/uploads/2017/09/09-databases.png?resize=768%2C316&amp;ssl=1 768w,https://blog.robsewell.com/assets/uploads/2017/09/09-databases.png?resize=1024%2C421&amp;ssl=1 1024w,https://blog.robsewell.com/assets/uploads/2017/09/09-databases.png?w=1260&amp;ssl=1 1260w"></P>
<P>PowerShell will let you select things that do not exist so for example</P><PRE class="lang:ps decode:true">$smo.Databases | Select Name, NumberofBeards, Owner, MoustacheLength,one</PRE>
<P>does not return an error but some of the columns are empty üôÇ You need to use the names of the properties returned from <A href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/get-member?view=powershell-5.1" rel=noopener target=_blank>Get-Member</A> in your Select statement (Hmm, sounds a bit like T-SQL)</P>
<P><IMG class="alignnone size-full wp-image-8160" alt="18 select.png" src="https://blog.robsewell.com/assets/uploads/2017/09/18-select.png?resize=630%2C259&amp;ssl=1" width=630 height=259 sizes="(max-width: 630px) 100vw, 630px" data-recalc-dims="1" loading="lazy" data-large-file="https://blog.robsewell.com/assets/uploads/2017/09/18-select.png?fit=630%2C260&amp;ssl=1" data-medium-file="https://blog.robsewell.com/assets/uploads/2017/09/18-select.png?fit=300%2C124&amp;ssl=1" data-image-description="" data-image-title="18 select" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-comments-opened="1" data-orig-size="1950,803" data-orig-file="https://blog.robsewell.com/assets/uploads/2017/09/18-select.png?fit=1950%2C803&amp;ssl=1" data-permalink="https://blog.robsewell.com/18-select/" data-attachment-id="8160" srcset="https://blog.robsewell.com/assets/uploads/2017/09/18-select.png?w=1950&amp;ssl=1 1950w,https://blog.robsewell.com/assets/uploads/2017/09/18-select.png?resize=300%2C124&amp;ssl=1 300w,https://blog.robsewell.com/assets/uploads/2017/09/18-select.png?resize=768%2C316&amp;ssl=1 768w,https://blog.robsewell.com/assets/uploads/2017/09/18-select.png?resize=1024%2C422&amp;ssl=1 1024w,https://blog.robsewell.com/assets/uploads/2017/09/18-select.png?w=1260&amp;ssl=1 1260w,https://blog.robsewell.com/assets/uploads/2017/09/18-select.png?w=1890&amp;ssl=1 1890w"></P>
<P>You can look at a single database default properties using</P><PRE class="lang:ps decode:true">$SMO.Database['NAMEOFDATABASE']</PRE>
<P>You can then use <A href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/get-member?view=powershell-5.1" rel=noopener target=_blank>Get-Member</A> to explore deeper and deeper.</P>
<P>You can also look at the Agent from the instance level object</P><PRE class="lang:ps decode:true">$SMO.JobServer</PRE>
<P>HOMEWORK ‚Äì Using the code above explore the $SMO object, look at the databases, tables, the columns and the indexes. Explore other properties and select them. (Extra merit points for exploring the SQL Server like a file system using the SQLServer drive. Start with cd SQLSERVER:\ and use <A href="https://docs.microsoft.com/en-gb/powershell/module/Microsoft.PowerShell.Management/Get-ChildItem?view=powershell-5.1" rel=noopener target=_blank>Get-ChildItem</A> or its alias dir or ls)</P>
<P>Warning Reminder ‚Äì You do not <STRONG>have</STRONG> to use these methods to accomplish tasks in PowerShell against SQL Server as both Microsoft and the community have released modules which will enable you to do general tasks without ‚Äúcoding‚Äù</P>
<P>But this is a very useful way of understanding and exploring using PowerShell with a type of object that you understand. You will use these methods all of the time and when you need to accomplish the next thing you have the tools. Already. Now.</P>
<H2>Recap</H2>
<P>You should take from this for the future</P>
<UL>
<LI>Get-Command *search* ‚Äì Find a Command
<LI>Get-Help NameOfCommand ‚Äì How do I use the Command ?
<LI>$var = Some Command here ‚Äì Set the output of a command to a variable
<LI>$var | Get-Member ‚Äì What Events, Methods, Properties do I have on this object
<LI>$var | Select Property1, Property2, Property3 </LI></UL>
<H2>That‚Äôs All Code ‚Äì Where‚Äôs The Easy Buttons ?</H2>
<P>There are two answers to this.</P>
<P>Firstly, yes it‚Äôs all code, but you will find that code is the future. Every time you run the same piece of code it will do the same thing, every time a junior DBA follows the steps to manually do something in a GUI like SSMS they may make a mistake and a different mistake each time. As DBAs we use stored procedures, views, functions and more, they are all code. Using code is vital for automation, for making things easy, for reducing the risk of mistakes, for getting rid of the mundane.</P>
<P>It is also required for DevopsAgileScrumContinuousIntegrationDeliveryWhatsTheNextBuzzWord which is all the rage (and also a lot of fun with interesting challenges)</P>
<P>As estates get bigger and bigger the GUI becomes less useful to you.</P>
<P>Secondly, remember my warning at the top of this post? There is no easy button. You will have to learn new things you will make mistakes and get errors, you need to ask for help</P>
<H2>I Have An ERROR !</H2>
<P>Don‚Äôt be disheartened, errors happen. The red text looks scary and frightening but its not.</P>
<P>Read the Error</P>
<P>Lets use Microsofts <A href="https://docs.microsoft.com/en-us/powershell/module/sqlserver/?view=sqlserver-ps" rel=noopener target=_blank>sqlserver module</A>. There are all sorts of ways to get it. If you have SSMS you probably have it already. Lets check</P><PRE class="lang:ps decode:true">Get-Module sqlserver</PRE>
<P>A result like this means that you have it</P>
<P><IMG class="alignnone size-full wp-image-8089" alt="10 - get-module.png" src="https://blog.robsewell.com/assets/uploads/2017/09/10-get-module.png?resize=630%2C58&amp;ssl=1" width=630 height=58 sizes="(max-width: 630px) 100vw, 630px" data-recalc-dims="1" loading="lazy" data-large-file="https://blog.robsewell.com/assets/uploads/2017/09/10-get-module.png?fit=630%2C58&amp;ssl=1" data-medium-file="https://blog.robsewell.com/assets/uploads/2017/09/10-get-module.png?fit=300%2C27&amp;ssl=1" data-image-description="" data-image-title="10 ‚Äì get-module" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-comments-opened="1" data-orig-size="2915,267" data-orig-file="https://blog.robsewell.com/assets/uploads/2017/09/10-get-module.png?fit=2915%2C267&amp;ssl=1" data-permalink="https://blog.robsewell.com/10-get-module/" data-attachment-id="8089" srcset="https://blog.robsewell.com/assets/uploads/2017/09/10-get-module.png?w=2915&amp;ssl=1 2915w,https://blog.robsewell.com/assets/uploads/2017/09/10-get-module.png?resize=300%2C27&amp;ssl=1 300w,https://blog.robsewell.com/assets/uploads/2017/09/10-get-module.png?resize=768%2C70&amp;ssl=1 768w,https://blog.robsewell.com/assets/uploads/2017/09/10-get-module.png?resize=1024%2C94&amp;ssl=1 1024w,https://blog.robsewell.com/assets/uploads/2017/09/10-get-module.png?w=1260&amp;ssl=1 1260w,https://blog.robsewell.com/assets/uploads/2017/09/10-get-module.png?w=1890&amp;ssl=1 1890w"></P>
<P>If not</P><PRE class="lang:ps decode:true">Install-Module sqlserver -Scope CurrentUser</PRE>
<P>Again you will be asked if you want to trust the repository, say yes!</P>
<P>If I run</P><PRE class="lang:ps decode:true">Get-SqlLogin -ServerInstance rob-xps</PRE>
<P>I get</P>
<P><IMG class="alignnone size-full wp-image-8102" alt="11 - error.png" src="https://blog.robsewell.com/assets/uploads/2017/09/11-error.png?resize=630%2C86&amp;ssl=1" width=630 height=86 sizes="(max-width: 630px) 100vw, 630px" data-recalc-dims="1" loading="lazy" data-large-file="https://blog.robsewell.com/assets/uploads/2017/09/11-error.png?fit=630%2C86&amp;ssl=1" data-medium-file="https://blog.robsewell.com/assets/uploads/2017/09/11-error.png?fit=300%2C41&amp;ssl=1" data-image-description="" data-image-title="11 ‚Äì error" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-comments-opened="1" data-orig-size="2851,390" data-orig-file="https://blog.robsewell.com/assets/uploads/2017/09/11-error.png?fit=2851%2C390&amp;ssl=1" data-permalink="https://blog.robsewell.com/11-error-2/" data-attachment-id="8102" srcset="https://blog.robsewell.com/assets/uploads/2017/09/11-error.png?w=2851&amp;ssl=1 2851w,https://blog.robsewell.com/assets/uploads/2017/09/11-error.png?resize=300%2C41&amp;ssl=1 300w,https://blog.robsewell.com/assets/uploads/2017/09/11-error.png?resize=768%2C105&amp;ssl=1 768w,https://blog.robsewell.com/assets/uploads/2017/09/11-error.png?resize=1024%2C140&amp;ssl=1 1024w,https://blog.robsewell.com/assets/uploads/2017/09/11-error.png?w=1260&amp;ssl=1 1260w,https://blog.robsewell.com/assets/uploads/2017/09/11-error.png?w=1890&amp;ssl=1 1890w"></P>
<P>That error is fairly easy to understand. I can‚Äôt connect to an instance that isn‚Äôt running</P>
<P>If I run</P><PRE class="lang:ps decode:true">Get-SqlLogin -ServerInstance rob-xps\sql2016 -LoginName rob</PRE>
<P>I get a different error</P>
<P><IMG class="alignnone size-full wp-image-8107" alt="12 sql login error.png" src="https://blog.robsewell.com/assets/uploads/2017/09/12-sql-login-error.png?resize=630%2C93&amp;ssl=1" width=630 height=93 sizes="(max-width: 630px) 100vw, 630px" data-recalc-dims="1" loading="lazy" data-large-file="https://blog.robsewell.com/assets/uploads/2017/09/12-sql-login-error.png?fit=630%2C93&amp;ssl=1" data-medium-file="https://blog.robsewell.com/assets/uploads/2017/09/12-sql-login-error.png?fit=300%2C44&amp;ssl=1" data-image-description="" data-image-title="12 sql login error" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-comments-opened="1" data-orig-size="2613,385" data-orig-file="https://blog.robsewell.com/assets/uploads/2017/09/12-sql-login-error.png?fit=2613%2C385&amp;ssl=1" data-permalink="https://blog.robsewell.com/12-sql-login-error/" data-attachment-id="8107" srcset="https://blog.robsewell.com/assets/uploads/2017/09/12-sql-login-error.png?w=2613&amp;ssl=1 2613w,https://blog.robsewell.com/assets/uploads/2017/09/12-sql-login-error.png?resize=300%2C44&amp;ssl=1 300w,https://blog.robsewell.com/assets/uploads/2017/09/12-sql-login-error.png?resize=768%2C113&amp;ssl=1 768w,https://blog.robsewell.com/assets/uploads/2017/09/12-sql-login-error.png?resize=1024%2C151&amp;ssl=1 1024w,https://blog.robsewell.com/assets/uploads/2017/09/12-sql-login-error.png?w=1260&amp;ssl=1 1260w,https://blog.robsewell.com/assets/uploads/2017/09/12-sql-login-error.png?w=1890&amp;ssl=1 1890w"></P>
<P>The <A href="https://docs.microsoft.com/en-us/powershell/module/sqlserver/get-sqllogin?view=sqlserver-ps" rel=noopener target=_blank>Get-SqlLogin</A> from Microsofts sqlserver module returns an error if it cannot find the specified login name. The important part of this error message is ObjectNotFound. That tells us what has happened</P>
<P>If we look at the logins</P><PRE class="lang:ps decode:true">Get-SqlLogin -ServerInstance rob-xps\sql2016 | Select Name</PRE>
<P><IMG class="alignnone size-full wp-image-8113" alt="13 - Logins.png" src="https://blog.robsewell.com/assets/uploads/2017/09/13-Logins.png?resize=630%2C390&amp;ssl=1" width=630 height=390 sizes="(max-width: 630px) 100vw, 630px" data-recalc-dims="1" loading="lazy" data-large-file="https://blog.robsewell.com/assets/uploads/2017/09/13-Logins.png?fit=630%2C389&amp;ssl=1" data-medium-file="https://blog.robsewell.com/assets/uploads/2017/09/13-Logins.png?fit=300%2C186&amp;ssl=1" data-image-description="" data-image-title="13 ‚Äì Logins" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-comments-opened="1" data-orig-size="1630,1008" data-orig-file="https://blog.robsewell.com/assets/uploads/2017/09/13-Logins.png?fit=1630%2C1008&amp;ssl=1" data-permalink="https://blog.robsewell.com/13-logins/" data-attachment-id="8113" srcset="https://blog.robsewell.com/assets/uploads/2017/09/13-Logins.png?w=1630&amp;ssl=1 1630w,https://blog.robsewell.com/assets/uploads/2017/09/13-Logins.png?resize=300%2C186&amp;ssl=1 300w,https://blog.robsewell.com/assets/uploads/2017/09/13-Logins.png?resize=768%2C475&amp;ssl=1 768w,https://blog.robsewell.com/assets/uploads/2017/09/13-Logins.png?resize=1024%2C633&amp;ssl=1 1024w,https://blog.robsewell.com/assets/uploads/2017/09/13-Logins.png?w=1260&amp;ssl=1 1260w"></P>
<P>and choose one that exists everything is good</P>
<P><IMG class="alignnone size-full wp-image-8115" alt="14 one login.png" src="https://blog.robsewell.com/assets/uploads/2017/09/14-one-login.png?resize=630%2C99&amp;ssl=1" width=630 height=99 sizes="(max-width: 630px) 100vw, 630px" data-recalc-dims="1" loading="lazy" data-large-file="https://blog.robsewell.com/assets/uploads/2017/09/14-one-login.png?fit=630%2C98&amp;ssl=1" data-medium-file="https://blog.robsewell.com/assets/uploads/2017/09/14-one-login.png?fit=300%2C47&amp;ssl=1" data-image-description="" data-image-title="14 one login" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-comments-opened="1" data-orig-size="1860,291" data-orig-file="https://blog.robsewell.com/assets/uploads/2017/09/14-one-login.png?fit=1860%2C291&amp;ssl=1" data-permalink="https://blog.robsewell.com/14-one-login/" data-attachment-id="8115" srcset="https://blog.robsewell.com/assets/uploads/2017/09/14-one-login.png?w=1860&amp;ssl=1 1860w,https://blog.robsewell.com/assets/uploads/2017/09/14-one-login.png?resize=300%2C47&amp;ssl=1 300w,https://blog.robsewell.com/assets/uploads/2017/09/14-one-login.png?resize=768%2C120&amp;ssl=1 768w,https://blog.robsewell.com/assets/uploads/2017/09/14-one-login.png?resize=1024%2C160&amp;ssl=1 1024w,https://blog.robsewell.com/assets/uploads/2017/09/14-one-login.png?w=1260&amp;ssl=1 1260w"></P>
<P>HOMEWORK ‚Äì Here is another object to explore with <A href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/get-member?view=powershell-5.1" rel=noopener target=_blank>Get-Member</A>. Explore the Login object</P>
<P>For example</P>
<P><IMG class="alignnone size-full wp-image-8118" alt="15 - login script.png" src="https://blog.robsewell.com/assets/uploads/2017/09/15-login-script.png?resize=630%2C90&amp;ssl=1" width=630 height=90 sizes="(max-width: 630px) 100vw, 630px" data-recalc-dims="1" loading="lazy" data-large-file="https://blog.robsewell.com/assets/uploads/2017/09/15-login-script.png?fit=630%2C90&amp;ssl=1" data-medium-file="https://blog.robsewell.com/assets/uploads/2017/09/15-login-script.png?fit=300%2C43&amp;ssl=1" data-image-description="" data-image-title="15 ‚Äì login script" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-comments-opened="1" data-orig-size="2938,421" data-orig-file="https://blog.robsewell.com/assets/uploads/2017/09/15-login-script.png?fit=2938%2C421&amp;ssl=1" data-permalink="https://blog.robsewell.com/15-login-script/" data-attachment-id="8118" srcset="https://blog.robsewell.com/assets/uploads/2017/09/15-login-script.png?w=2938&amp;ssl=1 2938w,https://blog.robsewell.com/assets/uploads/2017/09/15-login-script.png?resize=300%2C43&amp;ssl=1 300w,https://blog.robsewell.com/assets/uploads/2017/09/15-login-script.png?resize=768%2C110&amp;ssl=1 768w,https://blog.robsewell.com/assets/uploads/2017/09/15-login-script.png?resize=1024%2C147&amp;ssl=1 1024w,https://blog.robsewell.com/assets/uploads/2017/09/15-login-script.png?w=1260&amp;ssl=1 1260w,https://blog.robsewell.com/assets/uploads/2017/09/15-login-script.png?w=1890&amp;ssl=1 1890w"></P>
<P>But back to errors. Sometimes it isn‚Äôt quite so obvious. I have altered my <A href="https://github.com/SQLDBAWithABeard/Functions/blob/master/Create-Database.ps1" rel=noopener target=_blank>Create-Database</A> function so that it shows an error instead of a helpful message.</P>
<P><IMG class="alignnone size-full wp-image-8122" alt="16 - db error.png" src="https://blog.robsewell.com/assets/uploads/2017/09/16-db-error.png?resize=630%2C104&amp;ssl=1" width=630 height=104 sizes="(max-width: 630px) 100vw, 630px" data-recalc-dims="1" loading="lazy" data-large-file="https://blog.robsewell.com/assets/uploads/2017/09/16-db-error.png?fit=630%2C104&amp;ssl=1" data-medium-file="https://blog.robsewell.com/assets/uploads/2017/09/16-db-error.png?fit=300%2C50&amp;ssl=1" data-image-description="" data-image-title="16 ‚Äì db error" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-comments-opened="1" data-orig-size="2665,441" data-orig-file="https://blog.robsewell.com/assets/uploads/2017/09/16-db-error.png?fit=2665%2C441&amp;ssl=1" data-permalink="https://blog.robsewell.com/16-db-error/" data-attachment-id="8122" srcset="https://blog.robsewell.com/assets/uploads/2017/09/16-db-error.png?w=2665&amp;ssl=1 2665w,https://blog.robsewell.com/assets/uploads/2017/09/16-db-error.png?resize=300%2C50&amp;ssl=1 300w,https://blog.robsewell.com/assets/uploads/2017/09/16-db-error.png?resize=768%2C127&amp;ssl=1 768w,https://blog.robsewell.com/assets/uploads/2017/09/16-db-error.png?resize=1024%2C169&amp;ssl=1 1024w,https://blog.robsewell.com/assets/uploads/2017/09/16-db-error.png?w=1260&amp;ssl=1 1260w,https://blog.robsewell.com/assets/uploads/2017/09/16-db-error.png?w=1890&amp;ssl=1 1890w"></P>
<P>This is an example of the sort of error message that you might not be able to decipher so easily. Even if you read the message it says Exception calling .ctor with 2 arguments. How can you, as a new PowerShell user work out what has happened?</P>
<P>Objects</P>
<P>Remember, PowerShell is great because of objects? The errors are objects too. Lets have a look at the error in full. This is another piece of code that I still use every single day</P><PRE title="So Important it gets a title" class="lang:ps decode:true ">$error[0] | fl -force</PRE>
<P>The $error variable holds an array of error objects for that session. The [0] targets the 1st object in the array which is the latest. We pipe that to fl which is an alias for <A href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/format-list?view=powershell-5.1" rel=noopener target=_blank>Format-List</A>. Normally I am very clear about not using aliases in my blog posts as I believe that you should not use aliases in your scripts and functions (This is due to a bad experience trying to <A href="https://www.google.co.uk/search?q=powershell+%25&amp;ie=&amp;oe=" rel=noopener target=_blank>google for %</A> to find out what it was in PowerShell many years ago). However, you are only going to use this at the command line so its ok.</P>
<P>The results are</P>
<P><IMG class="alignnone size-full wp-image-8130" alt="17 error.png" src="https://blog.robsewell.com/assets/uploads/2017/09/17-error.png?resize=630%2C239&amp;ssl=1" width=630 height=239 sizes="(max-width: 630px) 100vw, 630px" data-recalc-dims="1" loading="lazy" data-large-file="https://blog.robsewell.com/assets/uploads/2017/09/17-error.png?fit=630%2C239&amp;ssl=1" data-medium-file="https://blog.robsewell.com/assets/uploads/2017/09/17-error.png?fit=300%2C114&amp;ssl=1" data-image-description="" data-image-title="17 error" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-comments-opened="1" data-orig-size="2917,1108" data-orig-file="https://blog.robsewell.com/assets/uploads/2017/09/17-error.png?fit=2917%2C1108&amp;ssl=1" data-permalink="https://blog.robsewell.com/17-error/" data-attachment-id="8130" srcset="https://blog.robsewell.com/assets/uploads/2017/09/17-error.png?w=2917&amp;ssl=1 2917w,https://blog.robsewell.com/assets/uploads/2017/09/17-error.png?resize=300%2C114&amp;ssl=1 300w,https://blog.robsewell.com/assets/uploads/2017/09/17-error.png?resize=768%2C292&amp;ssl=1 768w,https://blog.robsewell.com/assets/uploads/2017/09/17-error.png?resize=1024%2C389&amp;ssl=1 1024w,https://blog.robsewell.com/assets/uploads/2017/09/17-error.png?w=1260&amp;ssl=1 1260w,https://blog.robsewell.com/assets/uploads/2017/09/17-error.png?w=1890&amp;ssl=1 1890w"></P>
<P>Once you read the error, you will see that there is a generic connection failed error message which you will be used to seeing and now you can go about fixing it.</P>
<P>Errors aren‚Äôt scary. You just have to read them. Sometimes you have to expand them to read them. Once you have read them don‚Äôt forget that there is also a lot of help out there on the internet. I recommend the #powershellhelp channel in the slack but with the full error message you will be able to get some useful results from whatever your choice of helpful solutions is.</P>
<P>That‚Äôs exactly 3000 words ‚Äì which is slightly (!) more than I intended to write and a lot to read, so if you have got all the way down here. Congratulations, when you see me at Summit or at a SQL Saturday come up and tell me and I will give you a special sticker üôÇ</P>
<P>Hopefully this has given you some guidance to starting to use PowerShell with SQL and how you can help yourself.</P>
<P>Good luck.</P>

