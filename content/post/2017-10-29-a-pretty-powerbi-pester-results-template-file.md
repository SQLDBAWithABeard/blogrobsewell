---
title: "A Pretty PowerBi Pester Results Template File"
date: "2017-10-29" 
categories:
  - Blog

tags:
  - community
  - dbatools
  - pester
  - PowerShell

---
<P>I have left the heat and humidity of Singapore where I have been presenting at the PowerShell Conference Asia and DevOpsDays Singapore to travel to Seattle for PASS Summit. During my Green is Good – Red is Bad session someone asked me if the PowerBi that I showed at the end would work with any Pester Test Results object and I said (without thinking) that it would.</P>
<P>It turns out that the PowerBi that I had set up for that session will work with my function to run Pester Tests against an Ola Hallengren installation but some of the formatting and custom columns were specific to that test.</P>
<P>I said that I would share a Power Bi file that people could plug any Pester Test Results into. This is the first iteration of that. I doubt that it will work for every single test but I think it will be a good starting point for people to use.</P>
<H2>This is how to use it</H2>
<P>Download the file from <A href="https://1drv.ms/u/s!Ah9eXQJC3wLIpMUMfLsr37Y72EdNpw" rel=noopener target=_blank>here</A>.</P>
<P>Run your Pester Tests using the PassThru Parameter and set the results to a variable, you can also use the Show Parameter to reduce the output of the tests to the screen (and also speed up the tests)</P><PRE title="Setting Pester Results to a variable and then coverting to JSON" class="lang:ps decode:true">$PesterResults = Invoke-Pester -Script  C:\temp\PBI-Test01.ps1 -Show Summary -PassThru
</PRE>
<P>Then we convert the $PesterResults object into a JSON file</P><PRE class="lang:ps decode:true">$PesterResults.TestResult | ConvertTo-Json -Depth 5 | Out-File C:\temp\pbi-test.json</PRE>
<P>Open the Power Bi file you downloaded</P>
<P>Click Home</P>
<P>then the words “Edit Queries”</P>
<P><IMG class="alignnone size-medium wp-image-8272" alt="" src="https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-22-37.png?resize=269%2C300&amp;ssl=1" width=269 height=300 sizes="(max-width: 269px) 100vw, 269px" data-recalc-dims="1" srcset="https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-22-37.png?resize=269%2C300&amp;ssl=1 269w,https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-22-37.png?w=364&amp;ssl=1 364w" loading="lazy" data-large-file="https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-22-37.png?fit=364%2C406&amp;ssl=1" data-medium-file="https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-22-37.png?fit=269%2C300&amp;ssl=1" data-image-description="" data-image-title="2017-10-28_20-22-37" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-comments-opened="1" data-orig-size="364,406" data-orig-file="https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-22-37.png?fit=364%2C406&amp;ssl=1" data-permalink="https://blog.robsewell.com/2017-10-28_20-22-37/" data-attachment-id="8272"></P>
<P>then data source settings,</P>
<P><IMG class="alignnone size-medium wp-image-8273" alt="" src="https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-24-50.png?resize=300%2C218&amp;ssl=1" width=300 height=218 sizes="(max-width: 300px) 100vw, 300px" data-recalc-dims="1" srcset="https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-24-50.png?resize=300%2C218&amp;ssl=1 300w,https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-24-50.png?resize=768%2C558&amp;ssl=1 768w,https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-24-50.png?resize=1024%2C744&amp;ssl=1 1024w,https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-24-50.png?w=1994&amp;ssl=1 1994w,https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-24-50.png?w=1260&amp;ssl=1 1260w,https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-24-50.png?w=1890&amp;ssl=1 1890w" loading="lazy" data-large-file="https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-24-50.png?fit=630%2C458&amp;ssl=1" data-medium-file="https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-24-50.png?fit=300%2C218&amp;ssl=1" data-image-description="" data-image-title="2017-10-28_20-24-50" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-comments-opened="1" data-orig-size="1994,1449" data-orig-file="https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-24-50.png?fit=1994%2C1449&amp;ssl=1" data-permalink="https://blog.robsewell.com/2017-10-28_20-24-50/" data-attachment-id="8273"></P>
<P>highlight the filename and click change source</P>
<P><IMG class="alignnone size-medium wp-image-8274" alt="" src="https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-26-17.png?resize=300%2C129&amp;ssl=1" width=300 height=129 sizes="(max-width: 300px) 100vw, 300px" data-recalc-dims="1" srcset="https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-26-17.png?resize=300%2C129&amp;ssl=1 300w,https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-26-17.png?resize=768%2C330&amp;ssl=1 768w,https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-26-17.png?resize=1024%2C440&amp;ssl=1 1024w,https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-26-17.png?w=1744&amp;ssl=1 1744w,https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-26-17.png?w=1260&amp;ssl=1 1260w" loading="lazy" data-large-file="https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-26-17.png?fit=630%2C271&amp;ssl=1" data-medium-file="https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-26-17.png?fit=300%2C129&amp;ssl=1" data-image-description="" data-image-title="2017-10-28_20-26-17" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-comments-opened="1" data-orig-size="1744,749" data-orig-file="https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-26-17.png?fit=1744%2C749&amp;ssl=1" data-permalink="https://blog.robsewell.com/2017-10-28_20-26-17/" data-attachment-id="8274"></P>
<P>then navigate to the JSON file you just created, click ok and close and the apply changes.</P>
<P><IMG class="alignnone size-medium wp-image-8275" alt="" src="https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-29-14.png?resize=300%2C14&amp;ssl=1" width=300 height=14 sizes="(max-width: 300px) 100vw, 300px" data-recalc-dims="1" srcset="https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-29-14.png?resize=300%2C14&amp;ssl=1 300w,https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-29-14.png?resize=768%2C36&amp;ssl=1 768w,https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-29-14.png?resize=1024%2C48&amp;ssl=1 1024w,https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-29-14.png?w=1342&amp;ssl=1 1342w,https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-29-14.png?w=1260&amp;ssl=1 1260w" loading="lazy" data-large-file="https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-29-14.png?fit=630%2C30&amp;ssl=1" data-medium-file="https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-29-14.png?fit=300%2C14&amp;ssl=1" data-image-description="" data-image-title="2017-10-28_20-29-14" data-image-meta='{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}' data-comments-opened="1" data-orig-size="1342,63" data-orig-file="https://blog.robsewell.com/assets/uploads/2017/10/2017-10-28_20-29-14.png?fit=1342%2C63&amp;ssl=1" data-permalink="https://blog.robsewell.com/2017-10-28_20-29-14/" data-attachment-id="8275"></P>
<P>Which will load the data from the JSON file and display your pester results. You can then save this file with a new name and keep the template for other tests.</P>
<H2>It’s not going to be perfect</H2>
<P>It’s not going to work in all circumstances and I expect that with some test results it will display the results in a less than optimal manner but you should be able to modify this to suit your needs.</P>
<P>Please give it a try and see how you get on</P>
<P>Here is a sample report created with <A href="https://github.com/SQLDBAWithABeard/Presentations/tree/master/PSConfAsia%202017%20-%20Green%20is%20Good%20Red%20is%20Bad" rel=noopener target=_blank>Demo 1 from my Green is Good session </A></P>
<P>You can click around and change the data you can see and also look at the other 4 pages</P>
<P><IFRAME height=600 src="https://app.powerbi.com/view?r=eyJrIjoiNjA2ZjhlOTMtODJiNi00ZTNjLWE0NWUtMDczMmI1ZGYyYzk3IiwidCI6ImIxMjIyNDdlLTFlYmYtNGI1Mi1iMzA5LWMyYWE3NDM2ZmM2YiIsImMiOjh9" frameBorder=0 width=800 allowfullscreen="allowfullscreen"></IFRAME></P>
<P>Here is another one that I created using my <A href="https://github.com/SQLDBAWithABeard/dbatools-scripts" rel=noopener target=_blank>dbatools-scripts repo</A> and a config file. Again, have a click around and see what it does.</P><PRE class="lang:ps decode:true">$Config = (Get-Content GIT:\dbatools-scripts\TestConfig.json) -join "`n" | ConvertFrom-Json
$PesterResults = Invoke-Pester .\dbatools-scripts\ -PassThru
$PesterResults.TestResult | Convertto-Json |Out-File C:\temp\dbatools-scripts-pester.json</PRE>
<P><IFRAME height=600 src="https://app.powerbi.com/view?r=eyJrIjoiNjkyMDkxMzgtMzI3YS00NjAxLTg3YzQtNTZhMDQ5YTc2NWVhIiwidCI6ImIxMjIyNDdlLTFlYmYtNGI1Mi1iMzA5LWMyYWE3NDM2ZmM2YiIsImMiOjh9" frameBorder=0 width=800 allowfullscreen="allowfullscreen"></IFRAME></P>
<P>&nbsp;</P>
<P>I also created a quick video showing the process too which I will upload when I am not at 35000 feet!!</P>
<P><IMG class="alignnone size-medium wp-image-8278" alt="" src="https://blog.robsewell.com/assets/uploads/2017/10/20171030_000001-e1509289665780-169x300.jpg?resize=169%2C300&amp;ssl=1" width=169 height=300 sizes="(max-width: 169px) 100vw, 169px" data-recalc-dims="1" srcset="https://blog.robsewell.com/assets/uploads/2017/10/20171030_000001-e1509289665780.jpg?resize=169%2C300&amp;ssl=1 169w,https://blog.robsewell.com/assets/uploads/2017/10/20171030_000001-e1509289665780.jpg?resize=768%2C1365&amp;ssl=1 768w,https://blog.robsewell.com/assets/uploads/2017/10/20171030_000001-e1509289665780.jpg?resize=576%2C1024&amp;ssl=1 576w,https://blog.robsewell.com/assets/uploads/2017/10/20171030_000001-e1509289665780.jpg?w=1260&amp;ssl=1 1260w,https://blog.robsewell.com/assets/uploads/2017/10/20171030_000001-e1509289665780.jpg?w=1890&amp;ssl=1 1890w" loading="lazy" data-large-file="https://blog.robsewell.com/assets/uploads/2017/10/20171030_000001-e1509289665780.jpg?fit=576%2C1024&amp;ssl=1" data-medium-file="https://blog.robsewell.com/assets/uploads/2017/10/20171030_000001-e1509289665780.jpg?fit=169%2C300&amp;ssl=1" data-image-description="" data-image-title="20171030_000001" data-image-meta='{"aperture":"1.7","credit":"","camera":"SM-G955F","caption":"","created_timestamp":"1509321601","copyright":"","focal_length":"4.2","iso":"80","shutter_speed":"0.02","title":"","orientation":"6"}' data-comments-opened="1" data-orig-size="2268,4032" data-orig-file="https://blog.robsewell.com/assets/uploads/2017/10/20171030_000001-e1509289665780.jpg?fit=2268%2C4032&amp;ssl=1" data-permalink="https://blog.robsewell.com/20171030_000001/" data-attachment-id="8278"></P>
<P>Enjoy 🙂 Also, let me know if you think it would be better to have the file in Github which would allow contributions but it would only be seen as a binary file and therefore merging will be difficult. I am happy to do so.</P>

