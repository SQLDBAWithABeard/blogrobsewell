<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Rob Sewell (aka SQL DBA With A Beard)</title><link>https://blog.robsewell.com/</link><description>Recent content on Rob Sewell (aka SQL DBA With A Beard)</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Wed, 23 Apr 2025 00:00:00 +0000</lastBuildDate><atom:link href="https://blog.robsewell.com/index.xml" rel="self" type="application/rss+xml"/><item><title>Odd Error with Contained Database Users - look out for your 3rd party vendors</title><link>https://blog.robsewell.com/blog/odd-error-with-contained-database-users-look-out-for-your-3rd-party-vendors/</link><pubDate>Wed, 23 Apr 2025 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/odd-error-with-contained-database-users-look-out-for-your-3rd-party-vendors/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2025/contained.png" alt="Featured image of post Odd Error with Contained Database Users - look out for your 3rd party vendors" /&gt;&lt;h2 id="introduction"&gt;Introduction
&lt;/h2&gt;&lt;p&gt;A contained user can create a Windows login as its own account, although as it cannot grant connect permissions it is then is unable to connect at all.&lt;/p&gt;
&lt;p&gt;So if your vendor application is running as a contained user and during an upgrade it tries to create a login for itself, it will succeed in the creation but then be unable to connect to the SQL Server instance and the upgrade will fail&amp;hellip;&amp;hellip;&amp;hellip;. Sad Trombone.&lt;/p&gt;</description></item><item><title>Why Be a Mentor?</title><link>https://blog.robsewell.com/blog/why-be-a-mentor/</link><pubDate>Tue, 11 Mar 2025 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/why-be-a-mentor/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2025/mentor.png" alt="Featured image of post Why Be a Mentor?" /&gt;&lt;p&gt;&lt;a class="link" href="https://debthedba.wordpress.com/2025/03/04/t-sql-tuesday-184-the-invitation/" target="_blank" rel="noopener"
&gt;&lt;img src="https://debthedba.wordpress.com/wp-content/uploads/2016/06/tsql2sday-150x150.png"
loading="lazy"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;T-SQL Tuesday, which was started by Adam Machanic (&lt;a class="link" href="https://github.com/amachanic" target="_blank" rel="noopener"
&gt;github&lt;/a&gt; is hosted by a different person each month. The host selects the theme, and then the blogging begins. Worldwide, on the second Tuesday of the month (all day, based on GMT time), bloggers attend this party by blogging about the theme.&lt;/p&gt;
&lt;p&gt;This month it is hosted by &lt;a class="link" href="https://debthedba.wordpress.com/" target="_blank" rel="noopener"
&gt;Deborah&lt;/a&gt; on the &lt;a class="link" href="https://debthedba.wordpress.com/2025/03/04/t-sql-tuesday-184-the-invitation/" target="_blank" rel="noopener"
&gt;theme of mentoring and sponsorship&lt;/a&gt;. Thank you Deborah for hosting.&lt;/p&gt;</description></item><item><title>Making Notebook Agent Jobs on Named Instances work</title><link>https://blog.robsewell.com/blog/making-notebook-agent-jobs-on-named-instances-work/</link><pubDate>Wed, 03 Jan 2024 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/making-notebook-agent-jobs-on-named-instances-work/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2024/ads.png" alt="Featured image of post Making Notebook Agent Jobs on Named Instances work" /&gt;&lt;h2 id="can-you-help-erland-said"&gt;Can you help? Erland said
&lt;/h2&gt;&lt;p&gt;The first I realised about this problem was when Erland Sommarskog &lt;a class="link" href="https://www.sommarskog.se/" target="_blank" rel="noopener"
&gt;b&lt;/a&gt; asked me if I could help with &lt;a class="link" href="https://learn.microsoft.com/en-us/answers/questions/1465685/scheduling-python-notebook-using-sql-server-agent?wt.mc_id=dp-mvp-5002693" target="_blank" rel="noopener"
&gt;this forum post&lt;/a&gt; The poster was getting an error when trying to run a Notebook Agent Job. The error was a very generic instance not found error&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: Named Pipes Provider&lt;!-- raw HTML omitted --&gt; error: 40 - Could not open a connection to SQL Server) The system cannot find the file specified&lt;/p&gt;</description></item><item><title>Changing to Upper Case in VS Code</title><link>https://blog.robsewell.com/blog/changing-to-upper-case-in-vs-code/</link><pubDate>Sun, 20 Aug 2023 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/changing-to-upper-case-in-vs-code/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2023/uppercase.png" alt="Featured image of post Changing to Upper Case in VS Code" /&gt;&lt;h1 id="now-i-know-this"&gt;Now I know this!
&lt;/h1&gt;&lt;p&gt;I was using some code that I had written for Azure Pipelines for a Windows agent which had &lt;code&gt;$(System.AgentToken)&lt;/code&gt; as the variable name and all other pre-defined variables were the same PascalCase and separated by &lt;code&gt;.&lt;/code&gt; but the Linux agent needed all upper case and separated by &lt;code&gt;_&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;In VS Code &lt;code&gt;CTRL SHIFT P&lt;/code&gt; to open the command pallette and then search for uppercase :-)&lt;/p&gt;
&lt;div class="video-wrapper"&gt;
&lt;iframe loading="lazy"
src="https://www.youtube.com/embed/0Hkh46dnC7Y"
allowfullscreen
title="YouTube Video"
&gt;
&lt;/iframe&gt;
&lt;/div&gt;
&lt;p&gt;Simples&lt;/p&gt;</description></item><item><title>When WSL DNS fails you</title><link>https://blog.robsewell.com/blog/when-wsl-dns-fails-you/</link><pubDate>Sun, 20 Aug 2023 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/when-wsl-dns-fails-you/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2023/wsl-dns-fail.png" alt="Featured image of post When WSL DNS fails you" /&gt;&lt;h1 id="so-that-i-will-remember"&gt;So that I will remember!
&lt;/h1&gt;&lt;p&gt;When running WSL in a corporate environment, I sometimes an error like the following, where the cli is not able to resolve the IP address correctly. This error is from terraform but I have seen it elsewhere.&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="../assets/uploads/2023/wsl-dns-fail.png" &gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2023/wsl-dns-fail.png"
loading="lazy"
alt="wsl-dns-resolve"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;╷
│ Error: Failed to query available provider packages
│
│ Could not retrieve the list of available versions for provider hashicorp/random: could not connect to registry.terraform.io: failed to request discovery document: Get
│ &amp;ldquo;&lt;a class="link" href="https://registry.terraform.io/.well-known/terraform.json%22" target="_blank" rel="noopener"
&gt;https://registry.terraform.io/.well-known/terraform.json"&lt;/a&gt;: dial tcp: lookup registry.terraform.io on 123.45.67.89:53: read udp 123.45.67.89:51522-&amp;gt;123.45.67.89:53: i/o timeout&lt;/p&gt;</description></item><item><title>How to download terraform providers</title><link>https://blog.robsewell.com/blog/how-to-download-terraform-providers/</link><pubDate>Thu, 17 Aug 2023 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/how-to-download-terraform-providers/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2023/terraform.png" alt="Featured image of post How to download terraform providers" /&gt;&lt;h1 id="so-that-i-will-remember"&gt;So that I will remember!
&lt;/h1&gt;&lt;p&gt;It took me too long to find this. The google-fu was failing. How to download terraform providers. How can I download terraform providers. Downloading terraform providers. Getting terraform providers locally. I even checked for my favourite misspelling!&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="../assets/uploads/2023/terraform.png" &gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2023/terraform.png"
loading="lazy"
alt="terrafrom"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;but actually the answer to downloading the terraform providers locally for the mirror is in the documentation &lt;a class="link" href="https://developer.hashicorp.com/terraform/cli/commands/providers/mirror" target="_blank" rel="noopener"
&gt;https://developer.hashicorp.com/terraform/cli/commands/providers/mirror&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The &lt;code&gt;terraform providers mirror&lt;/code&gt; command downloads the providers required for the current configuration and copies them into a directory in the local filesystem.&lt;/p&gt;</description></item><item><title>dbachecks v3 at Data Saturday Oslo</title><link>https://blog.robsewell.com/blog/dbachecks-v3-at-data-saturday-oslo/</link><pubDate>Fri, 14 Jul 2023 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/dbachecks-v3-at-data-saturday-oslo/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2023/datasaturdayoslo-session.jpeg" alt="Featured image of post dbachecks v3 at Data Saturday Oslo" /&gt;&lt;h1 id="dbachecks-v3-at-data-saturday-oslo"&gt;dbachecks v3 at Data Saturday Oslo
&lt;/h1&gt;&lt;p&gt;&lt;a class="link" href="https://datasaturdays.com/2023-09-02-datasaturday0035/" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/datasaturdayoslo-session.jpeg"
loading="lazy"
alt="dbachecksv3"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;On Saturday September 2nd 2023, will be &lt;a class="link" href="https://datasaturdays.com/2023-09-02-datasaturday0035/" target="_blank" rel="noopener"
&gt;Data Saturday Oslo&lt;/a&gt; in Oslo, Norway.&lt;/p&gt;
&lt;p&gt;For more information about this free Saturday event, visit the official event page at &lt;a class="link" href="https://datasaturdays.com/2023-09-02-datasaturday0035/" target="_blank" rel="noopener"
&gt;DataSaturday0035&lt;/a&gt; where you can sign up. Don&amp;rsquo;t wait, spaces are limited!&lt;/p&gt;
&lt;p&gt;I will be presenting a session with Jess Pomfret &lt;a class="link" href="https://jesspomfret.com" target="_blank" rel="noopener"
&gt;Blog&lt;/a&gt; &lt;a class="link" href="https://tech.lgbt/@Jpomfret" target="_blank" rel="noopener"
&gt;Mastodon&lt;/a&gt; and Cláudio Silva &lt;a class="link" href="https://claudioessilva.eu/" target="_blank" rel="noopener"
&gt;Blog&lt;/a&gt; &lt;a class="link" href="https://twitter.com/claudioessilva" target="_blank" rel="noopener"
&gt;Twitter&lt;/a&gt; introducing dbachecks v3.&lt;/p&gt;
&lt;h2 id="abstract"&gt;abstract
&lt;/h2&gt;&lt;p&gt;dbachecks v1 was released back in 2018, bringing together the DBA PowerShell magic of dbatools with pester, a PowerShell testing framework to create a powerful infrastructure validation tool.&lt;/p&gt;</description></item><item><title>The DBA in a hybrid environment: Elevate Your Skills with Jess Pomfret and Rob Sewell in Oslo</title><link>https://blog.robsewell.com/blog/the-dba-in-a-hybrid-environment-elevate-your-skills-with-jess-pomfret-and-rob-sewell-in-oslo/</link><pubDate>Wed, 12 Jul 2023 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/the-dba-in-a-hybrid-environment-elevate-your-skills-with-jess-pomfret-and-rob-sewell-in-oslo/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2023/datasaturdayoslo-trainingday.png" alt="Featured image of post The DBA in a hybrid environment: Elevate Your Skills with Jess Pomfret and Rob Sewell in Oslo" /&gt;&lt;h2 id="jess-and-rob-are-doing-training-in-oslo-in-september-at-data-saturday-oslo"&gt;Jess and Rob are doing training in Oslo in September at Data Saturday Oslo
&lt;/h2&gt;&lt;p&gt;On Friday September 1st 2023, I am lucky enough to be delivering a full days training in Oslo, Norway with Jess Pomfret &lt;a class="link" href="https://jesspomfret.com" target="_blank" rel="noopener"
&gt;Blog&lt;/a&gt; &lt;a class="link" href="https://tech.lgbt/@Jpomfret" target="_blank" rel="noopener"
&gt;Mastodon&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Ready to take your DBA skills to the next level in a hybrid environment?
Secure your spot now by registering at the Eventbrite page: &lt;a class="link" href="https://www.eventbrite.com/e/the-dba-in-a-hybrid-environment-tickets-643006990217" target="_blank" rel="noopener"
&gt;Register Here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Designed specifically for DBAs working in hybrid environments, this training day will equip you with the knowledge and tools needed to excel in your role. Whether you&amp;rsquo;re managing on-premises databases, Platform as a Service (PaaS) offerings, or Azure virtual machines, this training has you covered.&lt;/p&gt;</description></item><item><title>Email Subject - Congratulations On Your MVP Award - #MVPBuzz</title><link>https://blog.robsewell.com/blog/email-subject-congratulations-on-your-mvp-award-mvpbuzz/</link><pubDate>Thu, 06 Jul 2023 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/email-subject-congratulations-on-your-mvp-award-mvpbuzz/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2023/MVP_Logo_Horizontal.png" alt="Featured image of post Email Subject - Congratulations On Your MVP Award - #MVPBuzz" /&gt;&lt;h1 id="grateful"&gt;Grateful
&lt;/h1&gt;&lt;p&gt;I never take it for granted and again I am humbled and indeed honoured (*) to again receive the MVP Award for my contributions in&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Data Platform&lt;/li&gt;
&lt;li&gt;Cloud and Datacenter Management&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="what-did-i-do-last-year-"&gt;What did I do last year ?
&lt;/h1&gt;&lt;p&gt;You can see most of it on &lt;a class="link" href="https://mvp.microsoft.com/en-us/PublicProfile/5002693?WT.mc_id=DP-MVP-5002693" target="_blank" rel="noopener"
&gt;my public MVP profile&lt;/a&gt; Here is a summary&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;18 sessions at conferences including SQLBits, PSCOnfEU, PASS Summit, Data Scotland, Data Grillen, PSConfEU MiniCon, PSDayUK, South Coast Summit&lt;/li&gt;
&lt;li&gt;6 sessions for User Groups - in person and remote&lt;/li&gt;
&lt;li&gt;Conference Organising Committee member for SQLBits, PSConfEU and PSDayUK&lt;/li&gt;
&lt;li&gt;Mentoring of new speakers&lt;/li&gt;
&lt;li&gt;Open Source Projects Contributions - Microsoft projects, dbatools, dbachecks, Data Saturdays, Call For Data Speakers&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;also some other things that I cannot talk about, normally related to feedback about new products or functionality to Microsoft Product Groups&lt;/p&gt;</description></item><item><title>Troubleshooting Teams sounds</title><link>https://blog.robsewell.com/blog/troubleshooting-teams-sounds/</link><pubDate>Wed, 05 Jul 2023 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/troubleshooting-teams-sounds/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2023/teams-live-captions.png" alt="Featured image of post Troubleshooting Teams sounds" /&gt;&lt;h1 id="remote-working"&gt;Remote Working
&lt;/h1&gt;&lt;p&gt;We have spent a lot of time remote working and I was recently reminded about this troubleshooting tip that I use frequently.&lt;/p&gt;
&lt;p&gt;When working with remote clients I am often required to be able to give access to the machine to the client to be able to install the VPN client and log into their domain. I use a Hyper-V machine on my home office desktop PC and use that.&lt;/p&gt;</description></item><item><title>SQLBits 2023 in Newport - A beards viewpoint</title><link>https://blog.robsewell.com/blog/sqlbits-2023-in-newport-a-beards-viewpoint/</link><pubDate>Sun, 19 Mar 2023 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/sqlbits-2023-in-newport-a-beards-viewpoint/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2023/dragonsqlbitslogo.png" alt="Featured image of post SQLBits 2023 in Newport - A beards viewpoint" /&gt;&lt;h1 id="what-is-sqlbits"&gt;What is SQLBits?
&lt;/h1&gt;&lt;p&gt;&lt;a class="link" href="https://sqlbits.com" target="_blank" rel="noopener"
&gt;SQLBits&lt;/a&gt; is the largest data platform conference in Europe. It has been running every year since 2007 in a different city in the UK providing sessions into all things data platform. I have frequently &lt;a class="link" href="https://blog.robsewell.com/tags/#sqlbits" target="_blank" rel="noopener"
&gt;written about SQLBits&lt;/a&gt;, it is close to my heart and has had a significant impact on my life, my career and my circle of friends.&lt;/p&gt;
&lt;h2 id="committee"&gt;Committee
&lt;/h2&gt;&lt;p&gt;The SQLBits committee is responsible for the running of the conference, the selection of general sessions and training days, helpers, sponsors, venue, dates, child care, theme, logo, the party, the website, charity support, hotels, bars, delegate app, helpers app, sponsors app, food, drinks, entertainment, prizes, swag, t-shirts, mugs, code of conduct, badges, printing, freight, stickers, lanyards, bags,on-site therapist, pens, notepads&amp;hellip; and everything else that goes into making SQLBits the best conference it can be!!&lt;/p&gt;</description></item><item><title>SQLBits Agenda and PowerShell, displaying and searching</title><link>https://blog.robsewell.com/blog/sqlbits-agenda-and-powershell-displaying-and-searching/</link><pubDate>Tue, 10 Jan 2023 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/sqlbits-agenda-and-powershell-displaying-and-searching/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2023/dragonsqlbitslogo.png" alt="Featured image of post SQLBits Agenda and PowerShell, displaying and searching" /&gt;&lt;h1 id="what-is-sqlbits"&gt;What is SQLBits?
&lt;/h1&gt;&lt;p&gt;&lt;a class="link" href="https://sqlbits.com" target="_blank" rel="noopener"
&gt;SQLBits&lt;/a&gt; is the largest data platform conference in Europe. It has been running every year since 2007 in a different city in the UK providing sessions into all things data platform. I have frequently &lt;a class="link" href="https://blog.robsewell.com/tags/#sqlbits" target="_blank" rel="noopener"
&gt;written about SQLBits&lt;/a&gt;, it is a conference close to my heart and has had a significant impact on my life, my career and my circle of friends.&lt;/p&gt;
&lt;h2 id="where-and-when"&gt;Where and when?
&lt;/h2&gt;&lt;p&gt;This year it is in Newport, Wales at the International Convention Centre Wales (ICC) Tuesday 14th to Saturday 18th of March, 2023&lt;/p&gt;</description></item><item><title>#NewStarNovember - Being a mentor</title><link>https://blog.robsewell.com/blog/newstarnovember-being-a-mentor/</link><pubDate>Sun, 27 Nov 2022 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/newstarnovember-being-a-mentor/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2017/newstars.jpg" alt="Featured image of post #NewStarNovember - Being a mentor" /&gt;&lt;p&gt;Thank you to the ever wonderful Ben &lt;a class="link" href="https://www.newstarsofdata.com/tell-us-your-story/" target="_blank" rel="noopener"
&gt;for the suggestion to blog&lt;/a&gt;. Check out #NewStarNovember for more blog posts.&lt;/p&gt;
&lt;h1 id="who-was-your-mentor"&gt;Who was your mentor?
&lt;/h1&gt;&lt;p&gt;I have never had an official mentor but I am so very very grateful to all of the people who have helped, supported and inspired me throughout my career.&lt;/p&gt;
&lt;p&gt;I feel so privileged to be able to reach out to so many wonderful people and ask questions and receive advice.&lt;/p&gt;</description></item><item><title>#NewStarNovember - Getting into Speaking - It was fatherjack and SQLBits</title><link>https://blog.robsewell.com/blog/newstarnovember-getting-into-speaking-it-was-fatherjack-and-sqlbits/</link><pubDate>Thu, 24 Nov 2022 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/newstarnovember-getting-into-speaking-it-was-fatherjack-and-sqlbits/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2017/newstars1.jpg" alt="Featured image of post #NewStarNovember - Getting into Speaking - It was fatherjack and SQLBits" /&gt;&lt;p&gt;Thank you to the ever wonderful Ben &lt;a class="link" href="https://www.newstarsofdata.com/tell-us-your-story/" target="_blank" rel="noopener"
&gt;for the suggestion to blog&lt;/a&gt;. Check out #NewStarNovember for more blog posts.&lt;/p&gt;
&lt;h1 id="in-the-beginning"&gt;In the beginning
&lt;/h1&gt;&lt;p&gt;It was around May of 2013 that I had written a blog post about spinning up and shutting down an Azure lab with PowerShell after being inspired at my first &lt;a class="link" href="https://sqlbits.com" target="_blank" rel="noopener"
&gt;SQLBits Conference&lt;/a&gt; (On a side note, I have attended, volunteered or spoken at every one since and this year I was delighted to become a Committee Member - If you have comments/questions/advice please feel free to email me at rob at sqlbits.com). That blog post still exists &lt;a class="link" href="https://blog.robsewell.com/azure/spinning-up-and-shutting-down-windows-azure-lab-with-powershell/" target="_blank" rel="noopener"
&gt;here&lt;/a&gt;&lt;/p&gt;</description></item><item><title>How to import dbatools from a zip file from the GitHub release into Azure Automation Modules without an error</title><link>https://blog.robsewell.com/blog/how-to-import-dbatools-from-a-zip-file-from-the-github-release-into-azure-automation-modules-without-an-error/</link><pubDate>Thu, 28 Jul 2022 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/how-to-import-dbatools-from-a-zip-file-from-the-github-release-into-azure-automation-modules-without-an-error/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2022/dbatools.jpg" alt="Featured image of post How to import dbatools from a zip file from the GitHub release into Azure Automation Modules without an error" /&gt;&lt;p&gt;There are a number of methods to import PowerShell modules into Azure automation &lt;a class="link" href="https://docs.microsoft.com/en-us/azure/automation/shared-resources/modules?WT.mc_id=DP-MVP-5002693" target="_blank" rel="noopener"
&gt;as described in the documentation here&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;You may however miss an important piece of information hidden in that documentation if you are uploading a module from a GitHub release instead of via the &lt;a class="link" href="https://www.powershellgallery.com/?WT.mc_id=DP-MVP-5002693" target="_blank" rel="noopener"
&gt;PowerShell Gallery&lt;/a&gt;. The name that you refer to the module must match the module name and module folder name in the zip file.&lt;/p&gt;
&lt;h1 id="method-one---from-gallery"&gt;Method one - from Gallery
&lt;/h1&gt;&lt;p&gt;This is my preferred method for importing modules into Azure Automation accounts, the only bothersome part is remembering to do it twice, once for 5.1 and once for 7.1 as I am sure that if I forget that will be the one module that I will need!&lt;/p&gt;</description></item><item><title>How Do You Show Keystrokes On Screen</title><link>https://blog.robsewell.com/blog/how-do-you-show-keystrokes-on-screen/</link><pubDate>Fri, 22 Jul 2022 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/how-do-you-show-keystrokes-on-screen/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2022/containers.jpg" alt="Featured image of post How Do You Show Keystrokes On Screen" /&gt;&lt;p&gt;It started with a tweet from Benni De Jagere &lt;a class="link" href="https://bennidejagere.com/" target="_blank" rel="noopener"
&gt;Blog&lt;/a&gt; &lt;a class="link" href="https://twitter.com/BenniDeJagere" target="_blank" rel="noopener"
&gt;Twitter&lt;/a&gt; about how to show the keystrokes on the screen.&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;h1 id="it-depends"&gt;It depends
&lt;/h1&gt;&lt;p&gt;The best answer is always &amp;ldquo;it depends&amp;rdquo; and the correct response to this to determine how much to trust this information is &amp;ldquo;what does it depend uponW&amp;rdquo;&lt;/p&gt;
&lt;h1 id="what-does-it-depend-upon"&gt;what does it depend upon?
&lt;/h1&gt;&lt;p&gt;It depends upon which programme you are using and wish to demonstrate.&lt;/p&gt;</description></item><item><title>Kubernetes lab certificates expired</title><link>https://blog.robsewell.com/blog/kubernetes-lab-certificates-expired/</link><pubDate>Tue, 19 Jul 2022 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/kubernetes-lab-certificates-expired/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2022/containers.jpg" alt="Featured image of post Kubernetes lab certificates expired" /&gt;&lt;h1 id="it-wont-start"&gt;It won&amp;rsquo;t start!
&lt;/h1&gt;&lt;p&gt;I have a 3 node kubernetes cluster running in my office that I have used for my &lt;a class="link" href="https://azure.microsoft.com/en-gb/services/azure-arc/hybrid-data-services?WT.mc_id=DP-MVP-5002693" target="_blank" rel="noopener"
&gt;Azure Arc-enabled data services&lt;/a&gt; presentations over the last year (&lt;a class="link" href="beard.media/presentations" &gt;Side note, my presentations are here&lt;/a&gt;). A few days ago after a power cut I tried to connect to my cluster with &lt;a class="link" href="https://k8slens.dev/" target="_blank" rel="noopener"
&gt;Lens&lt;/a&gt; and was not able to.&lt;/p&gt;
&lt;p&gt;I tried to run &lt;code&gt;kubectl get nodes&lt;/code&gt; but got no response.&lt;/p&gt;
&lt;h2 id="try-on-the-master-node"&gt;Try on the master node
&lt;/h2&gt;&lt;p&gt;I used my windows terminal profile that ssh&amp;rsquo;s into the master node and ran&lt;/p&gt;</description></item><item><title>GitHub Action Workflow Protected branch update failed</title><link>https://blog.robsewell.com/blog/github-action-workflow-protected-branch-update-failed/</link><pubDate>Fri, 15 Jul 2022 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/github-action-workflow-protected-branch-update-failed/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2022/noentry.jpg" alt="Featured image of post GitHub Action Workflow Protected branch update failed" /&gt;&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/blog/community/dev%20containers/powershell/github/Creating-A-Training-Day-Speakers-List-With-GitHub-Actions-From-A-GitHub-Issue/" &gt;The last post&lt;/a&gt; showed how we created an easy process to update a web-page using a GitHub Issue and two GitHub Actions.&lt;/p&gt;
&lt;h1 id="protecting-the-repository"&gt;Protecting the repository
&lt;/h1&gt;&lt;p&gt;I opened the repository in the browser and GitHub and was provided with a warning that said&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="assets/uploads/2022/07/protectbranch.png" &gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2022/07/protectbranch.png"
loading="lazy"
alt="protect your branch"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Clicking on the protect this branch button gave the reasoning.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Protect your most important branches
Branch protection rules define whether collaborators can delete or force push to the branch and set requirements for any pushes to the branch, such as passing status checks or a linear commit history.&lt;/p&gt;</description></item><item><title>Creating A Training Day Speakers List with GitHub Action from a GitHub Issue</title><link>https://blog.robsewell.com/blog/creating-a-training-day-speakers-list-with-github-action-from-a-github-issue/</link><pubDate>Mon, 11 Jul 2022 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/creating-a-training-day-speakers-list-with-github-action-from-a-github-issue/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2022/bench.jpg" alt="Featured image of post Creating A Training Day Speakers List with GitHub Action from a GitHub Issue" /&gt;&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/blog/community/Training-Day-Speakers-List" &gt;The last post&lt;/a&gt; showed the resource that we created to enable speakers to let events know that they have content for pre-cons/training days. This post will describe how the automation was created using a GitHub Issue and two GitHub Actions.&lt;/p&gt;
&lt;h1 id="what-do-we-need"&gt;What do we need?
&lt;/h1&gt;&lt;p&gt;The idea was to have a form for user input that could easily allow a person to add themselves and some information to a web page. The page holds a list of speakers who can present training day sessions for data platform events. &lt;a class="link" href="https://callfordataspeakers.com/precon" target="_blank" rel="noopener"
&gt;The web page can be found here&lt;/a&gt;. This page is generated from a JSON file.&lt;/p&gt;</description></item><item><title>Training Day Speakers List</title><link>https://blog.robsewell.com/blog/training-day-speakers-list/</link><pubDate>Sun, 10 Jul 2022 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/training-day-speakers-list/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2022/magnify.jpg" alt="Featured image of post Training Day Speakers List" /&gt;&lt;p&gt;How do data platform events find Training Day/Pre-Con speakers?&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://callfordataspeakers.com/precon" target="_blank" rel="noopener"
&gt;So we built a thing for speakers to add themselves and for events to find them&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I think event organisers know who the &lt;em&gt;big names&lt;/em&gt; are and the topics that they can deliver for full day training sessions or pre-cons as they are also known. Finding other speakers and finding speakers who can deliver on different topics is a little more difficult.&lt;/p&gt;</description></item><item><title>GitHub Pages in Dev Containers and Codespaces</title><link>https://blog.robsewell.com/blog/github-pages-in-dev-containers-and-codespaces/</link><pubDate>Mon, 04 Jul 2022 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/github-pages-in-dev-containers-and-codespaces/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2022/containers2.jpg" alt="Featured image of post GitHub Pages in Dev Containers and Codespaces" /&gt;&lt;h1 id="broken-link"&gt;Broken Link
&lt;/h1&gt;&lt;p&gt;It started with a message from Mikey Bronowski ( &lt;a class="link" href="https://www.bronowski.it/blog/" target="_blank" rel="noopener"
&gt;Blog&lt;/a&gt; &lt;a class="link" href="https://twitter.com/@MikeyBronowski" target="_blank" rel="noopener"
&gt;Twitter&lt;/a&gt; )&lt;/p&gt;
&lt;p&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2022/07/mikey-dm.png"
loading="lazy"
alt="message from Mikey"
&gt;&lt;/p&gt;
&lt;p&gt;Now this means that you get to see my awesome &lt;a class="link" href="https://blog.robsewell.com/justsomethingsad" target="_blank" rel="noopener"
&gt;404 page &lt;/a&gt; which makes me laugh every time! It is not a very good look though and does not help people who are reading the blog.&lt;/p&gt;
&lt;h2 id="why-do-something-manual-when-you-can-automate-it"&gt;Why do something manual when you can automate it
&lt;/h2&gt;&lt;p&gt;This blog is running on GitHub Pages via a repository. Every time a change is pushed to the repo a GitHub Action runs which rebuilds the jekyll site and makes it available.&lt;/p&gt;</description></item><item><title>Quickly Creating Test Users in SQL Server using dbatools</title><link>https://blog.robsewell.com/blog/quickly-creating-test-users-in-sql-server-using-dbatools/</link><pubDate>Tue, 05 Apr 2022 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/quickly-creating-test-users-in-sql-server-using-dbatools/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2017/02/remove-them-all.png" alt="Featured image of post Quickly Creating Test Users in SQL Server using dbatools" /&gt;</description></item><item><title>Archives</title><link>https://blog.robsewell.com/archives/</link><pubDate>Sun, 06 Mar 2022 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/archives/</guid><description/></item><item><title>Azure DevOps Pipeline Template Job Names and single quotes</title><link>https://blog.robsewell.com/blog/azure-devops-pipeline-template-job-names-and-single-quotes/</link><pubDate>Fri, 28 Jan 2022 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/azure-devops-pipeline-template-job-names-and-single-quotes/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2021/Bicep/xavier-von-erlach-ooR1jY2yFr4-unsplash.jpg" alt="Featured image of post Azure DevOps Pipeline Template Job Names and single quotes" /&gt;&lt;h1 id="the-job-name-deploy_function_app-appears-more-than-once"&gt;The job name Deploy_Function_App appears more than once
&lt;/h1&gt;&lt;p&gt;This was the error I was notified about in a Azure DevOps pipeline when they tried to run it. The error message continued to say that Job Names must be unique within a pipeline.&lt;/p&gt;
&lt;h2 id="set-up"&gt;Set Up
&lt;/h2&gt;&lt;p&gt;There is a centralised repository of Azure DevOps Pipeline Template Jobs that call the Bicep modules with the required values in the same repo to deploy Azure Infrastructure.&lt;/p&gt;</description></item><item><title>What does JS_InvalidFilePath error mean in Azure DevOps?</title><link>https://blog.robsewell.com/blog/what-does-js_invalidfilepath-error-mean-in-azure-devops/</link><pubDate>Thu, 04 Nov 2021 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/what-does-js_invalidfilepath-error-mean-in-azure-devops/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2021/Bicep/xavier-von-erlach-ooR1jY2yFr4-unsplash.jpg" alt="Featured image of post What does JS_InvalidFilePath error mean in Azure DevOps? " /&gt;&lt;h1 id="cant-find-loc-string-for-key-js_invalidfilepath"&gt;Can't find loc string for key: JS_InvalidFilePath
&lt;/h1&gt;&lt;p&gt;This was the error I received in my Azure DevOps pipeline when I tried to run it.&lt;/p&gt;
&lt;p&gt;When I investigated further it said&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;span class="lnt"&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;##[debug]workingDirectory=/home/vsts/work/1/s
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;##[debug]check path : /home/vsts/work/1/s
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;##[warning]Can\&amp;#39;t find loc string for key: JS_InvalidFilePath
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;##[debug]Processed: ##vso[task.issue type=warning;]Can\&amp;#39;t find loc string for key: JS_InvalidFilePath
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;##[debug]task result: Failed
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;##[error]JS_InvalidFilePath /home/vsts/work/1/s
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;##[debug]Processed: ##vso[task.issue type=error;]JS_InvalidFilePath /home/vsts/work/1/s
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;##[debug]Processed: ##vso[task.complete result=Failed;]JS_InvalidFilePath /home/vsts/work/1/s
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id="what-is-going-on"&gt;What is going on?
&lt;/h1&gt;&lt;p&gt;I was trying to run a simple Azure PowerShell task and had defined it like this (I used VS Code with the Azure Pipelines extension and made use of the intellisense). I had defined it like this.&lt;/p&gt;</description></item><item><title>Deploying a Bicep Module from a private repository without a connection to the repository</title><link>https://blog.robsewell.com/blog/deploying-a-bicep-module-from-a-private-repository-without-a-connection-to-the-repository/</link><pubDate>Tue, 02 Nov 2021 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/deploying-a-bicep-module-from-a-private-repository-without-a-connection-to-the-repository/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2021/Bicep/xavier-von-erlach-ooR1jY2yFr4-unsplash.jpg" alt="Featured image of post Deploying a Bicep Module from a private repository without a connection to the repository" /&gt;&lt;h1 id="using-a-private-module-repository"&gt;Using a private module repository
&lt;/h1&gt;&lt;p&gt;From Bicep version 0.4.1008 you can save and version your Bicep modules in repositories. &lt;a class="link" href="https://msftplayground.com/2021/11/using-private-repositories-for-bicep-modules/" target="_blank" rel="noopener"
&gt;You can read more about how to do it here&lt;/a&gt;. This is really useful for reusing modules and modularising large corporate infrastructure environments.&lt;/p&gt;
&lt;p&gt;You can control how a single resource (think of a storage account) is deployed across your environment and ensure that all requirements are followed (the storage account must have public access disabled, must have private endpoints and must have the one production network allowed). This is really useful and since it has been available we have used this to deploy infrastructure.&lt;/p&gt;</description></item><item><title>When you REALLY want to see your Azure DevOps Secret Variable Values</title><link>https://blog.robsewell.com/blog/when-you-really-want-to-see-your-azure-devops-secret-variable-values/</link><pubDate>Tue, 10 Aug 2021 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/when-you-really-want-to-see-your-azure-devops-secret-variable-values/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2021/michael-dziedzic-1bjsASjhfkE-unsplash.jpg" alt="Featured image of post When you REALLY want to see your Azure DevOps Secret Variable Values" /&gt;&lt;h1 id="i-really-needed-to-see-the-values"&gt;I REALLY needed to see the values
&lt;/h1&gt;&lt;p&gt;The problem was that I had code in an Azure DevOps PowerShell task which was using a Service Principal to do some things in Azure and it was failing.&lt;/p&gt;
&lt;p&gt;The pipeline had some things a little like this, it got a number of values from a key vault, set them to variables and used them in a custom function&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;$somevalue = (Get-AzKeyVaultSecret -vaultName $KeyVaultName -name &amp;#39;AGeneratedName&amp;#39;).SecretValue
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;$somecredential = New-Object System.Management.Automation.PSCredential (&amp;#39;dummy&amp;#39;, $somevalue )
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;$something = $somecredential.GetNetworkCredential().Password
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Do-SomethingSpecial -MyThing $something
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;I was getting an error saying &amp;ldquo;forbidden - *** does not have access&amp;rdquo; or similar&lt;/p&gt;</description></item><item><title>How to deploy an Azure Arc Enabled SQL Managed Instance in AKS</title><link>https://blog.robsewell.com/blog/how-to-deploy-an-azure-arc-enabled-sql-managed-instance-in-aks/</link><pubDate>Sat, 03 Jul 2021 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/how-to-deploy-an-azure-arc-enabled-sql-managed-instance-in-aks/</guid><description>&lt;img src="https://raw.githubusercontent.com/SQLDBAWithABeard/Beard-Aks-AEDS/main/images/connecteddc.png" alt="Featured image of post How to deploy an Azure Arc Enabled SQL Managed Instance in AKS" /&gt;&lt;h1 id="want-to-play-before-ga-"&gt;Want to play before GA ?
&lt;/h1&gt;&lt;p&gt;Azure SQL enabled by Azure Arc will be generally available at the end of the month following the announcement &lt;a class="link" href="https://azure.microsoft.com/en-us/blog/bring-cloud-experiences-to-data-workloads-anywhere-with-azure-sql-enabled-by-azure-arc?WT.mc_id=DP-MVP-5002693" target="_blank" rel="noopener"
&gt;here&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;You can read more about &lt;a class="link" href="https://azure.microsoft.com/en-us/services/azure-arc/hybrid-data-services?WT.mc_id=DP-MVP-5002693" target="_blank" rel="noopener"
&gt;Azure Arc-enabled Data Services &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I have been playing with it for a few months, mainly in a Kubernetes cluster running on my NUCs in my office but Azure Arc is available in so many places, all the public clouds, your own data center (or NUCs in your office :-) ) so if you want to try it out and you do not want to build your own Kubernetes cluster then you can use &lt;a class="link" href="https://azure.microsoft.com/en-gb/services/kubernetes-service?WT.mc_id=DP-MVP-5002693" target="_blank" rel="noopener"
&gt;AKS&lt;/a&gt; in Azure.&lt;/p&gt;</description></item><item><title>Flexing My Bicep - Reusable code with modules for deploying an Azure SQL Server</title><link>https://blog.robsewell.com/blog/flexing-my-bicep-reusable-code-with-modules-for-deploying-an-azure-sql-server/</link><pubDate>Fri, 21 May 2021 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/flexing-my-bicep-reusable-code-with-modules-for-deploying-an-azure-sql-server/</guid><description>&lt;img src="https://datasaturdays.com/assets/design/twitter/c.twitter%201r.png" alt="Featured image of post Flexing My Bicep - Reusable code with modules for deploying an Azure SQL Server" /&gt;&lt;h1 id="reusable-code"&gt;Reusable code
&lt;/h1&gt;&lt;p&gt;We looked at a simple deployment of an Azure SQL Server and a database in the last blog post. You would like to reuse this code though, you will want to create more SQL Instances and SQL databases in the future. With Bicep, you can use modules and parameters to do this.&lt;/p&gt;
&lt;p&gt;You can create a module for your SQL Instance. I look up &lt;a class="link" href="https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/servers/databases?tabs=bicep?WT.mc_id=DP-MVP-5002693" target="_blank" rel="noopener"
&gt;the resource information from the documentation&lt;/a&gt; and create a file named SQLInstance.bicep. I put it in a Resources directory.&lt;/p&gt;</description></item><item><title>Invalid Template Deployment with my Bicep</title><link>https://blog.robsewell.com/blog/invalid-template-deployment-with-my-bicep/</link><pubDate>Fri, 21 May 2021 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/invalid-template-deployment-with-my-bicep/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2021/Bicep/xavier-von-erlach-ooR1jY2yFr4-unsplash.jpg" alt="Featured image of post Invalid Template Deployment with my Bicep" /&gt;&lt;h1 id="an-error"&gt;An Error
&lt;/h1&gt;&lt;p&gt;Did I tear my bicep? No but I got an error. Whilst trying to deploy a network with Bicep using Azure DevOps I received the error&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Error: Code=InvalidTemplateDeployment; Message=The template deployment &amp;lsquo;deploy_bicep003_20210505094331&amp;rsquo; is not valid according to the validation procedure. The tracking id is &amp;lsquo;4bdec1fe-915d-4735-a1c1-7b56fbba0dc2&amp;rsquo;. See inner errors for details.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Unfortunately that was all that I had. I had to find the inner error for details&lt;/p&gt;
&lt;h1 id="try-the-deployment-log-on-the-resource-group"&gt;Try the deployment log on the Resource Group
&lt;/h1&gt;&lt;p&gt;As I know that the Bicep deployments are logged in Azure under the Resource Groups deployment I looked there first but there were no entries (obviously Rob, there had been no deployment)&lt;/p&gt;</description></item><item><title>Flexing My Bicep - Deploy an Azure SQL Database -Intro to Azure Bicep IaC</title><link>https://blog.robsewell.com/blog/flexing-my-bicep-deploy-an-azure-sql-database-intro-to-azure-bicep-iac/</link><pubDate>Thu, 20 May 2021 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/flexing-my-bicep-deploy-an-azure-sql-database-intro-to-azure-bicep-iac/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2021/Bicep/xavier-von-erlach-ooR1jY2yFr4-unsplash.jpg" alt="Featured image of post Flexing My Bicep - Deploy an Azure SQL Database -Intro to Azure Bicep IaC" /&gt;&lt;h1 id="starting-working-out"&gt;Starting working out?
&lt;/h1&gt;&lt;p&gt;It is important to keep a healthy body and mind, especially when my life is so sedentary these days. Getting exercise is good for both. This blog post has nothing to do with exercise though (apart from maybe exercising the mind)&lt;/p&gt;
&lt;h1 id="project-bicep"&gt;Project Bicep
&lt;/h1&gt;&lt;p&gt;&lt;a class="link" href="https://docs.microsoft.com/en-us/azure/azure-resource-manager/templates/bicep-overview?WT.mc_id=DP-MVP-5002693" target="_blank" rel="noopener"
&gt;Bicep&lt;/a&gt; is a language for declaring and deploying Azure Resources. Like &lt;a class="link" href="https://www.terraform.io/" target="_blank" rel="noopener"
&gt;Terraform&lt;/a&gt; it enables you to define your infrastructure as code.&lt;/p&gt;
&lt;h2 id="why-use-bicep-instead"&gt;WHy use Bicep instead?
&lt;/h2&gt;&lt;p&gt;I really like being able to control infrastructure with code. I have used &lt;a class="link" href="https://blog.robsewell.com/tags/#terraform" target="_blank" rel="noopener"
&gt;Terraform to deploy infrastructure&lt;/a&gt; and almost exclusively on Azure. I have created and altered many environments for clients over the past couple of years using Terraform. I have also used ARM templates but found them confusing and unwieldly to use.&lt;/p&gt;</description></item><item><title>Viewing GitHub Pages Locally With a Remote Theme</title><link>https://blog.robsewell.com/blog/viewing-github-pages-locally-with-a-remote-theme/</link><pubDate>Thu, 15 Apr 2021 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/viewing-github-pages-locally-with-a-remote-theme/</guid><description>&lt;img src="https://datasaturdays.com/assets/design/twitter/c.twitter%201r.png" alt="Featured image of post Viewing GitHub Pages Locally With a Remote Theme" /&gt;&lt;h1 id="a-different-method-for-my-own-site"&gt;A different method for my own site
&lt;/h1&gt;&lt;p&gt;This blog post is for Mikey Bronowski &lt;a class="link" href="https://twitter.com/mikeybronowski" target="_blank" rel="noopener"
&gt;t&lt;/a&gt; - &lt;a class="link" href="https://www.bronowski.it/blog/" target="_blank" rel="noopener"
&gt;b&lt;/a&gt; and Jonathan Allen &lt;a class="link" href="https://twitter.com/fatherjack" target="_blank" rel="noopener"
&gt;t&lt;/a&gt; - &lt;a class="link" href="https://fatherjack.github.io/" target="_blank" rel="noopener"
&gt;b&lt;/a&gt; after a twitter discussion a few weeks ago.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;How can I see my GitHub Pages site locally when I use a remote theme?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="do-you-need-to"&gt;Do you need to?
&lt;/h2&gt;&lt;p&gt;My first answer is do you need to see them? Once you have your theme set up as you like, you can view your blog in Visual Studio Code using the keyboard shortcut &lt;code&gt;CTRL + K, V&lt;/code&gt; and you can see a live preview of your post as you type.&lt;/p&gt;</description></item><item><title>TSQL2sDay - Do I use Notebooks?</title><link>https://blog.robsewell.com/blog/tsql2sday-do-i-use-notebooks/</link><pubDate>Tue, 13 Apr 2021 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/tsql2sday-do-i-use-notebooks/</guid><description>&lt;img src="https://blog.robsewell.com/assets/images/TSQL2sDay150x150.jpg" alt="Featured image of post TSQL2sDay - Do I use Notebooks?" /&gt;&lt;h1 id="do-i-use-notebooks"&gt;Do I use Notebooks?
&lt;/h1&gt;&lt;p&gt;T-SQL Tuesday is the brainchild of Adam Machanic (&lt;a class="link" href="http://dataeducation.com/" target="_blank" rel="noopener"
&gt;Blog&lt;/a&gt; &lt;a class="link" href="https://twitter.com/adammachanic?lang=en" target="_blank" rel="noopener"
&gt;Twitter&lt;/a&gt;). The first T-SQL Tuesday invitation was in December 2009 and it is still going strong. It is a monthly blog party on the second Tuesday of each month. Currently, Steve Jones (&lt;a class="link" href="https://voiceofthedba.com/" target="_blank" rel="noopener"
&gt;Blog&lt;/a&gt; &lt;a class="link" href="https://twitter.com/way0utwest" target="_blank" rel="noopener"
&gt;Twitter&lt;/a&gt;) organises the event and maintains &lt;a class="link" href="http://tsqltuesday.com/" target="_blank" rel="noopener"
&gt;a website with all previous posts&lt;/a&gt;. Everyone is welcome to participate in this monthly blog post.&lt;/p&gt;</description></item><item><title>Viewing GitHub Pages Locally For Data Saturdays</title><link>https://blog.robsewell.com/blog/viewing-github-pages-locally-for-data-saturdays/</link><pubDate>Sun, 11 Apr 2021 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/viewing-github-pages-locally-for-data-saturdays/</guid><description>&lt;img src="https://datasaturdays.com/assets/design/twitter/c.twitter%201r.png" alt="Featured image of post Viewing GitHub Pages Locally For Data Saturdays" /&gt;&lt;h1 id="data-saturdays-has-new-clothes"&gt;Data Saturdays Has New Clothes!
&lt;/h1&gt;&lt;p&gt;The Data Saturdays Admins asked the community to vote on their favourite logo for the Data Saturdays website. After over 400 votes the results came in.&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://twitter.com/datasaturdays/status/1380152923498352644" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2021/newdatasaturdayclothes.jpg"
loading="lazy"
alt="newclothes"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Denny Cherry &amp;amp; Associates Consulting &lt;a class="link" href="https://www.dcac.com/" target="_blank" rel="noopener"
&gt;https://www.dcac.com/&lt;/a&gt; generously supported Data Saturdays and paid for the artist to design the logo and create the artifacts via &lt;a class="link" href="https://99designs.com" target="_blank" rel="noopener"
&gt;99designs.com&lt;/a&gt;. THANK YOU Denny and many thanks to Monica Rathbun &lt;a class="link" href="https://twitter.com/SQLEspresso" target="_blank" rel="noopener"
&gt;twitter&lt;/a&gt; - &lt;a class="link" href="https://sqlespresso.com/" target="_blank" rel="noopener"
&gt;blog&lt;/a&gt; for all of the hard work in organising and administering all of the requirements and handling all of the communication with the artists.&lt;/p&gt;</description></item><item><title>Creating a New Data Saturdays event</title><link>https://blog.robsewell.com/blog/creating-a-new-data-saturdays-event/</link><pubDate>Thu, 18 Mar 2021 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/creating-a-new-data-saturdays-event/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2021/datasaturdays.png" alt="Featured image of post Creating a New Data Saturdays event" /&gt;&lt;h1 id="creating-a-new-data-saturdays-event"&gt;Creating a New Data Saturdays Event
&lt;/h1&gt;&lt;p&gt;There&amp;rsquo;s a new process to create a Data Saturdays Event page, so I thought I would write an explanation and a run through&lt;/p&gt;
&lt;h2 id="what-is-data-saturdays-"&gt;What is Data Saturdays ?
&lt;/h2&gt;&lt;p&gt;Firstly, not everyone will know what a Data Saturday event is, so lets start with that. There are two parts to it.&lt;/p&gt;
&lt;p&gt;A Data Saturday is an event that provides (usually free) training and information sessions about Azure Data and SQL Server. At present they are hosted online.&lt;/p&gt;</description></item><item><title>Microsoft Values The Community</title><link>https://blog.robsewell.com/blog/microsoft-values-the-community/</link><pubDate>Wed, 17 Feb 2021 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/microsoft-values-the-community/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2021/MSCommunity.png" alt="Featured image of post Microsoft Values The Community" /&gt;&lt;h1 id="what-happens-next"&gt;What Happens Next?
&lt;/h1&gt;&lt;p&gt;When PASS announced that operations would cease, a common question was &amp;ldquo;OK, so what happens now? To SQL Saturdays?, to the summit?, to the local user groups?&amp;rdquo; The answers to some of those questions will lie in other conversations but for right now, let&amp;rsquo;s talk about Local User Groups.&lt;/p&gt;
&lt;h1 id="user-groups"&gt;User Groups
&lt;/h1&gt;&lt;p&gt;User groups are a fantastic way to expand your knowledge and your network. A place to find like minded people performing similar roles that you can learn from and get support from.&lt;/p&gt;</description></item><item><title>Tooling for TSql2sDay</title><link>https://blog.robsewell.com/blog/tooling-for-tsql2sday/</link><pubDate>Tue, 09 Feb 2021 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/tooling-for-tsql2sday/</guid><description>&lt;img src="https://blog.robsewell.com/assets/images/TSQL2sDay150x150.jpg" alt="Featured image of post Tooling for TSql2sDay" /&gt;&lt;h1 id="tooling-for-tsql2sday"&gt;Tooling for TSQL2sDay
&lt;/h1&gt;&lt;p&gt;T-SQL Tuesday is the brainchild of Adam Machanic (&lt;a class="link" href="http://dataeducation.com/" target="_blank" rel="noopener"
&gt;Blog&lt;/a&gt; &lt;a class="link" href="https://twitter.com/adammachanic?lang=en" target="_blank" rel="noopener"
&gt;Twitter&lt;/a&gt;). The first T-SQL Tuesday invitation was in December 2009 and it is still going strong. It is a monthly blog party on the second Tuesday of each month. Currently, Steve Jones (&lt;a class="link" href="https://voiceofthedba.com/" target="_blank" rel="noopener"
&gt;Blog&lt;/a&gt; &lt;a class="link" href="https://twitter.com/way0utwest" target="_blank" rel="noopener"
&gt;Twitter&lt;/a&gt;) organises the event and maintains &lt;a class="link" href="http://tsqltuesday.com/" target="_blank" rel="noopener"
&gt;a website with all previous posts&lt;/a&gt;. Everyone is welcome to participate in this monthly blog post.&lt;/p&gt;
&lt;p&gt;This month’s T-SQL Tuesday is hosted by Mikey Bronowski ( &lt;a class="link" href="https://www.bronowski.it/blog/" target="_blank" rel="noopener"
&gt;Blog&lt;/a&gt; &lt;a class="link" href="https://twitter.com/@MikeyBronowski" target="_blank" rel="noopener"
&gt;Twitter&lt;/a&gt; ). Mikey says:&lt;/p&gt;</description></item><item><title>Using PowerShell to Automate StreamLabs OBS and Show Your Webcam in PowerPoint</title><link>https://blog.robsewell.com/blog/using-powershell-to-automate-streamlabs-obs-and-show-your-webcam-in-powerpoint/</link><pubDate>Mon, 21 Sep 2020 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/using-powershell-to-automate-streamlabs-obs-and-show-your-webcam-in-powerpoint/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2020/09/scottwitter.png" alt="Featured image of post Using PowerShell to Automate StreamLabs OBS and Show Your Webcam in PowerPoint" /&gt;&lt;h2 id="it-started-with-a-tweet"&gt;It started with a tweet
&lt;/h2&gt;&lt;p&gt;As with many things in my life it started with a tweet&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://twitter.com/sammydeprez/status/1307674009669074945" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2020/09/scottwitter.png"
loading="lazy"
alt="Twitter"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;That looks awesome, I thought, so I watched the YouTube video.Scott has written a C# application that would change the scene depending on some text in the PowerPoint slide notes. Then, by applying a Chroma filter to the display capture and placing the webcam capture appropriately, when the slide changed, the Obs scene changed and the webcam became embedded in the slide!!!!!!!&lt;/p&gt;</description></item><item><title>#tsql2sday #130 - Automate your stress away - Getting more SSIS Agent Job information</title><link>https://blog.robsewell.com/blog/tsql2sday-130-automate-your-stress-away-getting-more-ssis-agent-job-information/</link><pubDate>Tue, 08 Sep 2020 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/tsql2sday-130-automate-your-stress-away-getting-more-ssis-agent-job-information/</guid><description>&lt;img src="https://blog.robsewell.com/assets/images/TSQL2sDay150x150.jpg" alt="Featured image of post #tsql2sday #130 - Automate your stress away - Getting more SSIS Agent Job information" /&gt;&lt;h1 id="automation"&gt;Automation
&lt;/h1&gt;&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;This month it is hosted by Elizabeth Noble &lt;!-- raw HTML omitted --&gt;blog&lt;!-- raw HTML omitted --&gt; and &lt;!-- raw HTML omitted --&gt;twitter&lt;!-- raw HTML omitted --&gt;.&lt;/p&gt;
&lt;p&gt;Thank you Elizabeth&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://blog.robsewell.com/assets/images/TSQL2sDay150x150.jpg"
loading="lazy"
alt="tsql2sday"
&gt;&lt;/p&gt;
&lt;p&gt;Elizabeth asks&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;My invitation to you is I want to know what you have automated to make your life easier?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="from-the-past"&gt;From the Past
&lt;/h2&gt;&lt;p&gt;I am in the process of migrating my blog to GitHub pages and whilst doing so, I read my first ever technical blog post &lt;a class="link" href="https://blog.robsewell.com/blog/you-have-to-start-somewhere/" target="_blank" rel="noopener"
&gt;You have to start somewhere&lt;/a&gt; In it I mention this blog post by John Sansom &lt;a class="link" href="http://www.johnsansom.com/the-best-database-administrators-automate-everything/" target="_blank" rel="noopener"
&gt;The Best Database Administrators Automate Everything&lt;/a&gt; which I am pleased to see is still available nearly a decade later&lt;/p&gt;</description></item><item><title>The first page with GitHub Pages</title><link>https://blog.robsewell.com/blog/the-first-page-with-github-pages/</link><pubDate>Thu, 03 Sep 2020 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/the-first-page-with-github-pages/</guid><description>&lt;p&gt;Last night I started the experiment that has been in my head for a while now, to move from SQL Dba With A Beard to RobSewell.com&lt;/p&gt;
&lt;p&gt;Thank you Chrissy &lt;a class="link" href="https://blog.netnerds.net/" target="_blank" rel="noopener"
&gt;Blog&lt;/a&gt; &lt;a class="link" href="https://twitter.com/cl" target="_blank" rel="noopener"
&gt;Twitter&lt;/a&gt; for the push!&lt;/p&gt;
&lt;p&gt;I followed the instructions from her blog post &lt;a class="link" href="https://blog.netnerds.net/2020/08/migrating-my-wordpress-sites-to-github-pages/" target="_blank" rel="noopener"
&gt;Migrating my WordPress sites to GitHub Pages&lt;/a&gt; but chose to use the &lt;a class="link" href="https://github.com/mmistakes/minimal-mistakes" target="_blank" rel="noopener"
&gt;Minimal Mistakes theme&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I like the search at the top and the &lt;a class="link" href="https://blog.robsewell.com/404.html" target="_blank" rel="noopener"
&gt;404 page :-)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Now I need to export the wordpress from SQLDbaWithABeard.com (Its currently running)&lt;/p&gt;</description></item><item><title>Creating Azure SQL Database AAD Contained Database Users with an SPN using PowerShell, Secrets Management, Azure Key Vault, and dbatools</title><link>https://blog.robsewell.com/blog/creating-azure-sql-database-aad-contained-database-users-with-an-spn-using-powershell-secrets-management-azure-key-vault-and-dbatools/</link><pubDate>Fri, 21 Aug 2020 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/creating-azure-sql-database-aad-contained-database-users-with-an-spn-using-powershell-secrets-management-azure-key-vault-and-dbatools/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2020/08/image-16.png" alt="Featured image of post Creating Azure SQL Database AAD Contained Database Users with an SPN using PowerShell, Secrets Management, Azure Key Vault, and dbatools" /&gt;&lt;p&gt;Following on from my posts about using Secret Management &lt;a class="link" href="https://blog.robsewell.com/good-bye-import-clixml-use-the-secrets-management-module-for-your-labs-and-demos/" target="_blank" rel="noopener"
&gt;Good bye Import-CliXml&lt;/a&gt; and &lt;a class="link" href="https://blog.robsewell.com/using-secret-management-module-to-run-ssms-vs-code-and-azure-data-studio-as-another-user/" target="_blank" rel="noopener"
&gt;running programmes as a different user&lt;/a&gt;, I have another use case.&lt;/p&gt;
&lt;p&gt;After creating Azure SQL Databases in an Elastic Pool using a process pretty similar to this one &lt;a class="link" href="https://blog.robsewell.com/building-azure-sql-db-with-terraform-using-azure-devops/" target="_blank" rel="noopener"
&gt;I blogged about last year&lt;/a&gt;, I needed to be able to programmatically create users and assign permissions.&lt;/p&gt;
&lt;h2 id="i-need-a-user-to-login-with"&gt;I need a user to login with
&lt;/h2&gt;&lt;p&gt;When I created my Azure SQL Server with Terraform, I set the Azure Admin to be a SPN as you can see in the image from the portal and set it to have an identity using the documentation for &lt;a class="link" href="https://www.terraform.io/docs/providers/azurerm/r/sql_server.html" target="_blank" rel="noopener"
&gt;azurerm_mssql_server&lt;/a&gt;.&lt;/p&gt;</description></item><item><title>Notifying a Teams Channel of a SQL Agent Job result</title><link>https://blog.robsewell.com/blog/notifying-a-teams-channel-of-a-sql-agent-job-result/</link><pubDate>Wed, 29 Jul 2020 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/notifying-a-teams-channel-of-a-sql-agent-job-result/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2020/07/image-18.png" alt="Featured image of post Notifying a Teams Channel of a SQL Agent Job result" /&gt;&lt;p&gt;Following on from &lt;a class="link" href="https://blog.robsewell.com/sending-a-sql-agent-job-results-overview-to-a-microsoft-teams-channel/" target="_blank" rel="noopener"
&gt;yesterdays post about creating an overview of SQL Agent Job Results and sending it to a Teams channel&lt;/a&gt;, I was given another challenge&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Can you write a job step that I can add to SQL Agent jobs that can send the result of that job to a Teams Channel&lt;/p&gt;
&lt;p&gt;A person with a need&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The use case was for some migration projects that had steps that were scheduled via SQL Agent Jobs and instead of the DBA having to estimate when they would finish and keep checking so that they could let the next team know that it was time for their part to start, they wanted it to notify a Teams channel. This turned out especially useful as the job finished earlier than expected at 3am and the off-shore team could begin their work immediately.&lt;/p&gt;</description></item><item><title>Sending a SQL Agent Job results overview to a Microsoft Teams Channel</title><link>https://blog.robsewell.com/blog/sending-a-sql-agent-job-results-overview-to-a-microsoft-teams-channel/</link><pubDate>Tue, 28 Jul 2020 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/sending-a-sql-agent-job-results-overview-to-a-microsoft-teams-channel/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2020/07/image-11.png" alt="Featured image of post Sending a SQL Agent Job results overview to a Microsoft Teams Channel" /&gt;&lt;p&gt;Microsoft Teams is fantastic for collaboration. It enables groups of people, teams if you like to be able to communicate, collaborate on documents, hold meetings and much much more.&lt;/p&gt;
&lt;h2 id="sql-agent-job-overview"&gt;SQL Agent Job Overview
&lt;/h2&gt;&lt;p&gt;Using &lt;a class="link" href="http://dbatools.io" target="_blank" rel="noopener"
&gt;dbatools&lt;/a&gt; we can create a simple script to gather the results of Agent Jobs form a list of instances. Maybe it would be good to be able to get the job runs results every 12 hours so that at 6am in the morning the early-bird DBA can quickly identify if there are any failures that need immediate action and at 6pm , the team can check that everything was ok before they clock off.&lt;/p&gt;</description></item><item><title>Using Secret Management module to run SSMS, VS Code and Azure Data Studio as another user</title><link>https://blog.robsewell.com/blog/using-secret-management-module-to-run-ssms-vs-code-and-azure-data-studio-as-another-user/</link><pubDate>Mon, 20 Jul 2020 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/using-secret-management-module-to-run-ssms-vs-code-and-azure-data-studio-as-another-user/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2020/07/runas.png" alt="Featured image of post Using Secret Management module to run SSMS, VS Code and Azure Data Studio as another user" /&gt;&lt;p&gt;Following on from &lt;a class="link" href="https://blog.robsewell.com/blog/jupyter%20notebooks/azure%20data%20studio/powershell/dbatools/good-bye-import-clixml-use-the-secrets-management-module-for-your-labs-and-demos/" target="_blank" rel="noopener"
&gt;my last post about the Secret Management module&lt;/a&gt;. I was asked another question.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Can I use this to run applications as my admin account?&lt;/p&gt;
&lt;p&gt;A user with a beard&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;It is good practice to not log into your work station with an account with admin privileges. In many shops, you will need to open applications that can do administration tasks with another set of account credentials.&lt;/p&gt;
&lt;p&gt;Unfortunately, people being people, they will often store their admin account credentials in a less than ideal manner (OneNote, Notepad ++ etc) to make it easier for them, so that when they right click and run as a different user, they can copy and paste the password.&lt;/p&gt;</description></item><item><title>Good Bye Import-CliXML – Use the Secrets Management module for your labs and demos</title><link>https://blog.robsewell.com/blog/good-bye-import-clixml-use-the-secrets-management-module-for-your-labs-and-demos/</link><pubDate>Sat, 18 Jul 2020 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/good-bye-import-clixml-use-the-secrets-management-module-for-your-labs-and-demos/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2020/07/image-1.png" alt="Featured image of post Good Bye Import-CliXML – Use the Secrets Management module for your labs and demos" /&gt;&lt;p&gt;Don’t want to read all this? There are two dotnet interactive notebooks here with the relevant information for you to use.&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://beard.media/dotnetnotebooks" target="_blank" rel="noopener"
&gt;https://beard.media/dotnetnotebooks&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="jaap-is-awesome"&gt;Jaap is awesome
&lt;/h2&gt;&lt;p&gt;&lt;img src="https://pbs.twimg.com/media/DBbP9lHXYAAopb3?format=jpg&amp;amp;name=4096x4096"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;I have to start here. For the longest time, whenever anyone has asked me how I store my credentials for use in my demos and labs I have always referred them to Jaap Brassers &lt;a class="link" href="https://twitter.com/Jaap_Brasser" target="_blank" rel="noopener"
&gt;t&lt;/a&gt; blog post&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://www.jaapbrasser.com/quickly-and-securely-storing-your-credentials-powershell/" target="_blank" rel="noopener"
&gt;https://www.jaapbrasser.com/quickly-and-securely-storing-your-credentials-powershell/&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="joel-is-also-awesome"&gt;Joel is also awesome!
&lt;/h2&gt;&lt;p&gt;When people wanted a method of storing credentials that didn&amp;rsquo;t involve files on disk I would suggest Joel Bennett’s &lt;a class="link" href="https://twitter.com/jaykul" target="_blank" rel="noopener"
&gt;t&lt;/a&gt; module BetterCredentials which uses the Windows Credential Manager&lt;/p&gt;</description></item><item><title>Surprised and Honoured and Proud</title><link>https://blog.robsewell.com/blog/surprised-and-honoured-and-proud/</link><pubDate>Wed, 01 Jul 2020 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/surprised-and-honoured-and-proud/</guid><description>&lt;p&gt;I have always been extremely proud to be a Cloud and Datacenter Management MVP, and lucky enough to be involved with both the PowerShell community as well as the Data Platform community.&lt;/p&gt;
&lt;p&gt;Today, July 1st is the date that many MVPs receive their renewal email to let them know that they have been awarded for another year. There is a lot of F5’ing and frequent checking of emails and “Have you heard yet?” DMs going around.&lt;/p&gt;</description></item><item><title>Running Jupyter Notebooks as Agent Jobs</title><link>https://blog.robsewell.com/blog/running-jupyter-notebooks-as-agent-jobs/</link><pubDate>Mon, 30 Mar 2020 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/running-jupyter-notebooks-as-agent-jobs/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2020/03/image-22.png" alt="Featured image of post Running Jupyter Notebooks as Agent Jobs" /&gt;&lt;p&gt;&lt;a class="link" href="https://docs.microsoft.com/en-us/sql/azure-data-studio/download-azure-data-studio?view=sql-server-ver15?WT.mc_id=DP-MVP-5002693" target="_blank" rel="noopener"
&gt;Azure Data Studio&lt;/a&gt; is a great tool for connecting with your data platform whether it is in Azure or on your hardware. &lt;a class="link" href="https://blog.robsewell.com/?s=notebooks" target="_blank" rel="noopener"
&gt;Jupyter Notebooks&lt;/a&gt; are fantastic, you can have words, pictures, code and code results all saved in one document.&lt;/p&gt;
&lt;p&gt;I have created a repository in my GitHub &lt;a class="link" href="https://beard.media/Notebooks" target="_blank" rel="noopener"
&gt;https://beard.media/Notebooks&lt;/a&gt; where I have stored a number of Jupyter notebooks both for Azure Data Studio and the &lt;a class="link" href="https://blog.robsewell.com/new-net-notebooks-are-here-powershell-7-notebooks-are-here/" target="_blank" rel="noopener"
&gt;new .NET interactive&lt;/a&gt; notebooks.&lt;/p&gt;</description></item><item><title>.NET PowerShell Notebooks – Using Pester</title><link>https://blog.robsewell.com/blog/.net-powershell-notebooks-using-pester/</link><pubDate>Sat, 22 Feb 2020 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/.net-powershell-notebooks-using-pester/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2020/02/image-16.png" alt="Featured image of post .NET PowerShell Notebooks – Using Pester" /&gt;&lt;p&gt;&lt;a class="link" href="http://localhost:4001/blog/jupyter%20notebooks/azure%20data%20studio/powershell/pwsh/dbatools/dbachecks/new-net-notebooks-are-here-powershell-7-notebooks-are-here/" target="_blank" rel="noopener"
&gt;My last post&lt;/a&gt; had a lot of information about the new .NET PowerShell notebooks including installation instructions.&lt;/p&gt;
&lt;p&gt;.NET Notebooks are Jupyter Notebooks that use .NET core to enable C#, F# and PowerShell kernels.&lt;/p&gt;
&lt;h2 id="use-cases"&gt;Use Cases
&lt;/h2&gt;&lt;p&gt;One of the main benefits that I see for Jupyter Notebooks for Ops folk is that the results of the query are saved with the notebook. This makes them fantastic for Incident resolution.&lt;/p&gt;
&lt;p&gt;If you have an incident at 3am and you know that you will need that information in the wash up meeting the next day instead of copying and pasting results into a OneNote document or a text file, you can simply run the queries in a notebook and save it.&lt;/p&gt;</description></item><item><title>Use Jupyter Notebooks to Help People on StackOverFlow</title><link>https://blog.robsewell.com/blog/use-jupyter-notebooks-to-help-people-on-stackoverflow/</link><pubDate>Sat, 22 Feb 2020 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/use-jupyter-notebooks-to-help-people-on-stackoverflow/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2020/02/image-16.png" alt="Featured image of post Use Jupyter Notebooks to Help People on StackOverFlow" /&gt;&lt;p&gt;I am sat in the PowerShell Saturday in Hamburg. You can see me on the right of this picture writing &lt;a class="link" href="https://blog.robsewell.com/blog/jupyter%20notebooks/azure%20data%20studio/pester/net-powershell-notebooks-using-pester/" target="_blank" rel="noopener"
&gt;my previous blog post!&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a class="link" href="https://twitter.com/JanDamaschke?ref_src=twsrc%5Etfw" target="_blank" rel="noopener"
&gt;@JanDamaschke&lt;/a&gt; spricht über Asynchrones Logging in &lt;a class="link" href="https://twitter.com/hashtag/powershell?src=hash&amp;amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener"
&gt;#powershell&lt;/a&gt; mit Classes und Runspaces &lt;img src="https://pbs.twimg.com/media/ERYdg-6XUAAbwBk?format=jpg"
loading="lazy"
&gt; (&lt;a class="link" href="https://twitter.com/hhpsug?ref_src=twsrc%5Etfw" target="_blank" rel="noopener"
&gt;https://twitter.com/hhpsug?ref_src=twsrc%5Etfw&lt;/a&gt;) &lt;a class="link" href="https://twitter.com/hashtag/pssaturday?src=hash&amp;amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener"
&gt;#pssaturday&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;— Christoph Burmeister (@chrburmeister) &lt;a class="link" href="https://twitter.com/chrburmeister/status/1231204011270909954?ref_src=twsrc%5Etfw" target="_blank" rel="noopener"
&gt;February 22, 2020&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I was talking with my friend Mathias Jessen &lt;a class="link" href="https://twitter.com/IISResetMe" target="_blank" rel="noopener"
&gt;@IISResetMe on Twitter&lt;/a&gt; about notebooks and he said that another great use case was to use them on Stack OverFlow&lt;/p&gt;</description></item><item><title>New .NET Notebooks are here – PowerShell 7 notebooks are here.</title><link>https://blog.robsewell.com/blog/new-.net-notebooks-are-here-powershell-7-notebooks-are-here./</link><pubDate>Fri, 07 Feb 2020 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/new-.net-notebooks-are-here-powershell-7-notebooks-are-here./</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2020/02/image-13.png" alt="Featured image of post New .NET Notebooks are here – PowerShell 7 notebooks are here." /&gt;&lt;p&gt;Data Science folk used Notebooks for documentation and to show re-runnable research. Azure Data Studio included this notebook functionality and &lt;a class="link" href="https://blog.robsewell.com/dbatools/dbachecks/blog/jupyter%20notebooks/azure%20data%20studio/powershell/whats-a-sql-notebook-in-azure-data-studio/" target="_blank" rel="noopener"
&gt;added SQL&lt;/a&gt; kernel where &lt;a class="link" href="https://blog.robsewell.com/blog/jupyter%20notebooks/azure%20data%20studio/powershell/dbachecks/dbatools/powershell-in-sql-notebooks-in-azure-data-studio//" target="_blank" rel="noopener"
&gt;with a little bit of faffing you could run PowerShell&lt;/a&gt; and then a &lt;a class="link" href="https://blog.robsewell.com/blog/jupyter%20notebooks/azure%20data%20studio/powershell/dbatools/powershell-notebooks-in-azure-data-studio/" target="_blank" rel="noopener"
&gt;Python kernel that enabled PowerShell&lt;/a&gt;. It seems that notebooks are so cool that everyone is creating them these days! I was browsing twitter when I saw this tweet.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;.NET Notebooks Preview 2 is here! Preview 2 includes 🎉&lt;a class="link" href="https://twitter.com/PowerShell_Team?ref_src=twsrc%5Etfw" target="_blank" rel="noopener"
&gt;@PowerShell_Team&lt;/a&gt;, &lt;a class="link" href="https://twitter.com/nteractio?ref_src=twsrc%5Etfw" target="_blank" rel="noopener"
&gt;@nteractio&lt;/a&gt;, and a new tool. Check out our blog to learn more. Congratulations to &lt;a class="link" href="https://twitter.com/jonsequitur?ref_src=twsrc%5Etfw" target="_blank" rel="noopener"
&gt;@jonsequitur&lt;/a&gt; &lt;a class="link" href="https://twitter.com/colombod?ref_src=twsrc%5Etfw" target="_blank" rel="noopener"
&gt;@colombod&lt;/a&gt; and our entire team&lt;a class="link" href="https://t.co/WqNWQWR3Bo" target="_blank" rel="noopener"
&gt;https://t.co/WqNWQWR3Bo&lt;/a&gt;&lt;a class="link" href="https://twitter.com/dotnet?ref_src=twsrc%5Etfw" target="_blank" rel="noopener"
&gt;@dotnet&lt;/a&gt; &lt;a class="link" href="https://twitter.com/hashtag/jupyter?src=hash&amp;amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener"
&gt;#jupyter&lt;/a&gt; &lt;a class="link" href="https://twitter.com/hashtag/PowerShell?src=hash&amp;amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener"
&gt;#PowerShell&lt;/a&gt; &lt;a class="link" href="https://twitter.com/hashtag/interactiveprogramming?src=hash&amp;amp;ref_src=twsrc%5Etfw" target="_blank" rel="noopener"
&gt;#interactiveprogramming&lt;/a&gt;.&lt;/p&gt;</description></item><item><title>How to fork a GitHub repository and contribute to an open source project</title><link>https://blog.robsewell.com/blog/how-to-fork-a-github-repository-and-contribute-to-an-open-source-project/</link><pubDate>Fri, 29 Nov 2019 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/how-to-fork-a-github-repository-and-contribute-to-an-open-source-project/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2019/11/CreatePR.png" alt="Featured image of post How to fork a GitHub repository and contribute to an open source project" /&gt;&lt;p&gt;I enjoy maintaining open source GitHub repositories such as &lt;a class="link" href="https://github.com/sqlcollaborative/dbachecks" target="_blank" rel="noopener"
&gt;dbachecks&lt;/a&gt; and &lt;a class="link" href="https://github.com/sqlcollaborative/ADSNotebook" target="_blank" rel="noopener"
&gt;ADSNotebook&lt;/a&gt;. I absolutely love it when people add more functionality to them.&lt;/p&gt;
&lt;p&gt;To collaborate with a repository in GitHub you need to follow these steps&lt;/p&gt;
&lt;p&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2019/11/GitHub.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Fork the repository into your own GitHub&lt;/li&gt;
&lt;li&gt;Clone the repository to your local machine&lt;/li&gt;
&lt;li&gt;Create a new branch for your changes&lt;/li&gt;
&lt;li&gt;Make some changes and commit them with useful messages&lt;/li&gt;
&lt;li&gt;Push the changes to your repository&lt;/li&gt;
&lt;li&gt;Create a Pull Request from your repository back to the original one&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;You will need to have &lt;code&gt;git.exe&lt;/code&gt; available which you can download and install from &lt;a class="link" href="https://git-scm.com/downloads" target="_blank" rel="noopener"
&gt;https://git-scm.com/downloads&lt;/a&gt; if required&lt;/p&gt;</description></item><item><title>Fixing the Failed to generate the compressed file for module dotnet.exe error when deploying to the PowerShell Gallery using Azure DevOps</title><link>https://blog.robsewell.com/blog/fixing-the-failed-to-generate-the-compressed-file-for-module-dotnet.exe-error-when-deploying-to-the-powershell-gallery-using-azure-devops/</link><pubDate>Tue, 26 Nov 2019 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/fixing-the-failed-to-generate-the-compressed-file-for-module-dotnet.exe-error-when-deploying-to-the-powershell-gallery-using-azure-devops/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2019/11/image-40.png" alt="Featured image of post Fixing the Failed to generate the compressed file for module dotnet.exe error when deploying to the PowerShell Gallery using Azure DevOps" /&gt;&lt;h1 id="fixing-the-failed-to-generate-the-compressed-file-for-module-cprogram-filesdotnetdotnetexe-error-when-deploying-to-the-powershell-gallery-using-azure-devops"&gt;Fixing the Failed to generate the compressed file for module C:\Program Files\dotnet\dotnet.exe error when deploying to the PowerShell Gallery using Azure DevOps
&lt;/h1&gt;&lt;p&gt;The PowerShell module for validating your SQL Server estate &lt;a class="link" href="http://beard.media/dbachecks" target="_blank" rel="noopener"
&gt;dbachecks&lt;/a&gt; is deployed via &lt;a class="link" href="https://dev.azure.com/sqlcollaborative/dbachecks/_release?_a=releases&amp;amp;view=mine&amp;amp;definitionId=2" target="_blank" rel="noopener"
&gt;Azure DevOps, you can see how it is working (or not) via this link&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="grrr-automation-for-the-lose"&gt;Grrr Automation for the Lose!
&lt;/h2&gt;&lt;p&gt;Until recently, this had worked successfully. In the last few weeks I have been receiving errors&lt;/p&gt;</description></item><item><title>Dynamically Creating Azure Data Studio Notebooks with PowerShell for an Incident Response Index Notebook</title><link>https://blog.robsewell.com/blog/dynamically-creating-azure-data-studio-notebooks-with-powershell-for-an-incident-response-index-notebook/</link><pubDate>Thu, 21 Nov 2019 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/dynamically-creating-azure-data-studio-notebooks-with-powershell-for-an-incident-response-index-notebook/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2019/11/image-39.png" alt="Featured image of post Dynamically Creating Azure Data Studio Notebooks with PowerShell for an Incident Response Index Notebook" /&gt;&lt;p&gt;Now that &lt;a class="link" href="https://aka.ms/azuredatastudio" target="_blank" rel="noopener"
&gt;Azure Data Studio&lt;/a&gt; has &lt;a class="link" href="https://docs.microsoft.com/en-us/sql/azure-data-studio/release-notes-azure-data-studio?view=sql-server-ver15?WT.mc_id=DP-MVP-5002693" target="_blank" rel="noopener"
&gt;PowerShell Notebooks&lt;/a&gt; and there is a &lt;a class="link" href="https://blog.robsewell.com/blog/create-a-powershell-notebook-for-azure-data-studio-with-powershell/" target="_blank" rel="noopener"
&gt;PowerShell Module for creating notebooks&lt;/a&gt;. I have been asked, more than once, what is the point? What is the use case? How does this help. I hope that this post will spark some ideas of one particular use-case.&lt;/p&gt;
&lt;p&gt;I showed my silly example PowerShell code to create a PowerShell Notebook that created a PowerShell Notebook to my good friend Nick.&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;</description></item><item><title>Create a PowerShell Notebook for Azure Data Studio with PowerShell</title><link>https://blog.robsewell.com/blog/create-a-powershell-notebook-for-azure-data-studio-with-powershell/</link><pubDate>Thu, 14 Nov 2019 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/create-a-powershell-notebook-for-azure-data-studio-with-powershell/</guid><description>&lt;p&gt;The latest update to the ADSNotebook PowerShell module &lt;a class="link" href="https://blog.robsewell.com/create-azure-data-studio-sql-notebooks-with-powershell/" target="_blank" rel="noopener"
&gt;I blogged about here&lt;/a&gt; now enables the creation of PowerShell notebooks with PowerShell.&lt;/p&gt;
&lt;p&gt;You can install the module with&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Install-Module ADSNotebook
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;or if you have already installed it you can use&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Update-Module ADSNotebook
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In the latest release, there is an extra parameter for &lt;code&gt;New-AdsWorkBook&lt;/code&gt; of &lt;code&gt;-Type&lt;/code&gt; which will accept either SQL or PowerShell&lt;/p&gt;
&lt;h2 id="create-a-powershell-notebook-with-powershell-rob"&gt;Create a PowerShell Notebook with PowerShell Rob
&lt;/h2&gt;&lt;p&gt;OK!&lt;/p&gt;</description></item><item><title>Create Azure Data Studio SQL Notebooks with PowerShell</title><link>https://blog.robsewell.com/blog/create-azure-data-studio-sql-notebooks-with-powershell/</link><pubDate>Thu, 07 Nov 2019 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/create-azure-data-studio-sql-notebooks-with-powershell/</guid><description>&lt;p&gt;At PASS Summit today I gave a presentation about SQL Notebooks in Azure Data Studio for the DBA. I demo’d the &lt;a class="link" href="https://www.powershellgallery.com/packages/ADSNotebook" target="_blank" rel="noopener"
&gt;PowerShell module ADSNotebook&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2019/11/image-32.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://github.com/sqlcollaborative/ADSNotebook" target="_blank" rel="noopener"
&gt;which you can also find on GitHub&lt;/a&gt; (where I will be glad to take PR’s to improve it 🙂 )&lt;/p&gt;
&lt;p&gt;This module has 3 functions&lt;/p&gt;
&lt;p&gt;This module contains only 3 commands at present&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Convert-ADSPowerShellForMarkdown&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This will create the markdown link for embedding PowerShell code in a Text Cell for a SQL Notebook as described &lt;a class="link" href="https://blog.robsewell.com/powershell-in-sql-notebooks-in-azure-data-studio/" target="_blank" rel="noopener"
&gt;in this blog post&lt;/a&gt;&lt;/p&gt;</description></item><item><title>My current VS Code Extensions and using a workspace file</title><link>https://blog.robsewell.com/blog/my-current-vs-code-extensions-and-using-a-workspace-file/</link><pubDate>Fri, 01 Nov 2019 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/my-current-vs-code-extensions-and-using-a-workspace-file/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2019/11/image-26.png" alt="Featured image of post My current VS Code Extensions and using a workspace file" /&gt;&lt;p&gt;I have been asked a couple of times recently what my Visual Studio Code extensions are at the moment so I thought I would write a quick post and also look at workspaces and how you can enable and disable extensions within them&lt;/p&gt;
&lt;h2 id="listing-extensions"&gt;Listing Extensions
&lt;/h2&gt;&lt;p&gt;From the command line you can list your extensions using&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;code --list-extensions
code-insiders --list-extensions
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;My list looks like this&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/assets/uploads/2019/11/image.png?ssl=1" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2019/11/image.png"
loading="lazy"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;You can also see them in the view on the left of default Visual Studio Code and open them with CTRL + SHIFT + X (unless like me you have Snagit installed and it has taken that shortcut&lt;/p&gt;</description></item><item><title>PowerShell Notebooks in Azure Data Studio</title><link>https://blog.robsewell.com/blog/powershell-notebooks-in-azure-data-studio/</link><pubDate>Thu, 17 Oct 2019 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/powershell-notebooks-in-azure-data-studio/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2019/10/image-8.png" alt="Featured image of post PowerShell Notebooks in Azure Data Studio" /&gt;&lt;p&gt;The latest release of the &lt;a class="link" href="https://github.com/microsoft/azuredatastudio#try-out-the-latest-insiders-build-from-master" target="_blank" rel="noopener"
&gt;insiders edition of Azure Data Studio&lt;/a&gt; brings the first edition of PowerShell Notebooks!&lt;/p&gt;
&lt;p&gt;You can download the latest insiders edition from the link above, it can be installed alongside the stable release.&lt;/p&gt;
&lt;p&gt;To access many of the commands available use F1 to open the command palette (like many of my tips this also works in Visual Studio Code). You can then start typing to get the command that you want.&lt;/p&gt;</description></item><item><title>Getting SQL Server installation date with PowerShell using dbatools</title><link>https://blog.robsewell.com/blog/getting-sql-server-installation-date-with-powershell-using-dbatools/</link><pubDate>Fri, 11 Oct 2019 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/getting-sql-server-installation-date-with-powershell-using-dbatools/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2019/10/image-7.png" alt="Featured image of post Getting SQL Server installation date with PowerShell using dbatools" /&gt;&lt;p&gt;Most of my writing time at the moment is devoted to  &lt;em&gt;&lt;a class="link" href="https://dbatools.io/book" target="_blank" rel="noopener"
&gt;Learn dbatools in a Month of Lunches&lt;/a&gt;&lt;/em&gt; which is now available but here is a short post following a question someone asked me.&lt;/p&gt;
&lt;h2 id="how-can-i-get-the-installation-date-for-sql-server-on-my-estate-into-a-database-with-dbatools-"&gt;How can I get the Installation Date for SQL Server on my estate into a database with dbatools ?
&lt;/h2&gt;&lt;p&gt;You can get the date that SQL Server was installed using the creation date of the NT Authority\System login using T-SQL&lt;/p&gt;</description></item><item><title>MEAP MEAP – #dbatoolsMoL – Live Book edition</title><link>https://blog.robsewell.com/blog/meap-meap-dbatoolsmol-live-book-edition/</link><pubDate>Wed, 04 Sep 2019 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/meap-meap-dbatoolsmol-live-book-edition/</guid><description>&lt;p&gt;It’s been a busy time!&lt;/p&gt;
&lt;p&gt;As well as many other things, the fantastical &lt;a class="link" href="https://en.wikipedia.org/wiki/Benevolent_dictator_for_life" target="_blank" rel="noopener"
&gt;BDFL&lt;/a&gt; of &lt;a class="link" href="https://dbatools.io" target="_blank" rel="noopener"
&gt;dbatools&lt;/a&gt; Chrissy Lemaire &lt;a class="link" href="https://twitter.com/cl" target="_blank" rel="noopener"
&gt;@cl&lt;/a&gt; and myself have written enough of a chunk of &lt;em&gt;&lt;a class="link" href="https://beard.media/bookblog" target="_blank" rel="noopener"
&gt;Learn dbatools in a Month of Lunches&lt;/a&gt;&lt;/em&gt; that our publisher &lt;a class="link" href="https://beard.media/bookblog" target="_blank" rel="noopener"
&gt;Manning Publications&lt;/a&gt; have agreed to release it as a MEAP. Not a text book, this book is written in a fun conversational style and split up into chapters that you can read in a lunch-time.&lt;/p&gt;</description></item><item><title>PowerShell in SQL Notebooks in Azure Data Studio</title><link>https://blog.robsewell.com/blog/powershell-in-sql-notebooks-in-azure-data-studio/</link><pubDate>Wed, 17 Jul 2019 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/powershell-in-sql-notebooks-in-azure-data-studio/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2019/07/image-4.png" alt="Featured image of post PowerShell in SQL Notebooks in Azure Data Studio" /&gt;&lt;p&gt;I have done a lot of writing in the last few months but you see no blog posts! My wonderful friend Chrissy and I are writing “dbatools in a Month of Lunches” to be published by Manning. That has taken up a lot of my writing mojo. We have hit a little break whilst we have some reviews done ready for the &lt;a class="link" href="https://www.manning.com/meap-program" target="_blank" rel="noopener"
&gt;MEAP&lt;/a&gt; (For everyone who asks, the answer is the unfulfilling ‘soon’) so it’s time for a blog post!&lt;/p&gt;</description></item><item><title>Azure SQL Linux VM – configuring SQL, installing pwsh and connecting and interacting with dbatools</title><link>https://blog.robsewell.com/blog/azure-sql-linux-vm-configuring-sql-installing-pwsh-and-connecting-and-interacting-with-dbatools/</link><pubDate>Thu, 25 Apr 2019 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/azure-sql-linux-vm-configuring-sql-installing-pwsh-and-connecting-and-interacting-with-dbatools/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2019/04/image-125.png" alt="Featured image of post Azure SQL Linux VM – configuring SQL, installing pwsh and connecting and interacting with dbatools" /&gt;&lt;p&gt;In my posts about using Azure Devops to build Azure resources with Terraform, &lt;a class="link" href="https://blog.robsewell.com/using-the-same-azure-devops-build-steps-for-terraform-with-different-pipelines-with-task-groups/" target="_blank" rel="noopener"
&gt;I built a Linux SQL VM.&lt;/a&gt; I used the &lt;a class="link" href="https://github.com/SQLDBAWithABeard/Presentations-AzureSQLVM" target="_blank" rel="noopener"
&gt;Terraform in this GitHub&lt;/a&gt; repository and created this&lt;/p&gt;
&lt;p&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2019/04/image-114.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;h2 id="connecting-with-mobaxterm"&gt;Connecting with MobaXterm
&lt;/h2&gt;&lt;p&gt;I had set the Network security rules to accept connections only from my static IP using variables in the Build Pipeline. I use &lt;a class="link" href="https://mobaxterm.mobatek.net/" target="_blank" rel="noopener"
&gt;MobaXterm&lt;/a&gt; as my SSH client. Its a free download. I click on sessions&lt;/p&gt;</description></item><item><title>Using Azure DevOps Build Pipeline Templates with Terraform to build an AKS cluster</title><link>https://blog.robsewell.com/blog/using-azure-devops-build-pipeline-templates-with-terraform-to-build-an-aks-cluster/</link><pubDate>Mon, 22 Apr 2019 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/using-azure-devops-build-pipeline-templates-with-terraform-to-build-an-aks-cluster/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2019/04/image-151.png" alt="Featured image of post Using Azure DevOps Build Pipeline Templates with Terraform to build an AKS cluster" /&gt;&lt;p&gt;In the last few posts I have moved from &lt;a class="link" href="https://blog.robsewell.com/building-azure-sql-db-with-terraform-with-visual-studio-code/" target="_blank" rel="noopener"
&gt;building an Azure SQL DB with Terraform using VS Code&lt;/a&gt; to &lt;a class="link" href="https://blog.robsewell.com/building-azure-sql-db-with-terraform-using-azure-devops/" target="_blank" rel="noopener"
&gt;automating the build process for the Azure SQL DB using Azure DevOps Build Pipelines&lt;/a&gt; to &lt;a class="link" href="https://blog.robsewell.com/using-the-same-azure-devops-build-steps-for-terraform-with-different-pipelines-with-task-groups/" target="_blank" rel="noopener"
&gt;using Task Groups in Azure DevOps to reuse the same Build Process and build an Azure Linux SQL VM and Network Security Group&lt;/a&gt;. This evolution is fantastic but Task Groups can only be used in the same Azure DevOps repository. It would be brilliant if I could use Configuration as Code for the Azure Build Pipeline and store that in a separate source control repository which can be used from any Azure DevOps Project.&lt;/p&gt;</description></item><item><title>Using the same Azure DevOps build steps for Terraform with different Pipelines with Task Groups to build an Azure Linux SQL VM</title><link>https://blog.robsewell.com/blog/using-the-same-azure-devops-build-steps-for-terraform-with-different-pipelines-with-task-groups-to-build-an-azure-linux-sql-vm/</link><pubDate>Mon, 22 Apr 2019 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/using-the-same-azure-devops-build-steps-for-terraform-with-different-pipelines-with-task-groups-to-build-an-azure-linux-sql-vm/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2019/04/image-107.png" alt="Featured image of post Using the same Azure DevOps build steps for Terraform with different Pipelines with Task Groups to build an Azure Linux SQL VM" /&gt;&lt;p&gt;In my &lt;a class="link" href="https://blog.robsewell.com/building-azure-sql-db-with-terraform-using-azure-devops/" target="_blank" rel="noopener"
&gt;last post&lt;/a&gt; I showed how to build an Azure DevOps Pipeline for a Terraform build of an Azure SQLDB. This will take the terraform code and build the required infrastructure.&lt;/p&gt;
&lt;p&gt;The plan all along has been to enable me to build &lt;em&gt;different&lt;/em&gt; environments depending on the requirement. Obviously I can repeat the steps from the last post for a new repository containing a Terraform code for a different environment but&lt;/p&gt;</description></item><item><title>Building Azure SQL Db with Terraform using Azure DevOps</title><link>https://blog.robsewell.com/blog/building-azure-sql-db-with-terraform-using-azure-devops/</link><pubDate>Sat, 20 Apr 2019 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/building-azure-sql-db-with-terraform-using-azure-devops/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2019/04/image-49.png" alt="Featured image of post Building Azure SQL Db with Terraform using Azure DevOps" /&gt;&lt;p&gt;In &lt;a class="link" href="https://blog.robsewell.com/building-azure-sql-db-with-terraform-with-visual-studio-code/" target="_blank" rel="noopener"
&gt;my last post&lt;/a&gt; I showed how to create a Resource Group and an Azure SQL Database with Terraform using Visual Studio Code to deploy.&lt;/p&gt;
&lt;p&gt;Of course, I haven&amp;rsquo;t stopped there, who wants to manually run code to create things. There was a lot of install this and set up that. I would rather give the code to a build system and get it to run it. I can then even set it to automatically deploy new infrastructure when I commit some code to alter the configuration.&lt;/p&gt;</description></item><item><title>Building Azure SQL Db with Terraform with Visual Studio Code</title><link>https://blog.robsewell.com/blog/building-azure-sql-db-with-terraform-with-visual-studio-code/</link><pubDate>Wed, 17 Apr 2019 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/building-azure-sql-db-with-terraform-with-visual-studio-code/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2019/04/image-42.png" alt="Featured image of post Building Azure SQL Db with Terraform with Visual Studio Code" /&gt;&lt;p&gt;I have been using &lt;a class="link" href="https://www.terraform.io/" target="_blank" rel="noopener"
&gt;Terraform&lt;/a&gt; for the last week or so to create some infrastructure and decided to bring that knowledge back to a problem that I and others suffer from – building environments for presentations, all for the sake of doing some learning.&lt;/p&gt;
&lt;h2 id="what-is-terraform"&gt;What is Terraform?
&lt;/h2&gt;&lt;p&gt;According to the website&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;HashiCorp Terraform enables you to safely and predictably create, change, and improve infrastructure. It is an open source tool that codifies APIs into declarative configuration files that can be shared amongst team members, treated as code, edited, reviewed, and versioned&lt;/p&gt;</description></item><item><title>Adding a Folder of Scripts to GitHub with Azure Data Studio</title><link>https://blog.robsewell.com/blog/adding-a-folder-of-scripts-to-github-with-azure-data-studio/</link><pubDate>Sun, 07 Apr 2019 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/adding-a-folder-of-scripts-to-github-with-azure-data-studio/</guid><description>&lt;p&gt;In my last post I showed how to &lt;a class="link" href="https://blog.robsewell.com/10501/" target="_blank" rel="noopener"
&gt;add a folder of scripts to GitHub&lt;/a&gt; using Visual Studio Code.&lt;/p&gt;
&lt;p&gt;You can do it with Azure Data Studio as well. It’s exactly the same steps!&lt;/p&gt;
&lt;p&gt;The blog post could end here but read on for some screen shots 😉&lt;/p&gt;
&lt;p&gt;Follow the previous post for details of setting up a new GitHub account&lt;/p&gt;
&lt;p&gt;Create a repository in GitHub&lt;/p&gt;
&lt;p&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2019/04/image-27.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;Open the folder in Azure Data Studio with CTRL K CTRL O (Or File –&amp;gt; Open Folder)&lt;/p&gt;</description></item><item><title>Adding a Folder of Scripts to GitHub</title><link>https://blog.robsewell.com/blog/adding-a-folder-of-scripts-to-github/</link><pubDate>Fri, 05 Apr 2019 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/adding-a-folder-of-scripts-to-github/</guid><description>&lt;p&gt;Yesterday there was a tweet from Allen White.&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://twitter.com/SQLRunr/status/1113862196201758720" target="_blank" rel="noopener"
&gt;https://twitter.com/SQLRunr/status/1113862196201758720&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Allen wanted to add his scripts folder to source control but didn&amp;rsquo;t have a how to do it handy. So I thought I would write one. Hopefully this will enable someone new to GitHub and to source control get a folder of scripts under source control&lt;/p&gt;
&lt;h2 id="github-account"&gt;GitHub account
&lt;/h2&gt;&lt;p&gt;If you do not have a GitHub account go to &lt;a class="link" href="https://github.com" target="_blank" rel="noopener"
&gt;https://github.com&lt;/a&gt; and create a new account&lt;/p&gt;</description></item><item><title>How to break a SQL 2019 container on my laptop</title><link>https://blog.robsewell.com/blog/how-to-break-a-sql-2019-container-on-my-laptop/</link><pubDate>Wed, 03 Apr 2019 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/how-to-break-a-sql-2019-container-on-my-laptop/</guid><description>&lt;p&gt;Just a very quick post today. At the weekend I blogged about &lt;a class="link" href="https://sqldbawithabeard.com/2019/03/26/persisting-databases-with-named-volumes-on-windows-with-docker-compose/" target="_blank" rel="noopener"
&gt;creating SQL 2019 containers with named volumes enabling&lt;/a&gt; you to persist your data and yesterday about &lt;a class="link" href="https://sqldbawithabeard.com/2019/04/02/generating-a-workload-against-adventureworks-with-PowerShell/" target="_blank" rel="noopener"
&gt;creating a random workload using PowerShell&lt;/a&gt; and a big T-SQL script.&lt;/p&gt;
&lt;p&gt;The interesting thing about creating workload is that you can break things :-)&lt;/p&gt;
&lt;p&gt;When I created a SQL 2019 container with the data files mapped to a directory on my laptops C Drive with a docker-compose like this&lt;/p&gt;</description></item><item><title>Generating a Workload against AdventureWorks with PowerShell</title><link>https://blog.robsewell.com/blog/generating-a-workload-against-adventureworks-with-powershell/</link><pubDate>Tue, 02 Apr 2019 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/generating-a-workload-against-adventureworks-with-powershell/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2019/04/image-51.png" alt="Featured image of post Generating a Workload against AdventureWorks with PowerShell" /&gt;&lt;p&gt;For a later blog post I have been trying to generate some workload against an AdventureWorks database.&lt;/p&gt;
&lt;p&gt;I found this excellent blog post by Pieter Vanhove &lt;a class="link" href="https://twitter.com/Pieter_Vanhove" target="_blank" rel="noopener"
&gt;t&lt;/a&gt; &lt;a class="link" href="https://blogs.technet.microsoft.com/msftpietervanhove/2016/01/08/generate-workload-on-your-azure-sql-database/?WT.mc_id=DP-MVP-5002693" target="_blank" rel="noopener"
&gt;https://blogs.technet.microsoft.com/msftpietervanhove/2016/01/08/generate-workload-on-your-azure-sql-database/&lt;/a&gt; which references this 2011 post by Jonathan Kehayias &lt;a class="link" href="https://twitter.com/SQLPoolBoy" target="_blank" rel="noopener"
&gt;t&lt;/a&gt;&lt;br&gt;
&lt;a class="link" href="https://www.sqlskills.com/blogs/jonathan/the-adventureworks2008r2-books-online-random-workload-generator/" target="_blank" rel="noopener"
&gt;https://www.sqlskills.com/blogs/jonathan/the-adventureworks2008r2-books-online-random-workload-generator/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Both of these run a random query in a single thread so I thought I would use &lt;a class="link" href="https://www.powershellgallery.com/packages/PoshRSJob/1.7.4.4" target="_blank" rel="noopener"
&gt;PoshRSJob&lt;/a&gt; by Boe Prox &lt;a class="link" href="https://learn-powershell.net/" target="_blank" rel="noopener"
&gt;b&lt;/a&gt; | &lt;a class="link" href="https://twitter.com/proxb" target="_blank" rel="noopener"
&gt;t&lt;/a&gt; to run multiple queries at the same time 🙂&lt;/p&gt;</description></item><item><title>Persisting databases with named volumes on Windows with docker compose</title><link>https://blog.robsewell.com/blog/persisting-databases-with-named-volumes-on-windows-with-docker-compose/</link><pubDate>Tue, 26 Mar 2019 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/persisting-databases-with-named-volumes-on-windows-with-docker-compose/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2019/03/image-27.png" alt="Featured image of post Persisting databases with named volumes on Windows with docker compose" /&gt;&lt;p&gt;With all things containers I refer to my good friend Andrew Pruski. Known as &lt;a class="link" href="https://twitter.com/dbafromthecold" target="_blank" rel="noopener"
&gt;dbafromthecold on twitter&lt;/a&gt; he blogs at &lt;a class="link" href="https://dbafromthecold.com/" target="_blank" rel="noopener"
&gt;https://dbafromthecold.com&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I was reading his latest blog post &lt;a class="link" href="https://dbafromthecold.com/2019/03/21/using-docker-named-volumes-to-persist-databases-in-sql-server" target="_blank" rel="noopener"
&gt;Using docker named volumes to persist databases in SQL Server&lt;/a&gt; and decided to give it a try.&lt;/p&gt;
&lt;p&gt;His instructions worked perfectly and I thought I would try them using a docker-compose file as I like the ease of spinning up containers with them.&lt;/p&gt;</description></item><item><title>Whats a SQL Notebook in Azure Data Studio?</title><link>https://blog.robsewell.com/blog/whats-a-sql-notebook-in-azure-data-studio/</link><pubDate>Wed, 13 Mar 2019 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/whats-a-sql-notebook-in-azure-data-studio/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2019/03/image-7.png" alt="Featured image of post Whats a SQL Notebook in Azure Data Studio?" /&gt;&lt;p&gt;&lt;a class="link" href="https://docs.microsoft.com/en-us/sql/azure-data-studio/download?view=sql-server-2017?WT.mc_id=DP-MVP-5002693" target="_blank" rel="noopener"
&gt;Azure Data Studio&lt;/a&gt; is a cross-platform database tool for data professionals using the Microsoft family of on-premises and cloud data platforms on Windows, MacOS, and Linux.&lt;/p&gt;
&lt;p&gt;Recently Vicky Harp tweeted&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;We&amp;rsquo;re getting very close to release of SQL Notebooks in &lt;a class="link" href="https://twitter.com/AzureDataStudio?ref_src=twsrc%5Etfw" target="_blank" rel="noopener"
&gt;@AzureDataStudio&lt;/a&gt;! You can give the feature an early spin today with the insider build. &lt;a class="link" href="https://t.co/SEZp7ZdxCp" target="_blank" rel="noopener"
&gt;pic.twitter.com/SEZp7ZdxCp&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;— Vicky Harp (@vickyharp) &lt;a class="link" href="https://twitter.com/vickyharp/status/1104127412944551936?ref_src=twsrc%5Etfw" target="_blank" rel="noopener"
&gt;March 8, 2019&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;By the way, you can watch a recording from SQLBits of Vicky’s session&lt;/p&gt;</description></item><item><title>#TSQL2sDay – NomNomNomNomNom</title><link>https://blog.robsewell.com/blog/tsql2sday-nomnomnomnomnom/</link><pubDate>Tue, 12 Mar 2019 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/tsql2sday-nomnomnomnomnom/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2019/03/pille-riin-priske-1238490-unsplash.jpg" alt="Featured image of post #TSQL2sDay – NomNomNomNomNom" /&gt;&lt;p&gt;&lt;a class="link" href="https://nocolumnname.blog/2019/03/05/t-sql-tuesday-112-dipping-into-your-cookie-jar/" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/assets/images/TSQL2sDay150x150.jpg"
loading="lazy"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The topic for this months&lt;a class="link" href="https://nocolumnname.blog/2019/03/05/t-sql-tuesday-112-dipping-into-your-cookie-jar/" target="_blank" rel="noopener"
&gt; T-SQL Tuesday #112&lt;/a&gt; hosted by Shane O’Neill (&lt;a class="link" href="https://nocolumnname.blog/" target="_blank" rel="noopener"
&gt;Blog&lt;/a&gt; / &lt;a class="link" href="https://twitter.com/sozdba" target="_blank" rel="noopener"
&gt;Twitter&lt;/a&gt;) is about “dipping into your cookie jar”. This reference means “when times get tough how do you dip into your reserves to keep going”. Shane asks the following:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;That is what I want from the contributors of this T-SQL Tuesday, those memories that they can think back on for sustenance. Like the humble cookie, I want a humble brag.&lt;/p&gt;</description></item><item><title>#DataInDevon – Getting up to speed with PowerShell or spend a day with one of four other MVPs :-)</title><link>https://blog.robsewell.com/blog/%23dataindevon-getting-up-to-speed-with-powershell-or-spend-a-day-with-one-of-four-other-mvps-/</link><pubDate>Wed, 06 Mar 2019 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/%23dataindevon-getting-up-to-speed-with-powershell-or-spend-a-day-with-one-of-four-other-mvps-/</guid><description>&lt;p&gt;Saturday 27th April is Global Azure Bootcamp day&lt;/p&gt;
&lt;p&gt;What’s Global Azure Bootcamp?&lt;/p&gt;
&lt;p&gt;The &lt;a class="link" href="https://global.azurebootcamp.net/" target="_blank" rel="noopener"
&gt;website&lt;/a&gt; says it best&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;…. communities will come together once again in the sixth great Global Azure Bootcamp event! Each user group will organize their own one day deep dive class on Azure the way they see fit and how it works for their members. The result is that thousands of people get to learn about Azure and join together online under the social hashtag &lt;a class="link" href="https://twitter.com/search?q=%23GlobalAzure" target="_blank" rel="noopener"
&gt;#GlobalAzure&lt;/a&gt;!&lt;/p&gt;</description></item><item><title>Using Docker to run Integration Tests for dbachecks</title><link>https://blog.robsewell.com/blog/using-docker-to-run-integration-tests-for-dbachecks/</link><pubDate>Sat, 19 Jan 2019 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/using-docker-to-run-integration-tests-for-dbachecks/</guid><description>&lt;p&gt;My wonderful friend &lt;a class="link" href="https://twitter.com/AndreKamman" target="_blank" rel="noopener"
&gt;André Kamman&lt;/a&gt; wrote a fantastic blog post this week &lt;a class="link" href="https://andrekamman.com/sql-server-container-instances-via-cloudshell/" target="_blank" rel="noopener"
&gt;SQL Server Container Instances via Cloudshell&lt;/a&gt; about how he uses containers in Azure to test code against different versions of SQL Server.&lt;/p&gt;
&lt;p&gt;It reminded me that I do something very similar to test &lt;a class="link" href="http://dbachecks.io" target="_blank" rel="noopener"
&gt;dbachecks&lt;/a&gt; code changes. I thought this might make a good blog post. I will talk through how I do this locally as I merge a PR from another great friend &lt;a class="link" href="https://github.com/ClaudioESSilva" target="_blank" rel="noopener"
&gt;Cláudio Silva&lt;/a&gt; who has added &lt;a class="link" href="https://github.com/sqlcollaborative/dbachecks/pull/582" target="_blank" rel="noopener"
&gt;agent job history checks.&lt;/a&gt;&lt;/p&gt;</description></item><item><title>Running Windows and Linux SQL Containers together</title><link>https://blog.robsewell.com/blog/running-windows-and-linux-sql-containers-together/</link><pubDate>Mon, 24 Dec 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/running-windows-and-linux-sql-containers-together/</guid><description>&lt;p&gt;Just for fun I decided to spend Christmas Eve getting Windows and Linux SQL containers running together.&lt;/p&gt;
&lt;h2 id="warning"&gt;WARNING
&lt;/h2&gt;&lt;p&gt;This is NOT a production ready solution, in fact I would not even recommend that you try it.&lt;br&gt;
I definitely wouldn’t recommend it on any machine with anything useful on it that you want to use again.&lt;br&gt;
We will be using a re-compiled dockerd.exe created by someone else and you know the rules about downloading things from the internet don’t you? and trusting unknown unverified people?&lt;/p&gt;</description></item><item><title>Getting SQL Services, Starting, Stopping and Restarting them with dbatools</title><link>https://blog.robsewell.com/blog/getting-sql-services-starting-stopping-and-restarting-them-with-dbatools/</link><pubDate>Mon, 03 Dec 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/getting-sql-services-starting-stopping-and-restarting-them-with-dbatools/</guid><description>&lt;p&gt;There was a question in the &lt;a class="link" href="https://sqlcommunity.slack.com/#dbatools" target="_blank" rel="noopener"
&gt;#dbatools slack channel &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/assets/uploads/2018/12/dbatools-question.png" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2018/12/dbatools-question.png"
loading="lazy"
alt="dbatools question"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h3 id="getting-dbatools"&gt;Getting dbatools
&lt;/h3&gt;&lt;p&gt;dbatools enables you to administer SQL Server with PowerShell. To get it simply open PowerShell run&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Install-Module dbatools&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;You can find more details on &lt;a class="link" href="http://dbatools.io/install" target="_blank" rel="noopener"
&gt;the web-site&lt;/a&gt;&lt;/p&gt;
&lt;h3 id="finding-the-command"&gt;Finding the Command
&lt;/h3&gt;&lt;p&gt;To find a command you can use the dbatools command &lt;a class="link" href="https://docs.dbatools.io/#Find-DbaCommand" target="_blank" rel="noopener"
&gt;Find-DbaCommand&lt;/a&gt;
For commands for service run&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Find-DbaCommand Service&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;There are a whole bundle returned&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/assets/uploads/2018/12/find-services.png" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2018/12/find-services.png"
loading="lazy"
alt="find services.png"
&gt;&lt;/a&gt;&lt;/p&gt;</description></item><item><title>SQL Server Availability Group FailoverDetection Utility PowerShell Function Improvements – Named Instances, Archiving Data, Speed</title><link>https://blog.robsewell.com/blog/sql-server-availability-group-failoverdetection-utility-powershell-function-improvements-named-instances-archiving-data-speed/</link><pubDate>Sat, 01 Dec 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/sql-server-availability-group-failoverdetection-utility-powershell-function-improvements-named-instances-archiving-data-speed/</guid><description>&lt;p&gt;In &lt;a class="link" href="https://blog.robsewell.com/gathering-all-the-logs-and-running-the-availability-group-failover-detection-utility-with-powershell/" target="_blank" rel="noopener"
&gt;my last post I wrote about a new function&lt;/a&gt; for gathering the data and running the &lt;a class="link" href="https://blogs.msdn.microsoft.com/sql_server_team/failover-detection-utility-availability-group-failover-analysis-made-easy/" target="_blank" rel="noopener"
&gt;FailoverDetection utility&lt;/a&gt; by the &lt;a class="link" href="https://twitter.com/mssqltiger" target="_blank" rel="noopener"
&gt;Tiger Team&lt;/a&gt; to analyse availability group failovers. I have updated it following some comments and using it for a day.&lt;/p&gt;
&lt;h3 id="dont-forget-the-named-instances-rob"&gt;Don’t forget the named instances Rob!
&lt;/h3&gt;&lt;p&gt;Michael Karpenko wrote a comment pointing out that I had not supported named instances, which was correct as it had not been written for that. Thank you Michael 🙂 I have updated the code to deal with named instances.&lt;/p&gt;</description></item><item><title>Gathering all the Logs and Running the Availability Group Failover Detection Utility with PowerShell</title><link>https://blog.robsewell.com/blog/gathering-all-the-logs-and-running-the-availability-group-failover-detection-utility-with-powershell/</link><pubDate>Wed, 28 Nov 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/gathering-all-the-logs-and-running-the-availability-group-failover-detection-utility-with-powershell/</guid><description>&lt;p&gt;30/11/2018 – Function has been updated to deal with named instances.&lt;/p&gt;
&lt;p&gt;Last week the Tiger Team released their Availability Group Failover Detection Utility which will provide root cause analysis on Cluster Logs, SQL Error Logs, and the Availability groups extended events logs. There is a &lt;a class="link" href="https://blogs.msdn.microsoft.com/sql_server_team/failover-detection-utility-availability-group-failover-analysis-made-easy" target="_blank" rel="noopener"
&gt;blog post here&lt;/a&gt; and the tool can be downloaded from the &lt;a class="link" href="https://github.com/Microsoft/tigertoolbox/tree/master/Always-On/FailoverDetection" target="_blank" rel="noopener"
&gt;Tiger Team GitHub Repository&lt;/a&gt;&lt;/p&gt;
&lt;h3 id="a-bit-of-faffing"&gt;A Bit of Faffing*
&lt;/h3&gt;&lt;p&gt;It states on the &lt;a class="link" href="https://github.com/Microsoft/tigertoolbox/blob/master/README.md" target="_blank" rel="noopener"
&gt;readme&lt;/a&gt; for the Tiger Team GitHub Repository.&lt;/p&gt;</description></item><item><title>Getting the SQL Version from a backup using dbatools ………. on PowerShell Core</title><link>https://blog.robsewell.com/blog/getting-the-sql-version-from-a-backup-using-dbatools-.-on-powershell-core/</link><pubDate>Mon, 26 Nov 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/getting-the-sql-version-from-a-backup-using-dbatools-.-on-powershell-core/</guid><description>&lt;p&gt;Following an upgrade to SQL Server the backup share had a number of backups, some from the old version and some from the newer version. I was asked if I had a script to be able to get the SQL Version from the backup file from all of the files in the backup share.&lt;/p&gt;
&lt;p&gt;With &lt;a class="link" href="http://dbatools,io" target="_blank" rel="noopener"
&gt;dbatools&lt;/a&gt; this was easy to accomplish with &lt;a class="link" href="https://docs.dbatools.io/#Read-DbaBackupHeader" target="_blank" rel="noopener"
&gt;Read-DbaBackuoHeader&lt;/a&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;span class="lnt"&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;$backupshare = &amp;#34;$share\\keep&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;$Instance = &amp;#34;SQL0\\Mirror&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;$information = foreach ($BackupFile in (Get-ChildItem $backupshare)) {
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; $FileName = @{Name = &amp;#39;FileName&amp;#39;; Expression = {$BackupFile.Name}}
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; Read-DbaBackupHeader -SqlInstance $Instance -Path $BackupFile.FullName | Select-Object $FileName, DatabaseName , CompatibilityLevel, SqlVersion
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;$information | Format-Table
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2018/11/read-dbabackupheader.png"
loading="lazy"
alt="read-dbabackupheader.PNG"
&gt;&lt;/p&gt;</description></item><item><title>PASS Summit, SQLTrain and My First US SQL Saturday</title><link>https://blog.robsewell.com/blog/pass-summit-sqltrain-and-my-first-us-sql-saturday/</link><pubDate>Wed, 31 Oct 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/pass-summit-sqltrain-and-my-first-us-sql-saturday/</guid><description>&lt;p&gt;Next week is the week when I used to dread looking at Twitter and especially the &lt;a class="link" href="https://twitter.com/search?q=%23passsummit&amp;amp;src=typd" target="_blank" rel="noopener"
&gt;#PASSsummit&lt;/a&gt; hashtag, watching all of those folk having a great time in great sessions and doing all of the networking. Last year I was lucky enough to attend for the first time and take part in &lt;a class="link" href="https://twitter.com/cl" target="_blank" rel="noopener"
&gt;Chrissy LeMaire&lt;/a&gt; and CKs pre-con, this year I decided to add a US SQL Saturday to the list.&lt;/p&gt;</description></item><item><title>PASS Summit, SQLTrain and My First US SQL Saturday</title><link>https://blog.robsewell.com/blog/pass-summit-sqltrain-and-my-first-us-sql-saturday/</link><pubDate>Wed, 31 Oct 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/pass-summit-sqltrain-and-my-first-us-sql-saturday/</guid><description>&lt;p&gt;Next week is the week when I used to dread looking at Twitter and especially the &lt;a class="link" href="https://twitter.com/search?q=%23passsummit&amp;amp;src=typd" target="_blank" rel="noopener"
&gt;#PASSsummit&lt;/a&gt; hashtag, watching all of those folk having a great time in great sessions and doing all of the networking. Last year I was lucky enough to attend for the first time and take part in &lt;a class="link" href="https://twitter.com/cl" target="_blank" rel="noopener"
&gt;Chrissy LeMaire&lt;/a&gt; and CKs pre-con, this year I decided to add a US SQL Saturday to the list.&lt;/p&gt;</description></item><item><title>Checking Trace Flags with dbachecks, online docs and PSPowerHour</title><link>https://blog.robsewell.com/blog/checking-trace-flags-with-dbachecks-online-docs-and-pspowerhour/</link><pubDate>Sat, 29 Sep 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/checking-trace-flags-with-dbachecks-online-docs-and-pspowerhour/</guid><description>&lt;p&gt;It’s been a few weeks since i have blogged as I have been busy with a lot of other things. One of which is preparing for &lt;a class="link" href="https://www.pass.org/summit/2018/Sessions/Details.aspxsid=80306" target="_blank" rel="noopener"
&gt;my SQL Pass Summit pre-con&lt;/a&gt; which has lead to me improving the CI/CD for &lt;a class="link" href="http://dbachecks.io" target="_blank" rel="noopener"
&gt;dbachecks&lt;/a&gt; by adding auto-creation of online documentation, which you can find at &lt;a class="link" href="https://dbachecks.readthedocs.io" target="_blank" rel="noopener"
&gt;https://dbachecks.readthedocs.io&lt;/a&gt; or by running Get-Help with the -Online switch for any dbachecks command.&lt;/p&gt;
&lt;p&gt;Get-Help Invoke-DbcCheck -Online&lt;/p&gt;
&lt;p&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2018/09/01-online-help.png"
loading="lazy"
alt="01 - online help.png"
&gt;&lt;/p&gt;</description></item><item><title>Deploying To a Power Bi Report Server with PowerShell</title><link>https://blog.robsewell.com/blog/deploying-to-a-power-bi-report-server-with-powershell/</link><pubDate>Tue, 21 Aug 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/deploying-to-a-power-bi-report-server-with-powershell/</guid><description>&lt;p&gt;Just a quick post to share some code that I used to solve a problem I had recently.&lt;/p&gt;
&lt;p&gt;I needed to automate the deployment of some Power Bi reports to a Power Bi Report Server PBRS using TFS. I had some modified &lt;a class="link" href="https://blog.robsewell.com/dbachecks-dark-mode-historical-validation-powerbi/" target="_blank" rel="noopener"
&gt;historical validation dbachecks&lt;/a&gt; pbix files that I wanted to automate the deployment of and enable the client to be able to quickly and simply deploy the reports as needed.&lt;/p&gt;</description></item><item><title>Using the PowerShell AST to find a ForEach Method</title><link>https://blog.robsewell.com/blog/using-the-powershell-ast-to-find-a-foreach-method/</link><pubDate>Thu, 16 Aug 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/using-the-powershell-ast-to-find-a-foreach-method/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2018/08/server.png" alt="Featured image of post Using the PowerShell AST to find a ForEach Method" /&gt;&lt;p&gt;In &lt;a class="link" href="http://dbachecks.io" target="_blank" rel="noopener"
&gt;dbachecks&lt;/a&gt; we enable people to see what checks are available by running Get-DbcCheck. This gives a number of properties including the ‘type’ of check. This refers to the configuration item or parameter that is required to have a value for this check to run.&lt;/p&gt;
&lt;p&gt;For example – Any check to do with SQL Agent is of type Sqlinstance because it requires an instance to be specified but a check for SPN is of type ComputerName because it requires a computer name to run.&lt;/p&gt;</description></item><item><title>Hitting the Wall – #TSQL2sDay</title><link>https://blog.robsewell.com/blog/hitting-the-wall-tsql2sday/</link><pubDate>Tue, 14 Aug 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/hitting-the-wall-tsql2sday/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2018/08/farrel-nobel-97504-unsplash.jpg" alt="Featured image of post Hitting the Wall – #TSQL2sDay" /&gt;&lt;p&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2018/08/farrel-nobel-97504-unsplash.jpg"
loading="lazy"
alt="farrel-nobel-97504-unsplash"
&gt;
Photo by &lt;a class="link" href="https://unsplash.com/photos/G9neENK1Z5I?utm_source=unsplash&amp;amp;utm_medium=referral&amp;amp;utm_content=creditCopyText" target="_blank" rel="noopener"
&gt;Farrel Nobel&lt;/a&gt; on &lt;a class="link" href="https://unsplash.com/search/photos/walk-around-wall?utm_source=unsplash&amp;amp;utm_medium=referral&amp;amp;utm_content=creditCopyText" target="_blank" rel="noopener"
&gt;Unsplash&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Welcome to another edition of T-SQL Tuesday!&lt;/p&gt;
&lt;p&gt;This T-SQL Tuesday is hosted by Wayne Sheffield ( &lt;a class="link" href="https://blog.waynesheffield.com/wayne/" target="_blank" rel="noopener"
&gt;blog&lt;/a&gt; | &lt;a class="link" href="https://twitter.com/DBAWayne" target="_blank" rel="noopener"
&gt;twitter&lt;/a&gt; ) and &lt;a class="link" href="https://blog.waynesheffield.com/wayne/archive/2018/08/t-sql-tuesday-105-invitation-brick-wall/" target="_blank" rel="noopener"
&gt;he has asked us to talk about&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;[…]&lt;/em&gt; a time when you ran up against your own brick wall, and how you worked it out or dealt with it.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="hitting-the-wall"&gt;Hitting The Wall
&lt;/h2&gt;&lt;p&gt;When stuck in a problem in the past, I could often be found glued to a keyboard and screen for many hours. I would try this way and that way, I would Google and read Stack Overflow looking for ways around the particular issue I was seeing trying different things and finally I would get frustrated and fed up and stop.&lt;/p&gt;</description></item><item><title>A PowerShell Conference In A Book</title><link>https://blog.robsewell.com/blog/a-powershell-conference-in-a-book/</link><pubDate>Wed, 01 Aug 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/a-powershell-conference-in-a-book/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2018/08/book.jpeg" alt="Featured image of post A PowerShell Conference In A Book" /&gt;&lt;h2 id="a-question"&gt;A Question
&lt;/h2&gt;&lt;p&gt;Shortly after the &lt;a class="link" href="http://psconf.eu" target="_blank" rel="noopener"
&gt;European PowerShell Conference&lt;/a&gt; and the &lt;a class="link" href="https://powershell.org/summit/" target="_blank" rel="noopener"
&gt;PowerShell and Devops 2018&lt;/a&gt; summit in the USA Mike Robbins &lt;a class="link" href="https://mikefrobbins.com" target="_blank" rel="noopener"
&gt;b&lt;/a&gt; | &lt;a class="link" href="https://twitter.com/mikefrobbins" target="_blank" rel="noopener"
&gt;t&lt;/a&gt; contacted me with a question.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Interested in writing a chapter in a PowerShell book?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I was intrigued and read on.&lt;/p&gt;
&lt;h2 id="a-conference-in-a-book"&gt;A Conference in a Book
&lt;/h2&gt;&lt;p&gt;There was more to this book than just writing about PowerShell though. Mike was suggesting that a group of wonderful PowerShell experts (&lt;a class="link" href="https://twitter.com/mikefrobbins/lists/psh-conference-book/members" target="_blank" rel="noopener"
&gt;Here’s a Twitter list&lt;/a&gt;) got together and created a conference in a book.&lt;/p&gt;</description></item><item><title>A PowerShell Pester Check for parsing SQL scripts</title><link>https://blog.robsewell.com/blog/a-powershell-pester-check-for-parsing-sql-scripts/</link><pubDate>Wed, 25 Jul 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/a-powershell-pester-check-for-parsing-sql-scripts/</guid><description>&lt;p&gt;I like &lt;a class="link" href="https://blog.robsewell.com/?s=pester" target="_blank" rel="noopener"
&gt;to write Pester checks&lt;/a&gt; to make sure that all is as expected! This is just a quick post as much to help me remember this script 🙂&lt;/p&gt;
&lt;p&gt;This is a quick Pester test I wrote to ensure that some SQL Scripts in a directory would parse so there was some guarantee that they were valid T-SQL. It uses the SQLParser.dll and because it was using a build server without SQL Server I have to load the required DLLs from the &lt;a class="link" href="http://dbatools.io" target="_blank" rel="noopener"
&gt;dbatools&lt;/a&gt; module (Thank you dbatools 🙂 )&lt;/p&gt;</description></item><item><title>dbachecks – Dark Mode Historical Validation PowerBi</title><link>https://blog.robsewell.com/blog/dbachecks-dark-mode-historical-validation-powerbi/</link><pubDate>Mon, 28 May 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/dbachecks-dark-mode-historical-validation-powerbi/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2018/05/dark-mode.png" alt="Featured image of post dbachecks – Dark Mode Historical Validation PowerBi" /&gt;&lt;p&gt;in &lt;a class="link" href="https://blog.robsewell.com/dbachecks-save-the-results-to-a-database-for-historical-reporting/" &gt;my last post&lt;/a&gt; I showed how you can save the results of dbachecks to a database and created a PowerBi report. Inspired by Frank Henninger in the #dbachecks slack channel and &lt;a class="link" href="https://twitter.com/wsmelton" target="_blank" rel="noopener"
&gt;Shawn Melton&lt;/a&gt; who explained the difficulties with red/green colour blind I then created this one 🙂&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="assets/uploads/2018/05/dark-mode.png" &gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2018/05/dark-mode.png"
loading="lazy"
alt="dark mode"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;You can find it in my &lt;a class="link" href="https://github.com/SQLDBAWithABeard/dbachecks-expanded" target="_blank" rel="noopener"
&gt;GitHub&lt;/a&gt; and have a play with it below&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;</description></item><item><title>dbachecks – Save the results to a database for historical reporting</title><link>https://blog.robsewell.com/blog/dbachecks-save-the-results-to-a-database-for-historical-reporting/</link><pubDate>Wed, 23 May 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/dbachecks-save-the-results-to-a-database-for-historical-reporting/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2018/05/08-filter-by-instance-and-insance.png" alt="Featured image of post dbachecks – Save the results to a database for historical reporting" /&gt;&lt;p&gt;I gave a presentation at &lt;a class="link" href="https://sqlday.pl/en/" target="_blank" rel="noopener"
&gt;SQL Day&lt;/a&gt; in Poland last week on &lt;a class="link" href="http://dbachecks.io" target="_blank" rel="noopener"
&gt;dbachecks&lt;/a&gt; and one of the questions I got asked was will you write a command to put the results of the checks into a database for historical reporting.&lt;/p&gt;
&lt;p&gt;The answer is no and here is the reasoning. The capability is already there. Most good PowerShell commands will only return an object and the beauty of an object is that you can do anything you like with it. Your only limit is your imagination 🙂 I have written about this before &lt;a class="link" href="https://blog.robsewell.com/taking-dbatools-test-dbalastbackup-a-little-further/" &gt;here. &lt;/a&gt;The other reason is that it would be very difficult to write something that was easily configurable for the different requirements that people will require. But here is one way of doing it.&lt;/p&gt;</description></item><item><title>dbachecks – Improved Descriptions</title><link>https://blog.robsewell.com/blog/dbachecks-improved-descriptions/</link><pubDate>Sat, 19 May 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/dbachecks-improved-descriptions/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2018/05/04-get-dbacheck-ogv.png" alt="Featured image of post dbachecks – Improved Descriptions" /&gt;&lt;p&gt;With the latest release of &lt;a class="link" href="https://www.powershellgallery.com/packages/dbachecks/1.1.128" target="_blank" rel="noopener"
&gt;dbachecks&lt;/a&gt; we have added a new check for testing that foreign keys and constraints are trusted thanks to Cláudio Silva &lt;a class="link" href="https://claudioessilva.eu/" target="_blank" rel="noopener"
&gt;b&lt;/a&gt; | &lt;a class="link" href="https://twitter.com/ClaudioESSilva" target="_blank" rel="noopener"
&gt;t&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;To get the latest release you will need to run&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Update-Module dbachecks
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You should do this regularly as we release &lt;a class="link" href="https://blog.robsewell.com/version-update-code-signing-and-publishing-to-the-powershell-gallery-with-vsts/" &gt;new improvements frequently&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;We have also added better descriptions for the checks which was suggested by the same person who inspired the previous improvement &lt;a class="link" href="https://blog.robsewell.com/dbachecks-which-configuration-item-for-which-check/" &gt;I blogged about here&lt;/a&gt;&lt;/p&gt;</description></item><item><title>dbachecks – Which Configuration Item For Which Check ?</title><link>https://blog.robsewell.com/blog/dbachecks-which-configuration-item-for-which-check/</link><pubDate>Tue, 15 May 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/dbachecks-which-configuration-item-for-which-check/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2018/05/03-New-dbccheck.png" alt="Featured image of post dbachecks – Which Configuration Item For Which Check ?" /&gt;&lt;p&gt;I love showing &lt;a class="link" href="http://dbachecks.io" target="_blank" rel="noopener"
&gt;dbachecks&lt;/a&gt; to people. It’s really cool seeing how people will use it and listening to their experiences. I was showing it to a production DBA a month or so ago and he said&lt;/p&gt;
&lt;h2 id="how-do-i-know-which-checks-there-are"&gt;How Do I Know Which Checks There Are?
&lt;/h2&gt;&lt;p&gt;OK you just need to run&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Get-DbcCheck&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;and it will show you&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="assets/uploads/2018/05/01-get-dbcchecks.png" &gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2018/05/01-get-dbcchecks.png"
loading="lazy"
alt="01 - get-dbcchecks.png"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;It will show you the group, the type (does it need a computer name or an instance name), The description, the unique tag for running just that check and all the tags that will run that check&lt;/p&gt;</description></item><item><title>Creating SQL Server Containers for versions 2012-2017</title><link>https://blog.robsewell.com/blog/creating-sql-server-containers-for-versions-2012-2017/</link><pubDate>Thu, 10 May 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/creating-sql-server-containers-for-versions-2012-2017/</guid><description>&lt;p&gt;I am working on my &lt;a class="link" href="http://dbatools.io" target="_blank" rel="noopener"
&gt;dbatools&lt;/a&gt; and &lt;a class="link" href="http://dbachecks.io" target="_blank" rel="noopener"
&gt;dbachecks&lt;/a&gt; presentations for &lt;a class="link" href="http://www.sqlsaturday.com/735/eventhome.aspx" target="_blank" rel="noopener"
&gt;SQL Saturday Finland&lt;/a&gt;, &lt;a class="link" href="https://sqlday.pl/" target="_blank" rel="noopener"
&gt;SQLDays&lt;/a&gt;, &lt;a class="link" href="http://www.sqlsaturday.com/742/EventHome.aspx" target="_blank" rel="noopener"
&gt;SQL Saturday Cork&lt;/a&gt; and &lt;a class="link" href="https://sqlgrillen.de/" target="_blank" rel="noopener"
&gt;SQLGrillen&lt;/a&gt; I want to show the two modules running against a number of SQL Versions so I have installed&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;2 Domain Controllers&lt;/li&gt;
&lt;li&gt;2 SQL 2017 instances on Windows 2016 with an Availability Group and WideWorldImporters database&lt;/li&gt;
&lt;li&gt;1 Windows 2016 jump box with all the programmes I need&lt;/li&gt;
&lt;li&gt;1 Windows 2016 with containers&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;using a VSTS build and this set of &lt;a class="link" href="https://github.com/SQLDBAWithABeard/ARMTemplates/tree/master/DeployAlwaysOn" target="_blank" rel="noopener"
&gt;ARM templates and scripts&lt;/a&gt;&lt;/p&gt;</description></item><item><title>#tsql2sday – Giving Back – Reprise</title><link>https://blog.robsewell.com/blog/tsql2sday-giving-back-reprise/</link><pubDate>Tue, 08 May 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/tsql2sday-giving-back-reprise/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2017/08/tsql2sday.jpg" alt="Featured image of post #tsql2sday – Giving Back – Reprise" /&gt;&lt;p&gt;&lt;a class="link" href="https://scribnasium.com/2018/05/giving-back-t-sql-tuesday-102-invite/" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2017/08/tsql2sday.jpg"
loading="lazy"
alt="tsql2sday"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;It’s TSQL Tuesday again! This month our host is Riley Major (&lt;a class="link" href="https://scribnasium.com/about-me/" target="_blank" rel="noopener"
&gt;b&lt;/a&gt;/&lt;a class="link" href="https://twitter.com/RileyMajor" target="_blank" rel="noopener"
&gt;t&lt;/a&gt;) and the subject is &lt;em&gt;Giving Back&lt;/em&gt;. He’s given us two options here (as well as the side option of &lt;em&gt;your favorite 2017 improvement&lt;/em&gt;). Pick a way that you’d like to give back to the community and talk about it, or if you already give back,  tell us how and why you started.&lt;/p&gt;
&lt;p&gt;There will be a lot of excellent posts on this subject and one of the things that I like is that you can go to &lt;a class="link" href="http://tsqltuesday.com" target="_blank" rel="noopener"
&gt;http://tsqltuesday.com&lt;/a&gt; and look up all of the entries which means that for a particular topic you can find a bunch of blog posts from different angles (I miss-typed that as angels first and yes they are all angels!) whether it is &lt;a class="link" href="http://tsqltuesday.com/tag/career-improvement/" target="_blank" rel="noopener"
&gt;career improvement&lt;/a&gt; or technical like say &lt;a class="link" href="http://tsqltuesday.com/tag/extended-events/" target="_blank" rel="noopener"
&gt;Extended Events&lt;/a&gt; it is all there waiting for you 🙂&lt;/p&gt;</description></item><item><title>Visual Studio Code Live Sharing Set-Up</title><link>https://blog.robsewell.com/blog/visual-studio-code-live-sharing-set-up/</link><pubDate>Tue, 08 May 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/visual-studio-code-live-sharing-set-up/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2018/05/07-sign-in.png" alt="Featured image of post Visual Studio Code Live Sharing Set-Up" /&gt;&lt;p&gt;There was an &lt;a class="link" href="https://code.visualstudio.com/blogs/2018/05/07/live-share-public-preview" target="_blank" rel="noopener"
&gt;announcement on the Visual Studio Code blog&lt;/a&gt; about the public preview of Live Share. This enables you to easily collaborate on code by securely sharing your coding session.&lt;/p&gt;
&lt;p&gt;It is remarkably easy to set up 🙂&lt;/p&gt;
&lt;h2 id="installation"&gt;Installation
&lt;/h2&gt;&lt;p&gt;Open Visual Studio Code, open the Extensions side bar (CTRL + SHIFT + X)&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="assets/uploads/2018/05/01-open-extensions.png" &gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2018/05/01-open-extensions.png"
loading="lazy"
alt="01 - open extensions"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Search for Live Share&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="assets/uploads/2018/05/02-search.png" &gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2018/05/02-search.png"
loading="lazy"
alt="02 - search.png"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Click Install and then reload when it has done&lt;/p&gt;</description></item><item><title>Version Update, Code Signing and publishing to the PowerShell Gallery with VSTS</title><link>https://blog.robsewell.com/blog/version-update-code-signing-and-publishing-to-the-powershell-gallery-with-vsts/</link><pubDate>Tue, 01 May 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/version-update-code-signing-and-publishing-to-the-powershell-gallery-with-vsts/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2018/05/32-Dashboard.png" alt="Featured image of post Version Update, Code Signing and publishing to the PowerShell Gallery with VSTS" /&gt;&lt;p&gt;At the fabulous &lt;a class="link" href="http://psconf.eu" target="_blank" rel="noopener"
&gt;PowerShell Conference EU&lt;/a&gt; I presented about Continuous Delivery to the PowerShell Gallery with VSTS and explained how we use VSTS to enable CD for &lt;a class="link" href="http://dbachecks.io" target="_blank" rel="noopener"
&gt;dbachecks&lt;/a&gt;. We even released a new version during the session 🙂&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;So how do we achieve this?&lt;/p&gt;
&lt;p&gt;We have a few steps&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Create a project and link to our GitHub&lt;/li&gt;
&lt;li&gt;Run unit uests with Pester to make sure that our code is doing what we expect.&lt;/li&gt;
&lt;li&gt;Update our module version and commit the change to GitHub&lt;/li&gt;
&lt;li&gt;Sign our code with a code signing certificate&lt;/li&gt;
&lt;li&gt;Publish to the PowerShell Gallery&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="create-project-and-link-to-github"&gt;Create Project and link to GitHub
&lt;/h2&gt;&lt;p&gt;First you need to create a VSTS project by going to &lt;a class="link" href="https://www.visualstudio.com/" target="_blank" rel="noopener"
&gt;https://www.visualstudio.com/&lt;/a&gt; This is free for up to 5 users with 1 concurrent CI/CD queue limited to a maximum of 60 minutes run time which should be more than enough for your PowerShell module.&lt;/p&gt;</description></item><item><title>Professional and Proficient PowerShell: From Writing Scripts to Developing Solutions at PASS Summit</title><link>https://blog.robsewell.com/blog/professional-and-proficient-powershell-from-writing-scripts-to-developing-solutions-at-pass-summit/</link><pubDate>Wed, 11 Apr 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/professional-and-proficient-powershell-from-writing-scripts-to-developing-solutions-at-pass-summit/</guid><description>&lt;p&gt;&lt;a class="link" href="http://www.pass.org/summit/2018/" target="_blank" rel="noopener"
&gt;PASS Summit&lt;/a&gt; is the largest conference for technical professionals who leverage the Microsoft Data Platform. PASS Summit 2018 is happening November 5th – 9th 2018 in Seattle. It is an amazing conference. I attended last year and thoroughly enjoyed every minute. It is a whole week of opportunities to learn from and network with people from all over the world involved in Data Platform.&lt;/p&gt;
&lt;p&gt;The pre-cons have just been announced so go and take a look at the &lt;a class="link" href="http://www.pass.org/summit/2018/Learn/Pre-ConferenceSessions.aspx" target="_blank" rel="noopener"
&gt;Pre-Con Page&lt;/a&gt; to see the wonderful full day learning opportunities you can get this year.&lt;/p&gt;</description></item><item><title>Checking Availability Groups with dbachecks</title><link>https://blog.robsewell.com/blog/checking-availability-groups-with-dbachecks/</link><pubDate>Sun, 08 Apr 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/checking-availability-groups-with-dbachecks/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2018/04/VSTS-results.png" alt="Featured image of post Checking Availability Groups with dbachecks" /&gt;&lt;p&gt;It’s been 45 days since we released dbachecks&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;Since then there have been 25 releases to the PowerShell Gallery!! Today release 1.1.119 was released 🙂 There have been over 2000 downloads of the module already.&lt;/p&gt;
&lt;p&gt;In the beginning we had 80 checks and 108 configuration items, today we have 84 checks and 125 configuration items!&lt;/p&gt;
&lt;p&gt;If you have already installed dbachecks it is important to make sure that you update regularly. You can do this by running&lt;/p&gt;</description></item><item><title>Easily Splatting PowerShell with VS Code</title><link>https://blog.robsewell.com/blog/easily-splatting-powershell-with-vs-code/</link><pubDate>Sun, 11 Mar 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/easily-splatting-powershell-with-vs-code/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2022/dbachecks.jpg" alt="Featured image of post Easily Splatting PowerShell with VS Code" /&gt;&lt;p&gt;So I always like to show splatting PowerShell commands when I am presenting sessions or workshops and realised that I had not really blogged about it. (This blog is for &lt;a class="link" href="https://twitter.com/dbafromthecold" target="_blank" rel="noopener"
&gt;@dbafromthecold&lt;/a&gt; who asked me to 🙂 )&lt;/p&gt;
&lt;h2 id="what-is-splatting"&gt;What is Splatting?
&lt;/h2&gt;&lt;p&gt;Well you will know that when you call a PowerShell function you can use intellisense to get the parameters and sometimes the parameter values as well. This can leave you with a command that looks like this on the screen&lt;/p&gt;</description></item><item><title>Announcing dbachecks – Configurable PowerShell Validation For Your SQL Instances</title><link>https://blog.robsewell.com/blog/announcing-dbachecks-configurable-powershell-validation-for-your-sql-instances/</link><pubDate>Thu, 22 Feb 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/announcing-dbachecks-configurable-powershell-validation-for-your-sql-instances/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2018/02/09-PowerBi.png" alt="Featured image of post Announcing dbachecks – Configurable PowerShell Validation For Your SQL Instances" /&gt;&lt;p&gt;For the last couple of months members of the &lt;a class="link" href="http://dbatools.io" target="_blank" rel="noopener"
&gt;dbatools&lt;/a&gt; team have been working on a new PowerShell module called &lt;a class="link" href="http://dbachecks.io" target="_blank" rel="noopener"
&gt;dbachecks&lt;/a&gt;. This open source PowerShell module will enable you to validate your SQL Instances. Today it is released for you all to start to use 🙂&lt;/p&gt;
&lt;h2 id="validate-your-sql-instances"&gt;Validate Your SQL Instances?
&lt;/h2&gt;&lt;p&gt;What do I mean by validate your SQL Instances? You want to know if your SQL Instances are (still) set up in the way that you want them to be or that you have not missed any configurations when setting them up. With dbachecks you can use any or all of the 80 checks to ensure one or many SQL Instances are as you want them to be. Using Pester, dbachecks will validate your SQL Instance(s) against default settings or ones that you configure yourself.&lt;/p&gt;</description></item><item><title>dbachecks – Configuration Deep Dive</title><link>https://blog.robsewell.com/blog/dbachecks-configuration-deep-dive/</link><pubDate>Thu, 22 Feb 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/dbachecks-configuration-deep-dive/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2018/02/03-autocomplete.png" alt="Featured image of post dbachecks – Configuration Deep Dive" /&gt;&lt;p&gt;Today is the day that &lt;a class="link" href="https://blog.robsewell.com/?p=8997" &gt;we have announced dbachecks&lt;/a&gt;  a PowerShell module enabling you to validate your SQL Instances. You can read more about it &lt;a class="link" href="https://blog.robsewell.com/?p=8997" &gt;here where you can learn how to install it and see some simple use cases&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="108-configurations"&gt;108 Configurations
&lt;/h2&gt;&lt;p&gt;One of the things I have been talking about &lt;a class="link" href="https://blog.robsewell.com/write-your-first-pester-test-today/" &gt;in my presentation “Green is Good Red is Bad”&lt;/a&gt; is configuring Pester checks so that you do not have to keep writing new tests for the same thing but with different values.&lt;/p&gt;</description></item><item><title>VS Code – Terminal crashes when formatting script</title><link>https://blog.robsewell.com/blog/vs-code-terminal-crashes-when-formatting-script/</link><pubDate>Sat, 10 Feb 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/vs-code-terminal-crashes-when-formatting-script/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2018/02/formatting.gif" alt="Featured image of post VS Code – Terminal crashes when formatting script" /&gt;&lt;p&gt;I love VS Code. I love being able to press ALT + SHIFT + F and format my code.&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/assets/uploads/2018/02/formatting.gif" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2018/02/formatting.gif"
loading="lazy"
alt="formatting.gif"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="the-problem"&gt;The Problem
&lt;/h2&gt;&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/assets/uploads/2018/02/format-error.png" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2018/02/format-error.png"
loading="lazy"
alt="format error.png"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I could reproduce it will. This was very frustrating.&lt;/p&gt;
&lt;h2 id="turning-on-verbose-logging"&gt;Turning on Verbose Logging
&lt;/h2&gt;&lt;p&gt;To turn on verbose logging for the PowerShell Editor Services go the Cog in the bottom left, click it and then click User Settings.&lt;/p&gt;
&lt;p&gt;Search for powershell.developer.editorServicesLogLevel&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/assets/uploads/2018/02/powershell.developer.editorServicesLogLevel.png" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2018/02/powershell.developer.editorServicesLogLevel.png"
loading="lazy"
alt="powershell.developer.editorServicesLogLevel.png"
&gt;&lt;/a&gt;&lt;/p&gt;</description></item><item><title>How I created PowerShell.cool using Flow, Azure SQL DB, Cognitive Services &amp; PowerBi</title><link>https://blog.robsewell.com/blog/how-i-created-powershell.cool-using-flow-azure-sql-db-cognitive-services-powerbi/</link><pubDate>Sat, 03 Feb 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/how-i-created-powershell.cool-using-flow-azure-sql-db-cognitive-services-powerbi/</guid><description>&lt;p&gt;Last weekend I was thinking about how to save the tweets for PowerShell Conference Europe. This annual event occurs in Hanover and this year it is on April 17-20, 2018. The agenda has just been released and you can find it on the website &lt;a class="link" href="http://www.psconf.eu/" target="_blank" rel="noopener"
&gt;http://www.psconf.eu/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I ended up creating an interactive PowerBi report to which my good friend and Data Platform MVP Paul Andrew &lt;a class="link" href="https://mrpaulandrew.com/" target="_blank" rel="noopener"
&gt;b&lt;/a&gt; | &lt;a class="link" href="https://twitter.com/mrpaulandrew" target="_blank" rel="noopener"
&gt;t&lt;/a&gt; added a bit of magic and I published it. The magnificent Tobias Weltner &lt;a class="link" href="http://www.powertheshell.com/" target="_blank" rel="noopener"
&gt;b&lt;/a&gt; | &lt;a class="link" href="https://twitter.com/TobiasPSP" target="_blank" rel="noopener"
&gt;t&lt;/a&gt; who organises PSConfEU pointed the domain name &lt;a class="link" href="http://powershell.cool" target="_blank" rel="noopener"
&gt;http://powershell.cool&lt;/a&gt; at the link. It looks like this.&lt;/p&gt;</description></item><item><title>How to write a PowerShell function to use Confirm, Verbose and WhatIf</title><link>https://blog.robsewell.com/blog/how-to-write-a-powershell-function-to-use-confirm-verbose-and-whatif/</link><pubDate>Thu, 25 Jan 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/how-to-write-a-powershell-function-to-use-confirm-verbose-and-whatif/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2018/01/03-confirm.png" alt="Featured image of post How to write a PowerShell function to use Confirm, Verbose and WhatIf" /&gt;&lt;p&gt;In &lt;a class="link" href="https://blog.robsewell.com/how-to-run-a-powershell-script-file-with-verbose-confirm-or-whatif/" target="_blank" rel="noopener"
&gt;my last blog post&lt;/a&gt; I showed how to run a script with the WhatIf parameter. This assumes that the commands within the script have been written to use the common parameters Confirm, Verbose and WhatIf.&lt;/p&gt;
&lt;p&gt;Someone asked me how to make sure that any functions that they write will be able to do this.&lt;/p&gt;
&lt;p&gt;it is very easy&lt;/p&gt;
&lt;p&gt;When we define our function we are going to add &lt;code&gt;[cmdletbinding(SupportsShouldProcess)]&lt;/code&gt; at the top&lt;/p&gt;</description></item><item><title>How to run a PowerShell script file with Verbose, Confirm or WhatIf</title><link>https://blog.robsewell.com/blog/how-to-run-a-powershell-script-file-with-verbose-confirm-or-whatif/</link><pubDate>Tue, 23 Jan 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/how-to-run-a-powershell-script-file-with-verbose-confirm-or-whatif/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2018/01/02-Showing-the-results.png" alt="Featured image of post How to run a PowerShell script file with Verbose, Confirm or WhatIf" /&gt;&lt;p&gt;Before you run a PowerShell command that makes a change to something you should check that it is going to do what you expect. You can do this by using the WhatIf parameter for commands that support it. For example, if you wanted to create a New SQL Agent Job Category you would use the &lt;a class="link" href="http://dbatools.io" target="_blank" rel="noopener"
&gt;awesome dbatools module&lt;/a&gt; and write some code like this&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;New-DbaAgentJobCategory -SqlInstance ROB-XPS -Category 'Backup'
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;before you run it, you can check what it is going to do using&lt;/p&gt;</description></item><item><title>Pester 4.2.0 has a Because…… because :-)</title><link>https://blog.robsewell.com/blog/pester-4.2.0-has-a-because-because-/</link><pubDate>Thu, 18 Jan 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/pester-4.2.0-has-a-because-because-/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2018/01/01-Because-1.png" alt="Featured image of post Pester 4.2.0 has a Because…… because :-)" /&gt;&lt;p&gt;I was going through my demo for the &lt;a class="link" href="http://meetu.ps/e/DdYV6/gHMdv/g" target="_blank" rel="noopener"
&gt;South Coast User Group meeting&lt;/a&gt; tonight and decided to add some details about the Because parameter available in the Pester pre-release version 4.2.0.&lt;/p&gt;
&lt;p&gt;To install a pre-release version you need to get the latest  &lt;a class="link" href="https://go.microsoft.com/fwlink/?linkid=846259" target="_blank" rel="noopener"
&gt;PowerShellGet&lt;/a&gt; module. This is pre-installed with PowerShell v6 but for earlier versions open PowerShell as administrator and run&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Install-Module PowerShellGet
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You can try out the Pester pre-release version (once you have the latest PowerShellGet) by installing it from the &lt;a class="link" href="http://powershellgallery.com" target="_blank" rel="noopener"
&gt;PowerShell Gallery&lt;/a&gt; with&lt;/p&gt;</description></item><item><title>Using the AST in Pester for dbachecks</title><link>https://blog.robsewell.com/blog/using-the-ast-in-pester-for-dbachecks/</link><pubDate>Mon, 15 Jan 2018 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/using-the-ast-in-pester-for-dbachecks/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2018/01/02-Pester-results-1.png" alt="Featured image of post Using the AST in Pester for dbachecks" /&gt;&lt;p&gt;TagLine – My goal – Chrissy will appreciate Unit Tests one day 🙂&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://dbatools.io/new-module-coming-soon/" target="_blank" rel="noopener"
&gt;Chrissy has written about dbachecks&lt;/a&gt; the new up and coming community driven open source PowerShell module for SQL DBAs to validate their SQL Server estate. we have taken some of the ideas that we have presented about a way of using &lt;a class="link" href="http://dbatools.io" target="_blank" rel="noopener"
&gt;dbatools&lt;/a&gt; with &lt;a class="link" href="https://github.com/Pester/Pester" target="_blank" rel="noopener"
&gt;Pester&lt;/a&gt; to validate that everything is how it should be and placed them into a meta data driven framework to make things easy for anyone to use. It is looking really good and I am really excited about it. It will be released very soon.&lt;/p&gt;</description></item><item><title>Converting a Datarow to a JSON object with PowerShell</title><link>https://blog.robsewell.com/blog/converting-a-datarow-to-a-json-object-with-powershell/</link><pubDate>Mon, 18 Dec 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/converting-a-datarow-to-a-json-object-with-powershell/</guid><description>&lt;p&gt;This is just a quick post. As is frequent with these they are as much for me to refer to in the future and also because the very act of writing it down will aid me in remembering. I encourage you to do the same. Share what you learn because it will help you as well as helping others.&lt;/p&gt;
&lt;p&gt;Anyway, I was writing some Pester tests for a module that I was writing when I needed some sample data. I have &lt;a class="link" href="https://blog.robsewell.com/writing-dynamic-and-random-tests-cases-for-pester/" target="_blank" rel="noopener"
&gt;written before about using Json for this purpose&lt;/a&gt; This function required some data from a database so I wrote the query to get the data and used &lt;a class="link" href="https://dbatools.io" target="_blank" rel="noopener"
&gt;dbatools&lt;/a&gt; to run the query against the database using &lt;a class="link" href="https://dbatools.io/functions/Get-DbaDatabase" target="_blank" rel="noopener"
&gt;Get-DbaDatabase&lt;/a&gt;&lt;/p&gt;</description></item><item><title>Handling Missing Instances when Looping with Pester</title><link>https://blog.robsewell.com/blog/handling-missing-instances-when-looping-with-pester/</link><pubDate>Thu, 30 Nov 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/handling-missing-instances-when-looping-with-pester/</guid><description>&lt;p&gt;In my previous posts about &lt;a class="link" href="https://blog.robsewell.com/write-your-first-pester-test-today/" target="_blank" rel="noopener"
&gt;writing your first Pester Test&lt;/a&gt; and &lt;a class="link" href="https://blog.robsewell.com/2-ways-to-loop-through-collections-in-pester/" target="_blank" rel="noopener"
&gt;looping through instances&lt;/a&gt; I described how you can start to validate that your SQL Server is how YOU want it to be.&lt;/p&gt;
&lt;h2 id="unavailable-machines"&gt;Unavailable machines
&lt;/h2&gt;&lt;p&gt;Once you begin to have a number of tests for a number of instances you want to be able to handle any machines that are not available cleanly otherwise you might end up with something like this.&lt;/p&gt;</description></item><item><title>2 Ways to Loop through collections in Pester</title><link>https://blog.robsewell.com/blog/2-ways-to-loop-through-collections-in-pester/</link><pubDate>Tue, 28 Nov 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/2-ways-to-loop-through-collections-in-pester/</guid><description>&lt;p&gt;In my last post I showed you &lt;a class="link" href="https://blog.robsewell.com/write-your-first-pester-test-today/" target="_blank" rel="noopener"
&gt;how to write your first Pester test&lt;/a&gt; to validate something. Here’s a recap&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Decide the information you wish to test&lt;/li&gt;
&lt;li&gt;Understand how to get it with PowerShell&lt;/li&gt;
&lt;li&gt;Understand what makes it pass and what makes it fail&lt;/li&gt;
&lt;li&gt;Write a Pester Test&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;You probably have more than one instance that you want to test, so how do you loop through a collection of instances? There are a couple of ways.&lt;/p&gt;</description></item><item><title>2 Ways to Loop through collections in Pester</title><link>https://blog.robsewell.com/blog/2-ways-to-loop-through-collections-in-pester/</link><pubDate>Tue, 28 Nov 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/2-ways-to-loop-through-collections-in-pester/</guid><description>&lt;p&gt;In my last post I showed you &lt;a class="link" href="https://blog.robsewell.com/write-your-first-pester-test-today/" target="_blank" rel="noopener"
&gt;how to write your first Pester test&lt;/a&gt; to validate something. Here’s a recap&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Decide the information you wish to test&lt;/li&gt;
&lt;li&gt;Understand how to get it with PowerShell&lt;/li&gt;
&lt;li&gt;Understand what makes it pass and what makes it fail&lt;/li&gt;
&lt;li&gt;Write a Pester Test&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;You probably have more than one instance that you want to test, so how do you loop through a collection of instances? There are a couple of ways.&lt;/p&gt;</description></item><item><title>Write Your first Pester Test Today</title><link>https://blog.robsewell.com/blog/write-your-first-pester-test-today/</link><pubDate>Thu, 16 Nov 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/write-your-first-pester-test-today/</guid><description>&lt;p&gt;I was in Glasgow this Friday enjoying the fantastic hospitality of the &lt;a class="link" href="http://sqlglasgow.co.uk" target="_blank" rel="noopener"
&gt;Glasgow SQL User Group&lt;/a&gt; &lt;a class="link" href="https://twitter.com/SqlGlasgow" target="_blank" rel="noopener"
&gt;@SQLGlasgow&lt;/a&gt; and presenting sessions with &lt;a class="link" href="https://twitter.com/AndreKamman" target="_blank" rel="noopener"
&gt;Andre Kamman&lt;/a&gt;, &lt;a class="link" href="https://twitter.com/sql_williamd" target="_blank" rel="noopener"
&gt;William Durkin&lt;/a&gt;, and &lt;a class="link" href="https://twitter.com/cl" target="_blank" rel="noopener"
&gt;Chrissy LeMaire&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I presented “Green is Good Red is Bad – Turning your checklists into Pester Tests”. I had to make sure I had enough energy beforehand so I treated myself to a fabulous burger.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2017/11/20171110_114933-compressor.jpg?resize=630%2C354&amp;amp;ssl=1"
loading="lazy"
alt="20171110_114933-compressor.jpg"
&gt;&lt;/p&gt;
&lt;p&gt;Afterwards I was talking to some of the attendees and realised that maybe I could show how easy it was to start writing your first Pester test. Here are the steps to follow so that you can write your first Pester test:&lt;/p&gt;</description></item><item><title>TSQL2sDay – Folks Who Have Made a Difference</title><link>https://blog.robsewell.com/blog/tsql2sday-folks-who-have-made-a-difference/</link><pubDate>Tue, 14 Nov 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/tsql2sday-folks-who-have-made-a-difference/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>Comparing Agent Jobs across Availability Group Replicas with PowerShell</title><link>https://blog.robsewell.com/blog/comparing-agent-jobs-across-availability-group-replicas-with-powershell/</link><pubDate>Fri, 10 Nov 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/comparing-agent-jobs-across-availability-group-replicas-with-powershell/</guid><description>&lt;p&gt;On the plane home from PASS Summit I was sat next to someone who had also attended and when he saw on my laptop that I was part of the SQL Community we struck up a conversation. He asked me how he could compare SQL Agent Jobs across availability group replicas to ensure that they were the same.&lt;/p&gt;
&lt;p&gt;He already knew that he could use &lt;a class="link" href="https://dbatools.io/functions/copy-dbaagentjob/" target="_blank" rel="noopener"
&gt;Copy-DbaAgentJob&lt;/a&gt; from &lt;a class="link" href="http://dbatools.io" target="_blank" rel="noopener"
&gt;dbatools&lt;/a&gt; to copy the jobs between replicas and we discussed how to set up an Agent job to accomplish this. The best way to run an Agent Job with a PowerShell script &lt;a class="link" href="https://dbatools.io/agent/" target="_blank" rel="noopener"
&gt;is described here&lt;/a&gt;&lt;/p&gt;</description></item><item><title>Using Plaster To Create a New PowerShell Module</title><link>https://blog.robsewell.com/blog/using-plaster-to-create-a-new-powershell-module/</link><pubDate>Thu, 09 Nov 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/using-plaster-to-create-a-new-powershell-module/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>dbatools with SQL on Docker and running SQL queries</title><link>https://blog.robsewell.com/blog/dbatools-with-sql-on-docker-and-running-sql-queries/</link><pubDate>Tue, 07 Nov 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/dbatools-with-sql-on-docker-and-running-sql-queries/</guid><description>&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;$srv.Query($Query)&lt;/p&gt;
&lt;p&gt;$srv.Query($Query).column1&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;</description></item><item><title>A Pretty PowerBi Pester Results Template File</title><link>https://blog.robsewell.com/blog/power-bi/powershell/a-pretty-powerbi-pester-results-template-file/</link><pubDate>Sun, 29 Oct 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/power-bi/powershell/a-pretty-powerbi-pester-results-template-file/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>#TSQL2sDay – Get-PostRoundup</title><link>https://blog.robsewell.com/blog/tsql2sday-get-postroundup/</link><pubDate>Wed, 20 Sep 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/tsql2sday-get-postroundup/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>#TSQL2sDay – Starting Out with PowerShell</title><link>https://blog.robsewell.com/blog/tsql2sday-starting-out-with-powershell/</link><pubDate>Tue, 12 Sep 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/tsql2sday-starting-out-with-powershell/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>Automatically updating the version number in a PowerShell Module – How I do regex</title><link>https://blog.robsewell.com/blog/automatically-updating-the-version-number-in-a-powershell-module-how-i-do-regex/</link><pubDate>Sat, 09 Sep 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/automatically-updating-the-version-number-in-a-powershell-module-how-i-do-regex/</guid><description>&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;[version]$Version = [regex]::matches($file, &amp;ldquo;\s&lt;em&gt;ModuleVersion\s=\s&amp;rsquo;(\d&lt;/em&gt;.\d*.\d*)&amp;rsquo;\s*&amp;rdquo;).groups[1].value&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;h1 id="use-regex-to-get-the-version-number-and-set-it-as-a-version-datatype"&gt;Use RegEx to get the Version Number and set it as a version datatype
&lt;/h1&gt;&lt;h1 id="s---between-0-and-many-whitespace"&gt;\s* - between 0 and many whitespace
&lt;/h1&gt;&lt;h1 id="moduleversion---literal"&gt;ModuleVersion - literal
&lt;/h1&gt;&lt;h1 id="s---1-whitespace"&gt;\s - 1 whitespace
&lt;/h1&gt;&lt;h1 id="---literal"&gt;= - literal
&lt;/h1&gt;&lt;h1 id="s---1-whitespace-1"&gt;\s - 1 whitespace
&lt;/h1&gt;&lt;h1 id="---literal-1"&gt;&amp;rsquo; - literal
&lt;/h1&gt;&lt;h1 id="---capture-group"&gt;() - capture Group
&lt;/h1&gt;&lt;h1 id="d---between-0-and-many-digits"&gt;\d* - between 0 and many digits
&lt;/h1&gt;&lt;h1 id="---literal-2"&gt;&amp;rsquo; - literal
&lt;/h1&gt;&lt;h1 id="s-between-0-and-many-whitespace"&gt;\s* between 0 and many whitespace
&lt;/h1&gt;&lt;p&gt;[version]$Version = [regex]::matches($file, &amp;ldquo;\s&lt;em&gt;ModuleVersion\s=\s&amp;rsquo;(\d&lt;/em&gt;.\d*.\d*)&amp;rsquo;\s*&amp;rdquo;).groups[1].value
Write-Output &amp;ldquo;Old Version - $Version&amp;rdquo;&lt;/p&gt;</description></item><item><title>#TSQL2sday #94 Lets get all Posh!</title><link>https://blog.robsewell.com/blog/tsql2sday-94-lets-get-all-posh/</link><pubDate>Tue, 05 Sep 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/tsql2sday-94-lets-get-all-posh/</guid><description>&lt;p&gt;Write-Output &amp;ldquo;What are you going to automate today?&amp;rdquo;&lt;/p&gt;
&lt;p&gt; &lt;/p&gt;
&lt;p&gt;Welcome to T-SQL Tuesday for September 2017!&lt;/p&gt;
&lt;p&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2017/08/tsql2sday.jpg"
loading="lazy"
alt="tsql2sday"
&gt;
&lt;a class="link" href="http://tsqltuesday.com/" target="_blank" rel="noopener"
&gt;T-SQL Tuesday&lt;/a&gt; is a chance for you to join in the SQL Server community and write a blog post on a suggested topic. It makes for a great way to find a bunch of blog posts showing the same subject from many different viewpoints. Please join in and write a blog post, maybe it&amp;rsquo;s your first ever, maybe you haven&amp;rsquo;t blogged for a while but even if you blog every day come and join the party and share your knowledge.&lt;/p&gt;</description></item><item><title>PSDay.UK Tickets are on sale</title><link>https://blog.robsewell.com/blog/psday.uk-tickets-are-on-sale/</link><pubDate>Sun, 13 Aug 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/psday.uk-tickets-are-on-sale/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>Using PowerShell to check if your password has been in a breach</title><link>https://blog.robsewell.com/blog/using-powershell-to-check-if-your-password-has-been-in-a-breach/</link><pubDate>Wed, 09 Aug 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/using-powershell-to-check-if-your-password-has-been-in-a-breach/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>I Hate Interviews – TSQL2sDay</title><link>https://blog.robsewell.com/blog/i-hate-interviews-tsql2sday/</link><pubDate>Tue, 08 Aug 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/i-hate-interviews-tsql2sday/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2017/08/tsql2sday.jpg" alt="Featured image of post I Hate Interviews – TSQL2sDay" /&gt;&lt;p&gt;&lt;a class="link" href="https://littlekendra.com/2017/08/01/tsql-tuesday-93-interviewing-patterns-anti-patterns/" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2017/08/tsql2sday.jpg"
loading="lazy"
alt="tsql2sday"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;This month’s &lt;a class="link" href="http://tsqltuesday.com/" target="_blank" rel="noopener"
&gt;T-SQL Tuesday&lt;/a&gt; is hosted by &lt;a class="link" href="https://littlekendra.com/2017/08/01/tsql-tuesday-93-interviewing-patterns-anti-patterns/" target="_blank" rel="noopener"
&gt;Kendra Little and is on the topic of interviews &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I hate interviews as an interviewee. I have had many memorable experiences with them. Even writing this blog post has been challenging as I relive some of them. I haven’t shared a lot of the worst ones!&lt;/p&gt;
&lt;h2 id="when-i-was-a-lad"&gt;When I was a lad
&lt;/h2&gt;&lt;p&gt;My first interview was for a waiter/washer up at a local country pub aged 15 or so. I stumbled and stammered and stuttered my way through and I think it was only because they needed someone that evening that I got the job.&lt;/p&gt;</description></item><item><title>Presentation Nerves</title><link>https://blog.robsewell.com/blog/presentation-nerves/</link><pubDate>Tue, 08 Aug 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/presentation-nerves/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>Announcing PSDay.UK – Whats a PSDay?</title><link>https://blog.robsewell.com/blog/announcing-psday.uk-whats-a-psday/</link><pubDate>Mon, 24 Jul 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/announcing-psday.uk-whats-a-psday/</guid><description>&lt;p&gt;On Thursday evening I attended the joint London WinOps and PowerShell User Group. It was an excellent evening with two great sessions by Jaap Brasser and Filip Verloy.&lt;/p&gt;
&lt;h2 id="psdayuk"&gt;PSDay.UK
&lt;/h2&gt;&lt;p&gt;There was also an exciting announcement about PSDay.UK  &lt;a class="link" href="https://psday.uk" target="_blank" rel="noopener"
&gt;https://psday.uk&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Look look&lt;br&gt;
A whole day of PowerShell&lt;br&gt;
In London&lt;br&gt;
Just after &lt;a class="link" href="https://twitter.com/WinOpsLDN" target="_blank" rel="noopener"
&gt;@WinOpsLDN&lt;/a&gt;&lt;br&gt;
It&amp;rsquo;s going to be awesome&lt;a class="link" href="https://t.co/CAQqoc2cgX" target="_blank" rel="noopener"
&gt;https://t.co/CAQqoc2cgX&lt;/a&gt;&lt;br&gt;
Follow &lt;a class="link" href="https://twitter.com/psdayuk" target="_blank" rel="noopener"
&gt;@psdayuk&lt;/a&gt; &lt;a class="link" href="https://t.co/3RFHpXpRI1" target="_blank" rel="noopener"
&gt;pic.twitter.com/3RFHpXpRI1&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;— Rob Sewell (@sqldbawithbeard) &lt;a class="link" href="https://twitter.com/sqldbawithbeard/status/888111785022169088" target="_blank" rel="noopener"
&gt;July 20, 2017&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;PSDay.UK is a one day PowerShell event providing the opportunity for you to spend a whole day learning PowerShell from renowned experts from the UK and international speaking community. It will be held at&lt;/p&gt;</description></item><item><title>Writing Dynamic and Random Tests Cases for Pester</title><link>https://blog.robsewell.com/blog/writing-dynamic-and-random-tests-cases-for-pester/</link><pubDate>Thu, 06 Jul 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/writing-dynamic-and-random-tests-cases-for-pester/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>Using Get-SQLDiagFix to get information from the SQL Server Diagnostic API with PowerShell</title><link>https://blog.robsewell.com/blog/using-get-sqldiagfix-to-get-information-from-the-sql-server-diagnostic-api-with-powershell/</link><pubDate>Tue, 04 Jul 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/using-get-sqldiagfix-to-get-information-from-the-sql-server-diagnostic-api-with-powershell/</guid><description>&lt;p&gt;The SQL Server Diagnostics Preview was &lt;a class="link" href="https://blogs.msdn.microsoft.com/sql_server_team/sql-server-diagnostics-preview/" target="_blank" rel="noopener"
&gt;announced just over a week ago&lt;/a&gt; It includes an add-on for SQL Server Management Studio to enable you to analyse SQL Server memory dumps and view information on the latest SQL Server cumulative updates for supported versions of SQL Server. &lt;a class="link" href="https://twitter.com/blobeater1" target="_blank" rel="noopener"
&gt;Arun Sirpal&lt;/a&gt; has written a &lt;a class="link" href="https://blobeater.blog/2017/06/27/using-sql-server-diagnostics-preview/" target="_blank" rel="noopener"
&gt;good blog post showing how to install it and use it in SSMS to analyse dumps&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;There is also a &lt;a class="link" href="https://ecsapi.portal.azure-api.net/" target="_blank" rel="noopener"
&gt;developer API available&lt;/a&gt; so I thought I would write some PowerShell to consume it as there are no PowerShell code examples available in the documentation!&lt;/p&gt;</description></item><item><title>Creating a PowerShell Module and TDD for Get-SQLDiagRecommendations</title><link>https://blog.robsewell.com/blog/creating-a-powershell-module-and-tdd-for-get-sqldiagrecommendations/</link><pubDate>Fri, 30 Jun 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/creating-a-powershell-module-and-tdd-for-get-sqldiagrecommendations/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>PowerShell Module for the SQL Server Diagnostics API – 1st Command Get-SQLDiagRecommendations</title><link>https://blog.robsewell.com/blog/powershell-module-for-the-sql-server-diagnostics-api-1st-command-get-sqldiagrecommendations/</link><pubDate>Thu, 29 Jun 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/powershell-module-for-the-sql-server-diagnostics-api-1st-command-get-sqldiagrecommendations/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>VSCode – PowerShell extension 1.4.0 new command Out-CurrentFile</title><link>https://blog.robsewell.com/blog/vscode-powershell-extension-1.4.0-new-command-out-currentfile/</link><pubDate>Thu, 22 Jun 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/vscode-powershell-extension-1.4.0-new-command-out-currentfile/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>dbatools at #SQLSatDublin</title><link>https://blog.robsewell.com/blog/dbatools-at-%23sqlsatdublin/</link><pubDate>Wed, 21 Jun 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/dbatools-at-%23sqlsatdublin/</guid><description>&lt;p&gt;This weekend &lt;a class="link" href="http://www.sqlsaturday.com/620/EventHome.aspx" target="_blank" rel="noopener"
&gt;SQL Saturday Dublin&lt;/a&gt; occurred. For those that don’t know &lt;a class="link" href="http://www.sqlsaturday.com/" target="_blank" rel="noopener"
&gt;SQL Saturdays&lt;/a&gt; are free conferences with local and international speakers providing great sessions in the Data Platform sphere.&lt;/p&gt;
&lt;p&gt;Chrissy LeMaire and I presented our session PowerShell SQL Server: Modern Database Administration with &lt;a class="link" href="https://dbatools.io/" target="_blank" rel="noopener"
&gt;dbatools&lt;/a&gt;. You can find &lt;a class="link" href="https://github.com/sqlcollaborative/community-presentations/tree/master/rob-sewell-chrissy-lemaire" target="_blank" rel="noopener"
&gt;slides and code here&lt;/a&gt; . We were absolutely delighted to be named Best Speaker which was decided from the attendees average evaluation.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Wow, &lt;a class="link" href="https://twitter.com/cl" target="_blank" rel="noopener"
&gt;@cl&lt;/a&gt; and i won the coveted best speaker award at &lt;a class="link" href="https://twitter.com/hashtag/SqlSatDublin?src=hash" target="_blank" rel="noopener"
&gt;#SqlSatDublin&lt;/a&gt; Thank you so much. We are so pleased &lt;a class="link" href="https://t.co/f0MPTJf74p" target="_blank" rel="noopener"
&gt;pic.twitter.com/f0MPTJf74p&lt;/a&gt;&lt;/p&gt;</description></item><item><title>VS Code – Automatic Dynamic PowerShell Help</title><link>https://blog.robsewell.com/blog/vs-code-automatic-dynamic-powershell-help/</link><pubDate>Mon, 12 Jun 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/vs-code-automatic-dynamic-powershell-help/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>Pester for Presentations – Ensuring it goes ok</title><link>https://blog.robsewell.com/blog/pester-for-presentations-ensuring-it-goes-ok/</link><pubDate>Tue, 16 May 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/pester-for-presentations-ensuring-it-goes-ok/</guid><description>&lt;p&gt;Whilst I was at &lt;a class="link" href="http://psconf.eu" target="_blank" rel="noopener"
&gt;PSCONFEU&lt;/a&gt; I presented a session on writing pester tests instead of using checklists.
&lt;div class="video-wrapper"&gt;
&lt;iframe loading="lazy"
src="https://www.youtube.com/embed/uvT57pt8"
allowfullscreen
title="YouTube Video"
&gt;
&lt;/iframe&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;You can see it here.&lt;/p&gt;
&lt;p&gt;During the talk I showed the pester test that I use to make sure that everything is ready for my presentation. A couple of people have asked me about this and wanted to know more so I thought that I would blog about it.&lt;/p&gt;
&lt;p&gt;Some have said that I might be being a little OCD about it 😉 I agree that it could seem like that but there is nothing worse than having things go wrong during your presentation. It makes your heart beat faster and removes the emphasis from the presentation that you give.&lt;/p&gt;</description></item><item><title>Pester Test Inception and the Show Parameter</title><link>https://blog.robsewell.com/blog/pester-test-inception-and-the-show-parameter/</link><pubDate>Tue, 09 May 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/pester-test-inception-and-the-show-parameter/</guid><description>&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2017/05/c_edtk0xoaa1pl7-2.jpg"
loading="lazy"
alt="C_EDtK0XoAA1PL7 (2).jpg"
&gt;&lt;/p&gt;
&lt;p&gt;and whilst we were there we were chatting about running Pester Tests. He wanted to know how he could run a Pester Test and not lose the failed tests as they scrolled past him. In his particular example we were talking about running hundreds of tests on thousands of databases on hundreds of servers&lt;/p&gt;
&lt;p&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2017/05/01-pesters.gif"
loading="lazy"
alt="01 - pesters.gif"
&gt;&lt;/p&gt;
&lt;p&gt;I guess it looks something like that!!&lt;/p&gt;</description></item><item><title>PowerShell Function – Validating a Parameter Depending On A Previous Parameter’s Value</title><link>https://blog.robsewell.com/blog/powershell-function-validating-a-parameter-depending-on-a-previous-parameters-value/</link><pubDate>Wed, 26 Apr 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/powershell-function-validating-a-parameter-depending-on-a-previous-parameters-value/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2017/04/01-more-help.png" alt="Featured image of post PowerShell Function – Validating a Parameter Depending On A Previous Parameter’s Value" /&gt;&lt;p&gt;I was chatting on the &lt;a class="link" href="https://sqlps.io/slack" target="_blank" rel="noopener"
&gt;SQL Community Slack&lt;/a&gt; with my friend Sander Stad &lt;a class="link" href="http://www.sqlstad.nl/" target="_blank" rel="noopener"
&gt;b&lt;/a&gt; | &lt;a class="link" href="https://twitter.com/sqlstad" target="_blank" rel="noopener"
&gt;t&lt;/a&gt; about some functions he is writing for the amazing PowerShell SQL Server Community module &lt;a class="link" href="https://dbatools.io" target="_blank" rel="noopener"
&gt;dbatools&lt;/a&gt;. He was asking my opinion as to how to enable user choice or options for Agent Schedules and I said that he should validate the input of the parameters. He said that was difficult as if the parameter was Weekly the frequency values required would be different from if the parameter was Daily or Monthly. That’s ok, I said, you can still validate the parameter.&lt;/p&gt;</description></item><item><title>Setting the default file type for a new file in VS Code</title><link>https://blog.robsewell.com/blog/setting-the-default-file-type-for-a-new-file-in-vs-code/</link><pubDate>Mon, 24 Apr 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/setting-the-default-file-type-for-a-new-file-in-vs-code/</guid><description>&lt;p&gt;Just a short post today. When you open a new file in VS Code (Using CTRL + N) it opens by default as a plain text file.&lt;/p&gt;
&lt;p&gt;To change the language for the file use CTRL +K, M.&lt;/p&gt;
&lt;p&gt;That’s CTRL and K together and then M afterwards separately.&lt;/p&gt;
&lt;p&gt;then you can choose the language for the file. It looks like this&lt;/p&gt;
&lt;p&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2017/04/01-change-language.gif"
loading="lazy"
alt="01 - Change language"
&gt;&lt;/p&gt;
&lt;p&gt;However, if you just want your new file to open as a particular language every time you can change this in the settings.&lt;/p&gt;</description></item><item><title>Using Twitter with VS Code</title><link>https://blog.robsewell.com/blog/using-twitter-with-vs-code/</link><pubDate>Wed, 19 Apr 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/using-twitter-with-vs-code/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>Why VS Code Increases my Productivity</title><link>https://blog.robsewell.com/blog/why-vs-code-increases-my-productivity/</link><pubDate>Thu, 13 Apr 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/why-vs-code-increases-my-productivity/</guid><description>&lt;p&gt;Last week I was showing a co-worker some PowerShell code and he asked what the editor was that I was using. &lt;a class="link" href="https://code.visualstudio.com/" target="_blank" rel="noopener"
&gt;Visual Studio Code&lt;/a&gt; I said. Why do you use that? What does it do? This is what I showed him&lt;/p&gt;
&lt;h3 id="runs-on-any-operating-system"&gt;Runs on any Operating System
&lt;/h3&gt;&lt;p&gt;Code (as I shall refer to it) is free lightweight open source editor which runs on all the main operating systems. So you have the same experience in Linux as on Windows. So there is less to learn&lt;/p&gt;</description></item><item><title>Why Volunteer at SQLBits ?</title><link>https://blog.robsewell.com/blog/why-volunteer-at-sqlbits/</link><pubDate>Tue, 11 Apr 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/why-volunteer-at-sqlbits/</guid><description>&lt;p&gt;WARNING – Contains Orange and light-hearted photos 😉&lt;/p&gt;
&lt;p&gt;I have returned home from SQLBits 2017 The Disco Edition. I am exhausted, my body is pointing out to me in a variety of ways that this is the only week of the year that I spend so much time on my feet. Why would anyone do it?&lt;/p&gt;
&lt;h2 id="many-months-of-work"&gt;Many months of work
&lt;/h2&gt;&lt;p&gt;First though, you need to know that the SQLBits conference is organised and run by volunteers. All of the committee spend many, many long hours, out of their own free time, for many months before and after the event to ensure that the attendees, sponsors, speakers and volunteers experience is trouble free. I think that they do an amazing and fantastic job and repeatedly pull off the best, most enjoyable conference that I have been to.&lt;/p&gt;</description></item><item><title>Export SQL User Permissions to T-SQL script using PowerShell and dbatools</title><link>https://blog.robsewell.com/blog/export-sql-user-permissions-to-t-sql-script-using-powershell-and-dbatools/</link><pubDate>Mon, 10 Apr 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/export-sql-user-permissions-to-t-sql-script-using-powershell-and-dbatools/</guid><description>&lt;p&gt;NOTE - Updated November 2022 for this site and the correct command name.&lt;/p&gt;
&lt;p&gt;There are times when DBA’s are required to export database user permissions to a file. This may be for a number of reasons. Maybe for DR purposes, for auditing, for transfer to another database or instance. Sometimes we need to create a new user with the same permissions as another user or perhaps nearly the same permissions. I was having a conversation with my good friend and &lt;a class="link" href="https://twitter.com/claudioessilva" target="_blank" rel="noopener"
&gt;MVP Cláudio Silva&lt;/a&gt; and we were talking about how &lt;a class="link" href="https://docs.dbatools.io/Export-DbaUser" target="_blank" rel="noopener"
&gt;Export-DbaUser&lt;/a&gt; from &lt;a class="link" href="https://dbatools.io" target="_blank" rel="noopener"
&gt;dbatools&lt;/a&gt; could help in these situations and he suggested that I blogged about it so here it is.&lt;/p&gt;</description></item><item><title>Testing SQL Server Access to a share with PowerShell using dbatools</title><link>https://blog.robsewell.com/blog/testing-sql-server-access-to-a-share-with-powershell-using-dbatools/</link><pubDate>Sat, 08 Apr 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/testing-sql-server-access-to-a-share-with-powershell-using-dbatools/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>Testing the Identity Column usage in SQL Server with PowerShell and dbatools</title><link>https://blog.robsewell.com/blog/testing-the-identity-column-usage-in-sql-server-with-powershell-and-dbatools/</link><pubDate>Fri, 07 Apr 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/testing-the-identity-column-usage-in-sql-server-with-powershell-and-dbatools/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>Using Pester with Get-DbaLastGoodCheckDb from dbatools</title><link>https://blog.robsewell.com/blog/using-pester-with-get-dbalastgoodcheckdb-from-dbatools/</link><pubDate>Thu, 06 Apr 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/using-pester-with-get-dbalastgoodcheckdb-from-dbatools/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>Getting SQLServers Last Known Good DBCC Checkdb with PowerShell and dbatools</title><link>https://blog.robsewell.com/blog/getting-sqlservers-last-known-good-dbcc-checkdb-with-powershell-and-dbatools/</link><pubDate>Wed, 05 Apr 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/getting-sqlservers-last-known-good-dbcc-checkdb-with-powershell-and-dbatools/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>Test the SQL Server database collation with PowerShell and dbatools</title><link>https://blog.robsewell.com/blog/test-the-sql-server-database-collation-with-powershell-and-dbatools/</link><pubDate>Mon, 03 Apr 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/test-the-sql-server-database-collation-with-powershell-and-dbatools/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>Max Length of a column in a DataTable in PowerShell</title><link>https://blog.robsewell.com/blog/max-length-of-a-column-in-a-datatable-in-powershell/</link><pubDate>Sat, 01 Apr 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/max-length-of-a-column-in-a-datatable-in-powershell/</guid><description>&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;&amp;ldquo;@
}
New-IseSnippet @snippet
}&lt;!-- raw HTML omitted --&gt;&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;</description></item><item><title>Getting SQL Server File Sizes and Space Used with dbatools</title><link>https://blog.robsewell.com/blog/getting-sql-server-file-sizes-and-space-used-with-dbatools/</link><pubDate>Wed, 29 Mar 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/getting-sql-server-file-sizes-and-space-used-with-dbatools/</guid><description>&lt;p&gt;I read a great blog post about answering the question &lt;a class="link" href="https://sqlbuffet.wordpress.com/2017/03/08/how-big-is-the-database-how-to-answer-that-annoying-question/" target="_blank" rel="noopener"
&gt;how big is the database using T-SQL on SQL Buffet&lt;/a&gt; and wondered how much I could do with the &lt;a class="link" href="https://dbatools.io" target="_blank" rel="noopener"
&gt;dbatools module&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The dbatools module (for those that don’t know) is a PowerShell module written by amazing folks in the community designed to make administrating your SQL Server significantly easier using PowerShell. The instructions for installing it are &lt;a class="link" href="https://dbatools.io/getting-started/" target="_blank" rel="noopener"
&gt;available here&lt;/a&gt; It comprises of 182 separate commands at present (11 March 2017 Version 0.8.938)&lt;/p&gt;</description></item><item><title>Test your Sqlserver backups on Linux with PowerShell and dbatools</title><link>https://blog.robsewell.com/blog/test-your-sqlserver-backups-on-linux-with-powershell-and-dbatools/</link><pubDate>Mon, 27 Mar 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/test-your-sqlserver-backups-on-linux-with-powershell-and-dbatools/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>Using Pester with dbatools Test-DbaLastBackup</title><link>https://blog.robsewell.com/blog/using-pester-with-dbatools-test-dbalastbackup/</link><pubDate>Sat, 25 Mar 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/using-pester-with-dbatools-test-dbalastbackup/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>Backing up SQL Server on Linux using Ola Hallengrens Maintenance Solution</title><link>https://blog.robsewell.com/blog/backing-up-sql-server-on-linux-using-ola-hallengrens-maintenance-solution/</link><pubDate>Wed, 22 Mar 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/backing-up-sql-server-on-linux-using-ola-hallengrens-maintenance-solution/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>Taking dbatools Test-DbaLastBackup a little further</title><link>https://blog.robsewell.com/blog/taking-dbatools-test-dbalastbackup-a-little-further/</link><pubDate>Wed, 22 Mar 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/taking-dbatools-test-dbalastbackup-a-little-further/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>Testing Your SQL Server Backups the Easy Way with PowerShell &amp; dbatools</title><link>https://blog.robsewell.com/blog/testing-your-sql-server-backups-the-easy-way-with-powershell-dbatools/</link><pubDate>Mon, 20 Mar 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/testing-your-sql-server-backups-the-easy-way-with-powershell-dbatools/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>Restoring an entire SQL Server user databases with PowerShell using dbatools</title><link>https://blog.robsewell.com/blog/restoring-an-entire-sql-server-user-databases-with-powershell-using-dbatools/</link><pubDate>Sat, 18 Mar 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/restoring-an-entire-sql-server-user-databases-with-powershell-using-dbatools/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>Adding a PowerShell Job Step to an existing SQL Agent Job Step with PowerShell</title><link>https://blog.robsewell.com/blog/adding-a-powershell-job-step-to-an-existing-sql-agent-job-step-with-powershell/</link><pubDate>Mon, 13 Mar 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/adding-a-powershell-job-step-to-an-existing-sql-agent-job-step-with-powershell/</guid><description>&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;}&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;</description></item><item><title>VS Code PowerShell Snippets</title><link>https://blog.robsewell.com/blog/vs-code-powershell-snippets/</link><pubDate>Sun, 12 Mar 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/vs-code-powershell-snippets/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>Quickly Creating Test Users in SQL Server with PowerShell using the sqlserver module and dbatools</title><link>https://blog.robsewell.com/blog/quickly-creating-test-users-in-sql-server-with-powershell-using-the-sqlserver-module-and-dbatools/</link><pubDate>Mon, 06 Mar 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/quickly-creating-test-users-in-sql-server-with-powershell-using-the-sqlserver-module-and-dbatools/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2017/02/remove-them-all.png" alt="Featured image of post Quickly Creating Test Users in SQL Server with PowerShell using the sqlserver module and dbatools" /&gt;&lt;p&gt;One of the most visited posts on my blog is nearly two and half years old now – &lt;!-- raw HTML omitted --&gt;Add User to SQL Server Database Role with PowerShell and Quickly Creating Test Users&lt;!-- raw HTML omitted --&gt;. I thought it was time to update it and use the &lt;!-- raw HTML omitted --&gt;latest sqlserver module&lt;!-- raw HTML omitted --&gt; and the &lt;!-- raw HTML omitted --&gt;dbatools module&lt;!-- raw HTML omitted --&gt;.&lt;/p&gt;</description></item><item><title>SQL VNext sp_configure on Windows and Linux with dbatools</title><link>https://blog.robsewell.com/blog/sql-vnext-sp_configure-on-windows-and-linux-with-dbatools/</link><pubDate>Mon, 27 Feb 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/sql-vnext-sp_configure-on-windows-and-linux-with-dbatools/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>Adding a T-SQL Job Step to a SQL Agent Job with PowerShell</title><link>https://blog.robsewell.com/blog/adding-a-t-sql-job-step-to-a-sql-agent-job-with-powershell/</link><pubDate>Mon, 20 Feb 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/adding-a-t-sql-job-step-to-a-sql-agent-job-with-powershell/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>Altering a Job Step on Hundreds of SQL Servers with PowerShell</title><link>https://blog.robsewell.com/blog/altering-a-job-step-on-hundreds-of-sql-servers-with-powershell/</link><pubDate>Mon, 13 Feb 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/altering-a-job-step-on-hundreds-of-sql-servers-with-powershell/</guid><description>&lt;img src="https://dbatools.io/wp-content/uploads/2016/05/dbatools-logo-1.png" alt="Featured image of post Altering a Job Step on Hundreds of SQL Servers with PowerShell" /&gt;&lt;p&gt;I flew to Utrecht last week to present with &lt;!-- raw HTML omitted --&gt;Chrissy LeMaire&lt;!-- raw HTML omitted --&gt; and &lt;!-- raw HTML omitted --&gt;Sander Stad&lt;!-- raw HTML omitted --&gt; for the joint Dutch SQL and PowerShell User Groups. Whilst I was sat at the airport I got a phone call from my current client.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Them - We need to change the backup path for all of the servers to a different share, how long will it take you?&lt;/p&gt;</description></item><item><title>Using the PowerShell SQL Provider with SQL Authentication</title><link>https://blog.robsewell.com/blog/using-the-powershell-sql-provider-with-sql-authentication/</link><pubDate>Thu, 12 Jan 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/using-the-powershell-sql-provider-with-sql-authentication/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>A Whole Day of PowerShell and SQL – Join Chrissy LeMaire &amp; I at #sqlsatvienna</title><link>https://blog.robsewell.com/blog/a-whole-day-of-powershell-and-sql-join-chrissy-lemaire-i-at-sqlsatvienna/</link><pubDate>Mon, 09 Jan 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/a-whole-day-of-powershell-and-sql-join-chrissy-lemaire-i-at-sqlsatvienna/</guid><description>&lt;!-- raw HTML omitted --&gt;</description></item><item><title>Running SQL Queries with Visual Studio Code</title><link>https://blog.robsewell.com/blog/running-sql-queries-with-visual-studio-code/</link><pubDate>Thu, 05 Jan 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/running-sql-queries-with-visual-studio-code/</guid><description>&lt;p&gt;Reading this blog post by &lt;a class="link" href="http://www.sqlshack.com/introduction-visual-studio-code-dbas/" target="_blank" rel="noopener"
&gt;Shawn Melton Introduction of Visual Studio Code for DBAs&lt;/a&gt; reminded me that whilst I use Visual Studio Code (which I shall refer to as Code from here on) for writing PowerShell and Markdown and love how easily it interacts with Github I hadn’t tried T-SQL. If you are new to Code (or if you are not) go and read Shawns blog post but here are the steps I took to running T-SQL code using Code&lt;/p&gt;</description></item><item><title>2016 - That was a Year :-)</title><link>https://blog.robsewell.com/blog/2016-that-was-a-year-/</link><pubDate>Mon, 02 Jan 2017 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/2016-that-was-a-year-/</guid><description>&lt;p&gt;Its the time of year for reflection and I have had the most amazing 2016, I am blessed that I love what I do so much. I thoroughly enjoy writing and talking and sharing and commenting and supporting and cherishing all the SQL and PowerShell things. &lt;a class="link" href="http://sqldbawithabeard.com/2016/10/29/powerbi-and-api-visualising-my-checkins/" target="_blank" rel="noopener"
&gt;I wrote about using Power Bi to display my checkins&lt;/a&gt;. I only started this in June and this is where I have been :-)&lt;/p&gt;</description></item><item><title>Deploying a Windows Data Science Virtual Machine to Azure with PowerShell easily</title><link>https://blog.robsewell.com/blog/deploying-a-windows-data-science-virtual-machine-to-azure-with-powershell-easily/</link><pubDate>Sun, 18 Dec 2016 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/deploying-a-windows-data-science-virtual-machine-to-azure-with-powershell-easily/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2016/12/rdp-file.png" alt="Featured image of post Deploying a Windows Data Science Virtual Machine to Azure with PowerShell easily" /&gt;&lt;p&gt;This weekend (10 December 2016), I went to Slovenia for a &lt;a class="link" href="http://www.sqlsaturday.com/567/eventhome.aspx" target="_blank" rel="noopener"
&gt;SQL Saturday&lt;/a&gt;. As always, it was an amazing event well organised by &lt;a class="link" href="https://twitter.com/MladenPrajdic" target="_blank" rel="noopener"
&gt;Mladen Prajdic&lt;/a&gt;, &lt;a class="link" href="http://sqlblog.com/blogs/dejan_sarka/default.aspx" target="_blank" rel="noopener"
&gt;Dejan Sarka&lt;/a&gt;, and &lt;a class="link" href="https://twitter.com/MatijaLah" target="_blank" rel="noopener"
&gt;Matija Lah&lt;/a&gt; in a fabulous setting amongst fabulous scenery. I highly recommend it and, also, &lt;a class="link" href="https://en.wikipedia.org/wiki/Ljubljana" target="_blank" rel="noopener"
&gt;Ljubljana&lt;/a&gt;  is a wonderful place to be in December with all the lights and markets.&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/assets/uploads/2016/12/wp_20161209_19_21_06_pro.jpg" &gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2016/12/wp_20161209_19_21_06_pro.jpg"
loading="lazy"
alt="WP_20161209_19_21_06_Pro.jpg"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Whilst I was there I was asked by someone if you could deploy data science virtual machines in Azure with PowerShell. I said I was sure that it could be done and agreed I would write a blog post, so here it is.&lt;/p&gt;</description></item><item><title>Enabling Cortana for dbareports PowerBi</title><link>https://blog.robsewell.com/blog/enabling-cortana-for-dbareports-powerbi/</link><pubDate>Sun, 13 Nov 2016 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/enabling-cortana-for-dbareports-powerbi/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2016/11/cortana-search-2.png" alt="Featured image of post Enabling Cortana for dbareports PowerBi" /&gt;&lt;p&gt;Last week at the Birmingham user group I gave a presentation about PowerShell and SQL Server&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/assets/uploads/2016/11/saved-image-from-tweetium-8.jpg" &gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2016/11/saved-image-from-tweetium-8.jpg"
loading="lazy"
alt="saved-image-from-tweetium-8"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;It was a very packed session as I crammed in the &lt;a class="link" href="https://blogs.technet.microsoft.com/dataplatforminsider/2016/06/30/sql-powershell-july-2016-update/" target="_blank" rel="noopener"
&gt;new sqlserver module&lt;/a&gt;, &lt;a class="link" href="https://dbatools.io" target="_blank" rel="noopener"
&gt;dbatools&lt;/a&gt; and &lt;a class="link" href="https://dbareports.io" target="_blank" rel="noopener"
&gt;dbareports&lt;/a&gt; 🙂 On reflection I think this is a bit too much for a one hour session but at the end of the session I demo’d live Cortana using the dbareports dataset and returning a Cortana PowerBi page.&lt;/p&gt;</description></item><item><title>Speaking? You? Go on. #tsql2sday #84</title><link>https://blog.robsewell.com/blog/speaking-you-go-on.-tsql2sday-84/</link><pubDate>Tue, 08 Nov 2016 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/speaking-you-go-on.-tsql2sday-84/</guid><description>&lt;p&gt;This is a blog post for &lt;a class="link" href="https://sqlbek.wordpress.com/2016/10/25/t-sql-tuesday-84-growing-new-speakers/" target="_blank" rel="noopener"
&gt;this month&amp;rsquo;s T-SQL Tuesday post&lt;/a&gt;, hosted by Andy Yun (&lt;a class="link" href="https://sqlbek.wordpress.com/author/sqlbek/" target="_blank" rel="noopener"
&gt;b&lt;/a&gt;|&lt;a class="link" href="https://twitter.com/SQLBek" target="_blank" rel="noopener"
&gt;t&lt;/a&gt;). &lt;a class="link" href="http://sqlblog.com/blogs/adam_machanic/" target="_blank" rel="noopener"
&gt;T-SQL Tuesday&lt;/a&gt; is a monthly blog event started by Adam Machanic (&lt;a class="link" href="http://sqlblog.com/blogs/adam_machanic/" target="_blank" rel="noopener"
&gt;b&lt;/a&gt;|&lt;a class="link" href="https://twitter.com/adammachanic" target="_blank" rel="noopener"
&gt;t&lt;/a&gt;). The T-SQL Tuesday topic this month was about advice for new speakers. Thanks Andy for hosting. I have created a channel in the &lt;a class="link" href="https://sqlps.io/slack" target="_blank" rel="noopener"
&gt;SQL Server Community Slack&lt;/a&gt; for presenting which everyone can make use of to ask and to answer questions&lt;/p&gt;</description></item><item><title>PowerBi and API – Visualising my Checkins</title><link>https://blog.robsewell.com/blog/powerbi-and-api-visualising-my-checkins/</link><pubDate>Sat, 29 Oct 2016 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/powerbi-and-api-visualising-my-checkins/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2016/10/powerbi6.png%29%5D%28/assets/uploads/2016/10/powerbi6.png" alt="Featured image of post PowerBi and API – Visualising my Checkins" /&gt;&lt;p&gt;For my own amusement and also to show my wife where I have been I use the &lt;a class="link" href="https://www.swarmapp.com/" target="_blank" rel="noopener"
&gt;Swarm&lt;/a&gt; check-in app on my phone and check-in to places. Also for my own amusement I used PowerBi to visualise the data via the API and allow me to filter it in various ways.&lt;/p&gt;
&lt;p&gt;Whilst at the &lt;a class="link" href="https://blog.robsewell.com/psconfasia-2016/" &gt;PowerShell Conference in Asia&lt;/a&gt; I was showing the mobile app to a group over some food and saying how easy it was and &lt;a class="link" href="http://twitter.com/@juneb_get_help" target="_blank" rel="noopener"
&gt;June Blender&lt;/a&gt;, the mother of PowerShell help, said that I ought to blog about it. So I have 🙂&lt;/p&gt;</description></item><item><title>PSConfAsia 2016</title><link>https://blog.robsewell.com/blog/psconfasia-2016/</link><pubDate>Mon, 24 Oct 2016 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/psconfasia-2016/</guid><description>&lt;p&gt;I have just got back to the UK from Singapore following the amazing &lt;a class="link" href="http://www.psconf.asia/" target="_blank" rel="noopener"
&gt;PSConfAsia&lt;/a&gt; conference. I must say that Matt, Milton, Sebastian and Ben did a fantastic job organising this conference and were proud that there was a notable increase in attendees from last year.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://blog.robsewell.com/..%5cassets%5cuploads%5c2016%5c10%5csebastians-photo.jpg"
loading="lazy"
alt="sebastians-photo"
&gt;&lt;/p&gt;
&lt;p&gt; &lt;/p&gt;
&lt;p&gt;The conference began (unofficially) with a PowerShell User group session in the Microsoft Offices on Wednesday where &lt;a class="link" href="http://www.ravichaganti.com/blog/" target="_blank" rel="noopener"
&gt;Ravi Chaganti&lt;/a&gt; spoke about DSC&lt;/p&gt;
&lt;p&gt;&lt;img src="https://blog.robsewell.com/..%5cassets%5cuploads%5c2016%5c10%5cwp_20161019_19_56_07_pro-2.jpg"
loading="lazy"
alt="WP_20161019_19_56_07_Pro (2).jpg"
&gt;&lt;/p&gt;</description></item><item><title>PowerShell, Pester and Ola Hallengrens Maintenance Solution</title><link>https://blog.robsewell.com/blog/powershell-pester-and-ola-hallengrens-maintenance-solution/</link><pubDate>Sat, 24 Sep 2016 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/powershell-pester-and-ola-hallengrens-maintenance-solution/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2016/09/pester-ola-check.png" alt="Featured image of post PowerShell, Pester and Ola Hallengrens Maintenance Solution" /&gt;&lt;p&gt;If you are a SQL DBA you will have heard of &lt;a class="link" href="https://ola.hallengren.com/" target="_blank" rel="noopener"
&gt;Ola Hallengrens Maintenance solution&lt;/a&gt; If you haven’t go and click the link and look at the easiest way to ensure that all of your essential database maintenance is performed. You can also &lt;a class="link" href="https://sqlbits.com/Sessions/Event9/Inside_Ola_Hallengrens_Maintenance_Solution" target="_blank" rel="noopener"
&gt;watch a video from Ola at SQL Bits&lt;/a&gt;
Recently I was thinking about how I could validate that this solution was installed in the way that I wanted it to be so I turned to &lt;a class="link" href="https://github.com/pester/Pester" target="_blank" rel="noopener"
&gt;Pester&lt;/a&gt; You can find a great &lt;a class="link" href="https://mcpmag.com/articles/2016/05/19/test-powershell-modules-with-pester.aspx" target="_blank" rel="noopener"
&gt;how to get started here&lt;/a&gt; which will show you how to get Pester and how to get started with TDD.
This isn’t TDD though this is Environment Validation and this is how I went about creating my test.
First I thought about what I would look for in SSMS when I had installed the maintenance solution and made a list of the things that I would check which looked something like this. This would be the checklist you would create (or have already created) for yourself or a junior following this install. This is how easy you can turn that checklist into a Pester Test and remove the human element and open your install for automated testing&lt;/p&gt;</description></item><item><title>The SQL Server Community Collaborative GitHub Organisation is born</title><link>https://blog.robsewell.com/blog/the-sql-server-community-collaborative-github-organisation-is-born/</link><pubDate>Wed, 14 Sep 2016 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/the-sql-server-community-collaborative-github-organisation-is-born/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2016/09/wp_20160910_10_14_58_pro.jpg" alt="Featured image of post The SQL Server Community Collaborative GitHub Organisation is born" /&gt;&lt;p&gt;My wonderful friend &lt;a class="link" href="https://twitter.com/cl" target="_blank" rel="noopener"
&gt;Chrissy LeMaire&lt;/a&gt; and I are the creators of two GitHub repositories for SQL Server and PowerShell called &lt;a class="link" href="https://dbatools.io/" target="_blank" rel="noopener"
&gt;dbatools&lt;/a&gt; and &lt;a class="link" href="https://dbareports.io" target="_blank" rel="noopener"
&gt;dbareports&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;If you are working with SQL Server I highly recommend that you take a look at the vast number of commands available to you at &lt;a class="link" href="https://dbatools.io/" target="_blank" rel="noopener"
&gt;dbatools&lt;/a&gt; which will help you complete tasks within SQL Server especially for Instance migrations and also a growing number of best practice implementations&lt;/p&gt;</description></item><item><title>Converting SQL Agent Job Duration to TimeSpan using PowerShell</title><link>https://blog.robsewell.com/blog/converting-sql-agent-job-duration-to-timespan-using-powershell/</link><pubDate>Mon, 12 Sep 2016 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/converting-sql-agent-job-duration-to-timespan-using-powershell/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2016/09/timespan.png" alt="Featured image of post Converting SQL Agent Job Duration to TimeSpan using PowerShell" /&gt;&lt;p&gt;When you look in msdb for the SQL Agent Job duration you will find that it is an int.&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/assets/uploads/2016/09/sysjobshistoiry.png" &gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2016/09/sysjobshistoiry.png"
loading="lazy"
alt="sysjobshistoiry"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;This is also the same when you look at &lt;code&gt;Get-SQLAgentJobHistory &lt;/code&gt;from the sqlserver module. (You can get this by &lt;a class="link" href="https://msdn.microsoft.com/en-us/library/mt238290.aspx" target="_blank" rel="noopener"
&gt;downloading the latest SSMS release from here&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/assets/uploads/2016/09/agentjobhistoryproperties.png" &gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2016/09/agentjobhistoryproperties.png"
loading="lazy"
alt="agentjobhistoryproperties"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;This means that when you look at the various duration of the Agent Jobs you get something like this&lt;/p&gt;</description></item><item><title>Making Start-Demo work with multi-line commands without a backtick</title><link>https://blog.robsewell.com/blog/making-start-demo-work-with-multi-line-commands-without-a-backtick/</link><pubDate>Mon, 29 Aug 2016 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/making-start-demo-work-with-multi-line-commands-without-a-backtick/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2016/08/start-demo2.png" alt="Featured image of post Making Start-Demo work with multi-line commands without a backtick" /&gt;&lt;p&gt;I love to speak about PowerShell. I really enjoy giving presentations and when I saw Start-Demo being used at the PowerShell Conference in Hanover I started to make use of it in my presentations.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Start-Demo&lt;/code&gt; was written in 2007 by a fella who knows PowerShell pretty well 🙂  &lt;a class="link" href="https://blogs.msdn.microsoft.com/powershell/2007/03/03/start-demo-help-doing-demos-using-powershell/" target="_blank" rel="noopener"
&gt;https://blogs.msdn.microsoft.com/powershell/2007/03/03/start-demo-help-doing-demos-using-powershell/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;It was then updated in 2012 by Max Trinidad &lt;a class="link" href="http://www.maxtblog.com/2012/02/powershell-start-demo-now-allows-multi-lines-onliners/" target="_blank" rel="noopener"
&gt;http://www.maxtblog.com/2012/02/powershell-start-demo-now-allows-multi-lines-onliners/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;This enabled support for multi-line code using backticks at the end of each line. This works well but I dislike having to use the backticks in foreach loops, it confuses people who think that they need to be included and to my mind looks a bit messy&lt;/p&gt;</description></item><item><title>Remove-SQLDatabaseSafely My First Contribution to DBATools</title><link>https://blog.robsewell.com/blog/remove-sqldatabasesafely-my-first-contribution-to-dbatools/</link><pubDate>Wed, 20 Jul 2016 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/remove-sqldatabasesafely-my-first-contribution-to-dbatools/</guid><description>&lt;p&gt;What is DBA Tools?&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;A collection of modules for SQL Server DBAs. It initially started out as ‘sqlmigration’, but has now grown into a collection of various commands that help automate DBA tasks and encourage best practices.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;You can read more about &lt;a class="link" href="https://dbatools.io" target="_blank" rel="noopener"
&gt;here&lt;/a&gt; and it is &lt;a class="link" href="https://github.com/ctrlbold/dbatools" target="_blank" rel="noopener"
&gt;freely available for download on GitHub&lt;/a&gt; I thoroughly recommend that [you watch this quick video]&lt;/p&gt;
&lt;div class="video-wrapper"&gt;
&lt;iframe loading="lazy"
src="https://www.youtube.com/embed/PciYdDEBiDM"
allowfullscreen
title="YouTube Video"
&gt;
&lt;/iframe&gt;
&lt;/div&gt;
&lt;p&gt;to see just how easy it is to migrate an entire SQL instance in one command Longer session here&lt;/p&gt;</description></item><item><title>Using the new SQLServer Powershell module to get SQL Agent Job Information</title><link>https://blog.robsewell.com/blog/using-the-new-sqlserver-powershell-module-to-get-sql-agent-job-information/</link><pubDate>Sun, 03 Jul 2016 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/using-the-new-sqlserver-powershell-module-to-get-sql-agent-job-information/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2016/07/getcomand-sqlagent.png" alt="Featured image of post Using the new SQLServer Powershell module to get SQL Agent Job Information" /&gt;&lt;p&gt;So with the July Release of SSMS everything changed for using PowerShell with SQL. &lt;a class="link" href="https://blogs.technet.microsoft.com/dataplatforminsider/2016/06/30/sql-powershell-july-2016-update/" target="_blank" rel="noopener"
&gt;You can read the details here&lt;/a&gt; As I mentioned in my previous post the name of the module has changed to sqlserver&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;This means that if you have a PowerShell script doing&lt;/em&gt; Import-Module SQLPS_, it will need to be changed to be_ Import-Module SqlServer &lt;em&gt;in order to take advantage of the new provider functionality and new CMDLETs. The new module will be installed to&lt;/em&gt; “%Program Files\WindowsPowerShell\Modules\SqlServer_” and hence no update to $env:PSModulePath is required._&lt;/p&gt;</description></item><item><title>PowerShell CMDLets added for SQL2016 Always Encrypted</title><link>https://blog.robsewell.com/blog/powershell-cmdlets-added-for-sql2016-always-encrypted/</link><pubDate>Thu, 30 Jun 2016 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/powershell-cmdlets-added-for-sql2016-always-encrypted/</guid><description>&lt;p&gt;&lt;a class="link" href="https://blogs.technet.microsoft.com/dataplatforminsider/2016/06/30/sql-PowerShell-july-2016-update/" target="_blank" rel="noopener"
&gt;The post on the SQLServer blog at TechNet by the SQL Server Tools Team today&lt;/a&gt; made me jump out of my seat.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The July update for SSMS includes the first substantial improvement in SQL PowerShell in many years. We owe a lot of thanks for this effort to the great collaboration with our community. We have several new CMDLETs to share with you&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;In one release there are &lt;strong&gt;twenty-five&lt;/strong&gt; new CMDLets for the new sqlserver module&lt;/p&gt;</description></item><item><title>Some Pester Tests for SQL Defaults</title><link>https://blog.robsewell.com/blog/some-pester-tests-for-sql-defaults/</link><pubDate>Tue, 24 May 2016 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/some-pester-tests-for-sql-defaults/</guid><description>&lt;p&gt;When I was at &lt;a class="link" href="http://www.psconf.eu/" target="_blank" rel="noopener"
&gt;PowerShell Conference EU&lt;/a&gt; in Hannover last month (The videos are available now – &lt;a class="link" href="https://www.youtube.com/c/powershellconferenceeu" target="_blank" rel="noopener"
&gt;click here&lt;/a&gt; and the &lt;a class="link" href="https://github.com/psconfeu/2016" target="_blank" rel="noopener"
&gt;slides and code here&lt;/a&gt;) I found out about &lt;a class="link" href="https://pshirwin.wordpress.com/2016/04/08/active-directory-operations-test/" target="_blank" rel="noopener"
&gt;Irwin Strachans Active Directory Operations Test&lt;/a&gt; which got me thinking.&lt;/p&gt;
&lt;p&gt;I decided to do the same for my usual SQL Set-up. Treating all of your servers to the same defaults makes it even easier to manage at scale remotely.&lt;/p&gt;
&lt;p&gt;I am comfortable with using SMO to gather and change properties on SQL Instances so I started by doing this&lt;/p&gt;</description></item><item><title>DBA Database scripts are on Github</title><link>https://blog.robsewell.com/blog/dba-database-scripts-are-on-github/</link><pubDate>Mon, 16 May 2016 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/dba-database-scripts-are-on-github/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2016/05/tweets.png%29%5D%28/assets/uploads/2016/05/tweets.png" alt="Featured image of post DBA Database scripts are on Github" /&gt;&lt;p&gt;It started with a tweet from Dusty&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/assets/uploads/2016/05/tweets.png" &gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2016/05/tweets.png"
loading="lazy"
alt="Tweets"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The second session I presented at the fantastic &lt;a class="link" href="http://psconf.eu" target="_blank" rel="noopener"
&gt;PowerShell Conference Europe&lt;/a&gt; was about using the DBA Database to automatically install DBA scripts like &lt;a class="link" href="https://www.brentozar.com/first-aid/sql-server-downloads/" target="_blank" rel="noopener"
&gt;sp_Blitz, sp_AskBrent, sp_Blitzindex from Brent Ozar&lt;/a&gt; , &lt;a class="link" href="https://ola.hallengren.com/" target="_blank" rel="noopener"
&gt;Ola Hallengrens Maintenance Solution&lt;/a&gt; , &lt;a class="link" href="http://sqlblog.com/blogs/adam_machanic/archive/2012/03/22/released-who-is-active-v11-11.aspx" target="_blank" rel="noopener"
&gt;Adam Mechanics sp_whoisactive&lt;/a&gt; , &lt;a class="link" href="https://www.brentozar.com/responder/log-sp_whoisactive-to-a-table/" target="_blank" rel="noopener"
&gt;This fantastic script for logging the results from sp_whoisactive to a table&lt;/a&gt; , Extended events sessions and other goodies for the sanity of the DBA.&lt;/p&gt;</description></item><item><title>A Day In The Life of a SQLBits Volunteer</title><link>https://blog.robsewell.com/blog/a-day-in-the-life-of-a-sqlbits-volunteer/</link><pubDate>Tue, 10 May 2016 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/a-day-in-the-life-of-a-sqlbits-volunteer/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2016/05/dscn0286-3.jpg" alt="Featured image of post A Day In The Life of a SQLBits Volunteer" /&gt;&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/assets/uploads/2016/05/dscn0286-3.jpg" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2016/05/dscn0286-3.jpg"
loading="lazy"
alt="image"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;So SQLBits has finished for another year. About 1500 people registered for the largest SQL Conference in Europe held over 4 days in Liverpool last week. 2 days of full day sessions and 2 days of shorter sessions, a pub quiz, a party (literally) out of this world.&lt;/p&gt;
&lt;p&gt;It is organised and run by volunteers&lt;/p&gt;
&lt;p&gt;Yes, you’re right.&lt;/p&gt;
&lt;p&gt;Wow.&lt;/p&gt;
&lt;p&gt;Of course we must pay special thanks to Simon, Darren, Chris, Jonathan, Annette, Allan and Alex without forgetting all that JRJ has done. They ensured that the venue, sessions, speakers, sponsors, audio visual and not forgetting the amazing party by &lt;!-- raw HTML omitted --&gt;Sneaky Experience (Thank you Julia),&lt;!-- raw HTML omitted --&gt; all occurred at the right time in the right place with the right people and the work and effort they have put in cannot be over-estimated but this post isn’t about those generous, inspiring, amazing folk
Several people asked me what a volunteer does and how they can become one and hopefully this post will answer both of those questions. More than 40 people volunteered to help at SQL Bits&lt;/p&gt;</description></item><item><title>Using PowerShell to set Extended Events Sessions to AutoStart</title><link>https://blog.robsewell.com/blog/using-powershell-to-set-extended-events-sessions-to-autostart/</link><pubDate>Mon, 28 Mar 2016 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/using-powershell-to-set-extended-events-sessions-to-autostart/</guid><description>&lt;p&gt;When you look after more than a few SQL Servers you will need to perform the same actions against a number of  them and that is where PowerShell will be of great benefit. Recently I needed to ensure that all SQL Servers had a certain Extended Event Session set to auto-start and that it was running. I have used the Always On health session in the example below but you could use the same code below and do this for any Extended Event session. Just note that the code below checks for the existence of an Availability Group which may not be what you require.&lt;/p&gt;</description></item><item><title>Backing up to URL container name – case is important</title><link>https://blog.robsewell.com/blog/backing-up-to-url-container-name-case-is-important/</link><pubDate>Thu, 03 Mar 2016 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/backing-up-to-url-container-name-case-is-important/</guid><description>&lt;p&gt;If you use &lt;a class="link" href="https://msdn.microsoft.com/en-us/library/dn435916.aspx" target="_blank" rel="noopener"
&gt;SQL Backup to URL&lt;/a&gt; to backup your databases to Azure blob storage remember that for the container name case is important&lt;/p&gt;
&lt;p&gt;So&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;BACKUP LOG [DatabaseName]
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;TO URL = N&amp;#39;https://storageaccountname.blob.core.windows.net/containername/databasename_log_dmmyyhhss.trn&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;WITH CHECKSUM, NO_COMPRESSION, CREDENTIAL = N&amp;#39;credential&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;will work but&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;BACKUP LOG [DatabaseName]
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;TO URL = N&amp;#39;https://storageaccountname.blob.core.windows.net/CONTAINERNAME/databasename_log_dmmyyhhss.trn&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;WITH CHECKSUM, NO_COMPRESSION, CREDENTIAL = N&amp;#39;credential&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;will give an (400) Bad Request Error which may not be easy to diagnose&lt;/p&gt;</description></item><item><title>PowerShell Pester – The script failed due to call depth overflow.</title><link>https://blog.robsewell.com/blog/powershell-pester-the-script-failed-due-to-call-depth-overflow./</link><pubDate>Sun, 31 Jan 2016 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/powershell-pester-the-script-failed-due-to-call-depth-overflow./</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2016/01/pester-success_thumb1.jpg" alt="Featured image of post PowerShell Pester – The script failed due to call depth overflow." /&gt;&lt;p&gt;This error caught me out. I am putting this post here firstly to remind me if I do it again and also to help others who may hit the same issue.&lt;/p&gt;
&lt;p&gt;I also have been looking at &lt;a class="link" href="https://github.com/pester/Pester" target="_blank" rel="noopener"
&gt;Pester&lt;/a&gt; which is a framework for running unit tests within PowerShell&lt;/p&gt;
&lt;p&gt;You will find some good blog posts about starting with Pester here&lt;/p&gt;
&lt;p&gt;So I created a function script file &lt;code&gt;Create-HyperVFromBase.ps1&lt;/code&gt; and a tests script file &lt;code&gt;Create-HyperVFromBase.tests.ps1&lt;/code&gt; as shown.&lt;/p&gt;</description></item><item><title>PowerShell Pester Testing for Parameter Validation</title><link>https://blog.robsewell.com/blog/powershell-pester-testing-for-parameter-validation/</link><pubDate>Sun, 31 Jan 2016 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/powershell-pester-testing-for-parameter-validation/</guid><description>&lt;p&gt;This error caught me out. I am putting this post here firstly to remind me if I do it again adn also to help others who may hit the same issue.&lt;/p&gt;
&lt;p&gt;Today I am rewriting a function to create a Hyper-V VM so that I can properly script the creation of my labs for demos and other things. I am doing this because I want to use DSC to create an availability group and want to be able to tear down and recreate the machines (but thats for another day)&lt;/p&gt;</description></item><item><title>Power Bi, PowerShell and SQL Agent Jobs</title><link>https://blog.robsewell.com/blog/power-bi-powershell-and-sql-agent-jobs/</link><pubDate>Mon, 28 Sep 2015 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/power-bi-powershell-and-sql-agent-jobs/</guid><description>&lt;p&gt;Continuing &lt;a class="link" href="https://blog.robsewell.com/tags/#dba-database" target="_blank" rel="noopener"
&gt;my series on using Power Bi with my DBA Database&lt;/a&gt; I am going to show in this post how I create the most useful daily report for DBAs - The SQL Agent Job report. &lt;a class="link" href="https://1drv.ms/f/s!Ah9eXQJC3wLIh8BKfjiXBs7g6m7hfw" target="_blank" rel="noopener"
&gt;You can get the scripts and reports here&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Please note this project became &lt;a class="link" href="http://dbareports.io" target="_blank" rel="noopener"
&gt;dbareports.io&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://sqldbawithabeard.com/wp-content/uploads/2015/09/ag1.jpg" target="_blank" rel="noopener"
&gt;&lt;img src="https://sqldbawithabeard.com/wp-content/uploads/2015/09/ag1.jpg?w=300"
loading="lazy"
alt="AG1"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;This gives a quick overview of the status of the Agent Jobs across the estate and also quickly identifies recent failed jobs enabling the DBA to understand their focus and prioritise their morning efforts.&lt;/p&gt;</description></item><item><title>Populating My DBA Database for Power Bi with PowerShell - Databases</title><link>https://blog.robsewell.com/blog/populating-my-dba-database-for-power-bi-with-powershell-databases/</link><pubDate>Tue, 22 Sep 2015 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/populating-my-dba-database-for-power-bi-with-powershell-databases/</guid><description>&lt;p&gt;Following my post about &lt;a class="link" href="https://blog.robsewell.com/sql%20server/using-power-bi-with-my-dba-database/" target="_blank" rel="noopener"
&gt;using Power Bi with my DBA Database&lt;/a&gt; I have been asked if I would share the PowerShell scripts which I use to populate my database.&lt;/p&gt;
&lt;p&gt;In this post I will show how to create the following report&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://sqldbawithabeard.com/wp-content/uploads/2015/09/db1.png" target="_blank" rel="noopener"
&gt;&lt;img src="https://sqldbawithabeard.com/wp-content/uploads/2015/09/db1.png?w=300"
loading="lazy"
alt="db1"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://sqldbawithabeard.com/wp-content/uploads/2015/09/db2.png" target="_blank" rel="noopener"
&gt;&lt;img src="https://sqldbawithabeard.com/wp-content/uploads/2015/09/db2.png?w=300"
loading="lazy"
alt="db2"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Although you will find so many items of data that I expect that you will want to create different reports for your own requirements. You will also want to put the report onto PowerBi.com and explore the natural language querying as I show at the end of this post&lt;/p&gt;</description></item><item><title>Enterprise Strategies - A #TSQL2sDay post</title><link>https://blog.robsewell.com/blog/enterprise-strategies-a-tsql2sday-post/</link><pubDate>Tue, 08 Sep 2015 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/enterprise-strategies-a-tsql2sday-post/</guid><description>&lt;p&gt;&lt;a class="link" href="http://www.midnightdba.com/Jen/2015/09/time-for-t-sql-tuesday-70/" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/images/TSQL2sDay150x150.jpg"
loading="lazy"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;This months TSQL2sDay blog post party is hosted by &lt;a class="link" href="http://www.midnightdba.com/Jen/2015/09/time-for-t-sql-tuesday-70/" target="_blank" rel="noopener"
&gt;Jen McCown&lt;/a&gt; and is about Enterprise Strategy.&lt;/p&gt;
&lt;p&gt;Adam Mechanic started &lt;a class="link" href="http://sqlblog.com/blogs/adam_machanic/archive/2009/11/30/invitation-to-participate-in-t-sql-tuesday-001-date-time-tricks.aspx" target="_blank" rel="noopener"
&gt;TSQL Tuesdays over 5 years ago&lt;/a&gt; and you will find many brilliant posts under that heading if &lt;a class="link" href="https://www.google.co.uk/#q=tsql2sday" target="_blank" rel="noopener"
&gt;you search for them&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Managing SQL servers at enterprise scale is not a straightforward task. Your aim as a DBA should be to simplify it as much as possible and to automate everything that you possibly can. &lt;a class="link" href="http://www.johnsansom.com/the-best-database-administrators-automate-everything/" target="_blank" rel="noopener"
&gt;This post by John Sansom&lt;/a&gt; could have been written for this months party and I recommend that you read it.&lt;/p&gt;</description></item><item><title>Populating My DBA Database for Power Bi with PowerShell - SQL Info</title><link>https://blog.robsewell.com/blog/populating-my-dba-database-for-power-bi-with-powershell-sql-info/</link><pubDate>Mon, 07 Sep 2015 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/populating-my-dba-database-for-power-bi-with-powershell-sql-info/</guid><description>&lt;p&gt;Following my post about &lt;a class="link" href="http://wp.me/p3aio8-gj" target="_blank" rel="noopener"
&gt;using Power Bi with my DBA Database&lt;/a&gt; I have been asked if I would share the PowerShell scripts which I use to populate my database.&lt;/p&gt;
&lt;p&gt;In this post I will show how to create the following report&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://sqldbawithabeard.com/wp-content/uploads/2015/09/1.png" target="_blank" rel="noopener"
&gt;&lt;img src="https://sqldbawithabeard.com/wp-content/uploads/2015/09/1.png?w=300"
loading="lazy"
alt="1"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://sqldbawithabeard.com/wp-content/uploads/2015/09/2.png" target="_blank" rel="noopener"
&gt;&lt;img src="https://sqldbawithabeard.com/wp-content/uploads/2015/09/2.png?w=300"
loading="lazy"
alt="2"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Although you will find so many items of data that I expect that you will want to create different reports for your own requirements. You will also want to put the report onto PowerBi.com and explore the natural language querying as I show at the end of this post&lt;/p&gt;</description></item><item><title>Use Twitter to get #PowerShell help</title><link>https://blog.robsewell.com/blog/use-twitter-to-get-%23powershell-help/</link><pubDate>Sun, 06 Sep 2015 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/use-twitter-to-get-%23powershell-help/</guid><description>&lt;p&gt;A quick post today just to add some weight to something that Mike Fal &lt;a class="link" href="http://www.mikefal.net/" target="_blank" rel="noopener"
&gt;b&lt;/a&gt; | &lt;a class="link" href="https://twitter.com/Mike_Fal" target="_blank" rel="noopener"
&gt;t&lt;/a&gt; has kicked off. The &lt;a class="link" href="https://twitter.com/hashtag/sqlhelp" target="_blank" rel="noopener"
&gt;#SQLHelp hashtag&lt;/a&gt; is well known and well used with in the SQL world. It is a fantastic resource and one that I recommend to all SQL folk I meet who are not aware of it. &lt;a class="link" href="https://www.brentozar.com/archive/2009/12/i-need-sqlhelp/" target="_blank" rel="noopener"
&gt;Heres how it started&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Mike has suggested that there should be a similar resource for PowerShell questions &lt;a class="link" href="https://twitter.com/search?q=%23PoShHelp" target="_blank" rel="noopener"
&gt;#PoSHHelp&lt;/a&gt;. We want to create a useful and positive place for people to go with their PowerShell queries and some good folks like Mike,  &lt;a class="link" href="http://t.co/NfvkfJXMjp" target="_blank" rel="noopener"
&gt;Shawn Melton&lt;/a&gt;(&lt;a class="link" href="https://twitter.com/wsmelton" target="_blank" rel="noopener"
&gt;@wsmelton&lt;/a&gt;), &lt;a class="link" href="http://t.co/K8jsx6WHcc" target="_blank" rel="noopener"
&gt;Adam Bertram&lt;/a&gt;(&lt;a class="link" href="https://twitter.com/adbertram" target="_blank" rel="noopener"
&gt;@adbertram&lt;/a&gt;), &lt;a class="link" href="http://t.co/U5LLtwWDPI" target="_blank" rel="noopener"
&gt;Derik Hammer&lt;/a&gt;(&lt;a class="link" href="https://twitter.com/SQLHammer" target="_blank" rel="noopener"
&gt;@SQLHammer&lt;/a&gt;), &lt;a class="link" href="http://learn-PowerShell.net/" target="_blank" rel="noopener"
&gt;Boe Prox&lt;/a&gt;(&lt;a class="link" href="https://twitter.com/proxb" target="_blank" rel="noopener"
&gt;@proxb&lt;/a&gt;), myself  and others will be looking for your PowerShell problems and try to assist you over Twitter with the same care and grace as Sqlhelp.&lt;/p&gt;</description></item><item><title>Populating My DBA Database for Power Bi with PowerShell - Server Info</title><link>https://blog.robsewell.com/blog/populating-my-dba-database-for-power-bi-with-powershell-server-info/</link><pubDate>Mon, 31 Aug 2015 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/populating-my-dba-database-for-power-bi-with-powershell-server-info/</guid><description>&lt;p&gt;Following my last post about &lt;a class="link" href="https://blog.robsewell.com/sql%20server/using-power-bi-with-my-dba-database/" target="_blank" rel="noopener"
&gt;using Power Bi with my DBA Database&lt;/a&gt; I have been asked if I would share the PowerShell scripts which I use to populate my database. They are the secondary part to my DBADatabase which I also use to automate the installation and upgrade of all of my DBA scripts as I started to blog about in this post &lt;a class="link" href="https://blog.robsewell.com/powershell/sql%20server/installing-and-upgrading-default-scripts-automation-part-one-introduction/" target="_blank" rel="noopener"
&gt;Installing and upgrading default scripts automation - part one - Introduction&lt;/a&gt; which is a series I will continue later.&lt;/p&gt;</description></item><item><title>Using Power Bi with my DBA Database</title><link>https://blog.robsewell.com/blog/using-power-bi-with-my-dba-database/</link><pubDate>Sun, 16 Aug 2015 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/using-power-bi-with-my-dba-database/</guid><description>&lt;p&gt;Every good DBA should have a DBA database. A place to store information about all of their instances and databases.&lt;/p&gt;
&lt;p&gt;I have an InstanceList table which looks like this&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-gdscript3" data-lang="gdscript3"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;CREATE&lt;/span&gt; &lt;span class="n"&gt;TABLE&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;dbo&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;InstanceList&lt;/span&gt;&lt;span class="p"&gt;](&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;InstanceID&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="ne"&gt;int&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="n"&gt;IDENTITY&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;NOT&lt;/span&gt; &lt;span class="n"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ServerName&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;nvarchar&lt;/span&gt;&lt;span class="p"&gt;](&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;NOT&lt;/span&gt; &lt;span class="n"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;InstanceName&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;nvarchar&lt;/span&gt;&lt;span class="p"&gt;](&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;NOT&lt;/span&gt; &lt;span class="n"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;Port&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="ne"&gt;int&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="n"&gt;NOT&lt;/span&gt; &lt;span class="n"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;AG&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="n"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;Inactive&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="n"&gt;NULL&lt;/span&gt; &lt;span class="n"&gt;CONSTRAINT&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;DF_InstanceList_Inactive&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="n"&gt;DEFAULT&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="ne"&gt;Environment&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;nvarchar&lt;/span&gt;&lt;span class="p"&gt;](&lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;Location&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;nvarchar&lt;/span&gt;&lt;span class="p"&gt;](&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;CONSTRAINT&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;PK_InstanceList_ID&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="n"&gt;PRIMARY&lt;/span&gt; &lt;span class="n"&gt;KEY&lt;/span&gt; &lt;span class="n"&gt;CLUSTERED&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;InstanceID&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="n"&gt;ASC&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;WITH&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PAD_INDEX&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;OFF&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;STATISTICS_NORECOMPUTE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;OFF&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;IGNORE_DUP_KEY&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;OFF&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ALLOW_ROW_LOCKS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ON&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ALLOW_PAGE_LOCKS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ON&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;ON&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;PRIMARY&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;ON&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;PRIMARY&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;I use this as the basis for all of my information gathering. By adding Server name, Instance Name , Port, Environment and Location to the table I use overnight Agent jobs to run PowerShell scripts to gather information about all of the instances. This way the information is dynamic and gathered from the server, so when we add RAM and change Max memory this is updated the next time the script runs. You can also automate your installation and decommission procedures (using PowerShell scripts) to add the information to the DBA database automatically&lt;/p&gt;</description></item><item><title>Setting Up and Using Azure VM SQL Automated Backup (and Restore)</title><link>https://blog.robsewell.com/blog/setting-up-and-using-azure-vm-sql-automated-backup-and-restore/</link><pubDate>Fri, 24 Jul 2015 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/setting-up-and-using-azure-vm-sql-automated-backup-and-restore/</guid><description>&lt;p&gt;This weekend I was creating some Azure VMs to test and was required to use the GUI for some screenshots. I have always used my PowerShell scripts &lt;a class="link" href="http://sqldbawithabeard.com/2013/05/14/spinning-up-and-shutting-down-windows-azure-lab-with-PowerShell/" target="_blank" rel="noopener"
&gt;described here&lt;/a&gt; to create my test systems and with a new job taking up a lot of my time had missed the &lt;a class="link" href="http://blogs.technet.com/b/dataplatforminsider/archive/2015/01/29/automated-backup-and-automated-patching-for-sql-server-in-azure-portal-and-PowerShell.aspx?WT.mc_id=DP-MVP-5002693" target="_blank" rel="noopener"
&gt;announcement about Azure SQL Automated Backup and Azure SQL Automated Patching&lt;/a&gt; so was surprised to see this screen&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://sqldbawithabeard.com/wp-content/uploads/2015/07/1.png" target="_blank" rel="noopener"
&gt;&lt;img src="https://sqldbawithabeard.com/wp-content/uploads/2015/07/1.png?w=300"
loading="lazy"
alt="1"
&gt;&lt;/a&gt;&lt;/p&gt;</description></item><item><title>Installing and upgrading default scripts automation - part one - Introduction</title><link>https://blog.robsewell.com/blog/installing-and-upgrading-default-scripts-automation-part-one-introduction/</link><pubDate>Mon, 08 Jun 2015 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/installing-and-upgrading-default-scripts-automation-part-one-introduction/</guid><description>&lt;p&gt;First I must say thank you to all of the wonderful people who have put time and effort into providing free tools and scripts to enable not only myself but all SQL DBAs to ease their work. For this series I especially thank&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Brent Ozar - &lt;a class="link" href="http://www.brentozar.com/" target="_blank" rel="noopener"
&gt;w&lt;/a&gt;|&lt;a class="link" href="https://twitter.com/BrentO" target="_blank" rel="noopener"
&gt;t&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Ola Hallengren - &lt;a class="link" href="https://ola.hallengren.com/" target="_blank" rel="noopener"
&gt;w&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Adam Mechanic - &lt;a class="link" href="http://sqlblog.com/blogs/adam_machanic/" target="_blank" rel="noopener"
&gt;b&lt;/a&gt;|&lt;a class="link" href="https://twitter.com/adammachanic" target="_blank" rel="noopener"
&gt;t&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Jared Zagelbaum - &lt;a class="link" href="https://jaredzagelbaum.wordpress.com/" target="_blank" rel="noopener"
&gt;b&lt;/a&gt;|&lt;a class="link" href="https://twitter.com/JaredZagelbaum" target="_blank" rel="noopener"
&gt;t&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The aim of this series is to share the methodology and the scripts that I have used to resolve this issue.&lt;/p&gt;</description></item><item><title>Scheduling Ola Hallengrens Maintenance Solution Default Jobs with PowerShell</title><link>https://blog.robsewell.com/blog/scheduling-ola-hallengrens-maintenance-solution-default-jobs-with-powershell/</link><pubDate>Wed, 06 May 2015 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/scheduling-ola-hallengrens-maintenance-solution-default-jobs-with-powershell/</guid><description>&lt;p&gt;If you are a SQL Server DBA you should know about Ola Hallengren and will probably have investigated his Maintenance Solution.&lt;/p&gt;
&lt;p&gt;If you haven&amp;rsquo;t please start here &lt;a class="link" href="https://ola.hallengren.com/" target="_blank" rel="noopener"
&gt;https://ola.hallengren.com/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;You can also watch his presentation at SQLBits at this link&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="http://sqlbits.com/Sessions/Event9/Inside_Ola_Hallengrens_Maintenance_Solution" target="_blank" rel="noopener"
&gt;http://sqlbits.com/Sessions/Event9/Inside_Ola_Hallengrens_Maintenance_Solution&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;where he talks about and demonstrates the solution.&lt;/p&gt;
&lt;p&gt;It is possible to just run his script to install the solution and schedule the jobs and know that you have made a good start in keeping your databases safe. You should be more proactive than that and set specific jobs for your own special requirements but you can and should find that information in other places including the FAQ on Ola&amp;rsquo;s site&lt;/p&gt;</description></item><item><title>Spinach and Database Development- SQLSatExeter Keynote</title><link>https://blog.robsewell.com/blog/spinach-and-database-development-sqlsatexeter-keynote/</link><pubDate>Thu, 30 Apr 2015 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/spinach-and-database-development-sqlsatexeter-keynote/</guid><description>&lt;p&gt;Last weekend, we held our SQL Saturday event in Exeter. It was a brilliant event for many reasons but we were delighted to have a world exclusive keynote video by Phil Factor about Spinach and Database Development. With many thanks to those that made it possible and particularly to Phil Factor I have linked to the video here and also transcribed it. Please watch and read and understand the message&lt;/p&gt;</description></item><item><title>Instances and Ports with PowerShell</title><link>https://blog.robsewell.com/blog/instances-and-ports-with-powershell/</link><pubDate>Wed, 22 Apr 2015 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/instances-and-ports-with-powershell/</guid><description>&lt;p&gt;Just a quick post and a day late for &lt;a class="link" href="https://twitter.com/hashtag/sqlnewblogger" target="_blank" rel="noopener"
&gt;#SQLNewBlogger&lt;/a&gt; There are some excellent posts on that hashtag and I recommend that you read them&lt;/p&gt;
&lt;p&gt;When you know a server name but not the name of the instances or the ports that they are using this function will be of use&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;span class="lnt"&gt;30
&lt;/span&gt;&lt;span class="lnt"&gt;31
&lt;/span&gt;&lt;span class="lnt"&gt;32
&lt;/span&gt;&lt;span class="lnt"&gt;33
&lt;/span&gt;&lt;span class="lnt"&gt;34
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&amp;lt;#
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;.SYNOPSIS
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Shows the Instances and the Port Numbers on a SQL Server
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;.DESCRIPTION
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;This function will show the Instances and the Port Numbers on a SQL Server using WMI
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;.PARAMETER Server
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;The Server Name
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;.EXAMPLE
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Get-SQLInstancesPort Fade2Black
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;This will display the instances and the port numbers on the server Fade2Black
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;.NOTES
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;AUTHOR: Rob Sewell sqldbawithabeard.com
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;DATE: 22/04/2015
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;#&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;function Get-SQLInstancesPort {
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; param ([string]$Server)
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; [system.reflection.assembly]::LoadWithPartialName(&amp;#34;Microsoft.SqlServer.Smo&amp;#34;)|Out-Null
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; [system.reflection.assembly]::LoadWithPartialName(&amp;#34;Microsoft.SqlServer.SqlWmiManagement&amp;#34;)|Out-Null
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; $mc = new-object Microsoft.SqlServer.Management.Smo.Wmi.ManagedComputer $Server
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; $Instances = $mc.ServerInstances
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; foreach ($Instance in $Instances) {
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; $port = @{Name = &amp;#34;Port&amp;#34;; Expression = {$_.ServerProtocols[&amp;#39;Tcp&amp;#39;].IPAddresses[&amp;#39;IPAll&amp;#39;].IPAddressProperties[&amp;#39;TcpPort&amp;#39;].Value}}
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; $Parent = @{Name = &amp;#34;Parent&amp;#34;; Expression = {$_.Parent.Name}}
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; $Instance|Select $Parent, Name, $Port
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description></item><item><title>Checking SQL Server User Role Membership with PowerShell</title><link>https://blog.robsewell.com/blog/checking-sql-server-user-role-membership-with-powershell/</link><pubDate>Tue, 14 Apr 2015 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/checking-sql-server-user-role-membership-with-powershell/</guid><description>&lt;p&gt;Please  go and check the New SQL Bloggers posting here &lt;a class="link" href="https://twitter.com/search?q=%23sqlnewblogger" title="https://twitter.com/search?q=%23sqlnewblogger"
target="_blank" rel="noopener"
&gt;https://twitter.com/search?q=%23sqlnewblogger&lt;/a&gt; There are some brilliant new and older bloggers adding great value to the SQL Community&lt;/p&gt;
&lt;p&gt;This is my most viewed post so I thought it made a good candidate to be updated and reblogged&lt;/p&gt;</description></item><item><title>PowerShelling SQL Saturday Sessions to the Guidebook app</title><link>https://blog.robsewell.com/blog/powershelling-sql-saturday-sessions-to-the-guidebook-app/</link><pubDate>Tue, 07 Apr 2015 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/powershelling-sql-saturday-sessions-to-the-guidebook-app/</guid><description>&lt;p&gt;Following on from my &lt;a class="link" href="http://sqldbawithabeard.com/2015/03/21/parsing-xml-child-nodes-and-converting-to-datetime-with-PowerShell/" title="Parsing XML Child Nodes and Converting to DateTime with PowerShell"
target="_blank" rel="noopener"
&gt;previous pos&lt;/a&gt;t about parsing XML where I used the information from &lt;a class="link" href="https://voiceofthedba.wordpress.com/2015/01/26/downloading-sql-saturday-data/" target="_blank" rel="noopener"
&gt;Steve Jones blog post&lt;/a&gt; to get information from the &lt;a class="link" href="https://www.sqlsaturday.com/" target="_blank" rel="noopener"
&gt;SQL Saturday web site&lt;/a&gt; I thought that this information and script may be useful for others performing the same task.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Edit - This post was written prior to the updates to the SQL Saturday website over the weekend. When it can back up the script worked perfectly but the website is unavailable at the moment again so I will check and update as needed once it is back.&lt;/p&gt;</description></item><item><title>Parsing XML Child Nodes and Converting to DateTime with PowerShell</title><link>https://blog.robsewell.com/blog/parsing-xml-child-nodes-and-converting-to-datetime-with-powershell/</link><pubDate>Sat, 21 Mar 2015 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/parsing-xml-child-nodes-and-converting-to-datetime-with-powershell/</guid><description>&lt;p&gt;As part of my organiser role for SQLSaturday Exeter (&lt;a class="link" href="http://sqlsatexeter.azurewebsites.net" target="_blank" rel="noopener"
&gt;Training Day Information here&lt;/a&gt; and &lt;a class="link" href="https://www.sqlsaturday.com/372/" target="_blank" rel="noopener"
&gt;Saturday Information here&lt;/a&gt;) I needed to get some schedule information to input into a database.&lt;/p&gt;
&lt;p&gt;I had read &lt;a class="link" href="https://voiceofthedba.wordpress.com/2015/01/26/downloading-sql-saturday-data/" target="_blank" rel="noopener"
&gt;Steve Jones blog posts on Downloading SQL Saturday Data&lt;/a&gt; and followed the steps there to download the data from the SQL Saturday website for our event.&lt;/p&gt;
&lt;p&gt;A typical session is held in the XML like this&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&amp;lt;event&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &amp;lt;importID&amp;gt;27608&amp;lt;/importID&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &amp;lt;speakers&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &amp;lt;speaker&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &amp;lt;id&amp;gt;27608&amp;lt;/id&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &amp;lt;name&amp;gt;William Durkin&amp;lt;/name&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &amp;lt;/speaker&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &amp;lt;/speakers&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &amp;lt;track&amp;gt;Track 2&amp;lt;/track&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &amp;lt;location&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &amp;lt;name&amp;gt;Buccaneer&amp;#39;s Refuge &amp;lt;/name&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &amp;lt;/location&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &amp;lt;title&amp;gt;Stories from the Trenches: Upgrading SQL with Minimal Downtime&amp;lt;/title&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &amp;lt;description&amp;gt;SQL Server has come a long way in the last few years, with Microsoft investing heavily in High Availability features. This session will show you how to use these features to enable you to safely upgrade a SQL Server, while ensuring you have a return path if things should go wrong. You will leave the session knowing what features you can use to upgrade either the OS, Hardware or SQL Server version while keeping your maintenance window to a minimum. The session will apply to Standard Edition as well as Enterprise Edition, so doesn&amp;#39;t only apply to &amp;#39;High Rollers&amp;#39;!&amp;lt;/description&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &amp;lt;startTime&amp;gt;4/25/2015 3:20:00 PM&amp;lt;/startTime&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &amp;lt;endTime&amp;gt;4/25/2015 4:10:00 PM&amp;lt;/endTime&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&amp;lt;/event&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt; &lt;/p&gt;</description></item><item><title>Speaking at PowerShell Virtual Chapter and SQL Cardiff User Group this month</title><link>https://blog.robsewell.com/blog/speaking-at-powershell-virtual-chapter-and-sql-cardiff-user-group-this-month/</link><pubDate>Tue, 17 Mar 2015 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/speaking-at-powershell-virtual-chapter-and-sql-cardiff-user-group-this-month/</guid><description>&lt;p&gt;Just a quick post to say that I will be speaking at the PowerShell Virtual Chapter meeting this Thursday at 4pm GMT 12pm EDT and also at the Cardiff SQL User Group on Tuesday 31st March&lt;/p&gt;
&lt;p&gt;I will be giving my Making PowerShell Useful for your Team presentation&lt;/p&gt;
&lt;p&gt;You have heard about PowerShell and may be spent a little bit of time exploring some of the ways in which it will benefit you at work. You want to be able to perform tasks more specific to your organisation and need to share them with your team. I will show you how you can achieve this by demonstrating&lt;/p&gt;</description></item><item><title>Triggering a System Center Configuration Manager deployment task</title><link>https://blog.robsewell.com/blog/triggering-a-system-center-configuration-manager-deployment-task/</link><pubDate>Wed, 18 Feb 2015 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/triggering-a-system-center-configuration-manager-deployment-task/</guid><description>&lt;p&gt;A slightly different topic today.&lt;/p&gt;
&lt;p&gt;Once you have built up knowledge, you become the person that people ask to solve things. This is something I really enjoy, taking a problem and solving it for people and in the process teaching them and enabling them to automate more things.&lt;/p&gt;
&lt;p&gt;A colleague was performing a new deployment of a product via SCCM and wanted to trigger the clients to update and receive the new update instead of waiting for it to be scheduled.&lt;/p&gt;</description></item><item><title>Show AutoGrowth Events with PowerShell to CSV</title><link>https://blog.robsewell.com/blog/show-autogrowth-events-with-powershell-to-csv/</link><pubDate>Sun, 15 Feb 2015 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/show-autogrowth-events-with-powershell-to-csv/</guid><description>&lt;p&gt;This week I was reading Pinal Daves post about Autogrowth Events&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="http://blog.sqlauthority.com/2015/02/03/sql-server-script-whenwho-did-auto-grow-for-the-database/" target="_blank" rel="noopener"
&gt;http://blog.sqlauthority.com/2015/02/03/sql-server-script-whenwho-did-auto-grow-for-the-database/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;as it happened I had a requirement to make use of the script only a few days later. I was asked to provide the information in a CSV so that the person who required the information could manipulate it in Excel.&lt;/p&gt;
&lt;p&gt;I am a great believer in Automation. If you are going to do something more than once then automate it so I wrote two functions, added them to TFS and now they will be available to all of my team members next time they load PowerShell.&lt;/p&gt;</description></item><item><title>Uploading a Source Folder to Azure File Storage</title><link>https://blog.robsewell.com/blog/uploading-a-source-folder-to-azure-file-storage/</link><pubDate>Sun, 01 Feb 2015 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/uploading-a-source-folder-to-azure-file-storage/</guid><description>&lt;p&gt;Azure File Storage enables you to present an Azure Storage Account to your IaaS VMs as a share using SMB. You can fid out further details here&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="http://azure.microsoft.com/en-gb/documentation/articles/storage-dotnet-how-to-use-files/%c2%a0" title="http://azure.microsoft.com/en-gb/documentation/articles/storage-dotnet-how-to-use-files/ "
target="_blank" rel="noopener"
&gt;http://azure.microsoft.com/en-gb/documentation/articles/storage-dotnet-how-to-use-files/&lt;/a&gt; &lt;/p&gt;
&lt;p&gt;Once you have created your Azure File Storage Account and connected your Azure Virtual Machines to it, you may need to upload data from your premises into the storage to enable it to be accessed by the Virtual Machines&lt;/p&gt;
&lt;p&gt;To accomplish this I wrote a function and called it Upload-ToAzureFileStorage&lt;/p&gt;</description></item><item><title>Twas 2 Days Before Xmas or Thank you SQLFamily</title><link>https://blog.robsewell.com/blog/twas-2-days-before-xmas-or-thank-you-sqlfamily/</link><pubDate>Tue, 23 Dec 2014 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/twas-2-days-before-xmas-or-thank-you-sqlfamily/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2014/12/beard.png" alt="Featured image of post Twas 2 Days Before Xmas or Thank you SQLFamily" /&gt;&lt;p&gt;Twas 2 days before Xmas &amp;amp; all through the office,&lt;br&gt;
not a creature was stirring not even old Maurice.&lt;br&gt;
With merriment going on outside of his window&lt;br&gt;
There sat a bearded DBA without much to do&lt;/p&gt;
&lt;p&gt;No changes can be made through the holiday season&lt;br&gt;
We’re on skeleton support, which is a good reason&lt;br&gt;
Ensure you are making the most of your time&lt;br&gt;
You mustn’t be wasting the company dime&lt;/p&gt;</description></item><item><title>Giving Back – #TSQL2sday</title><link>https://blog.robsewell.com/blog/giving-back-tsql2sday/</link><pubDate>Tue, 09 Dec 2014 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/giving-back-tsql2sday/</guid><description>&lt;p&gt;&lt;img src="https://i0.wp.com/blog.waynesheffield.com/wayne/wp-content/uploads/2012/04/TSQL2sDay150x150.jpg"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;T-SQL Tuesday, which was started by Adam Machanic (&lt;a class="link" href="http://sqlblog.com/blogs/adam_machanic/" target="_blank" rel="noopener"
&gt;blog&lt;/a&gt;|&lt;a class="link" href="http://twitter.com/adammachanic" target="_blank" rel="noopener"
&gt;twitter&lt;/a&gt;) and is now starting its 6th year, is hosted by a different person each month. The host selects the theme, and then the blogging begins. Worldwide, on the second Tuesday of the month (all day, based on GMT time), bloggers attend this party by blogging about the theme. This month it is hosted by Wayne Sheffield &lt;a class="link" href="http://blog.waynesheffield.com/wayne/archive/2014/12/t-sql-tuesday-61-giving-back/" target="_blank" rel="noopener"
&gt;blog&lt;/a&gt;|&lt;a class="link" href="http://www.twitter.com/#/DBAWayne" target="_blank" rel="noopener"
&gt;twitter&lt;/a&gt; and in the spirit of the holiday season it is about giving. This is my post on giving back, in the little ways as well as the bigger ones, how you can give back and why it not only benefits others but also yourself&lt;/p&gt;</description></item><item><title>Making a Change Log Easier With PowerShell</title><link>https://blog.robsewell.com/blog/making-a-change-log-easier-with-powershell/</link><pubDate>Mon, 08 Dec 2014 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/making-a-change-log-easier-with-powershell/</guid><description>&lt;p&gt;Having a Change Log is a good thing. A quick and simple place to find out what has changed on a server and when. This can be invaluable when troubleshooting, matching a change to a symptom especially when assessed alongside your performance counter collection. Here is a simple way to make use of a change log and automate it&lt;/p&gt;
&lt;p&gt;Create a simple table&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;USE [MDW]
GO
CREATE TABLE [dbo].[ChangeLog](
[ChangeID] [int] IDENTITY(1,1) PRIMARY KEY ,
[Date] [datetime] NOT NULL,
[Server] [varchar](50) NOT NULL,
[UserName] [nvarchar](50) NOT NULL,
[Change] [nvarchar](max) NOT NULL,
)
GO
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You can keep this on a central server or create a database on each server, whichever fits your needs best. You can add other columns if you want your information in a different format&lt;/p&gt;</description></item><item><title>A look at the SQL Assessment Intelligence Pack in Operational Insights</title><link>https://blog.robsewell.com/blog/a-look-at-the-sql-assessment-intelligence-pack-in-operational-insights/</link><pubDate>Mon, 24 Nov 2014 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/a-look-at-the-sql-assessment-intelligence-pack-in-operational-insights/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2014/11/opsman1.jpg" alt="Featured image of post A look at the SQL Assessment Intelligence Pack in Operational Insights" /&gt;&lt;p&gt;Operational Insights is a service that has been added in preview to Azure. It enables you to collect, combine, correlate and visualize all your machine data in one place. It can collect data from all of your machines either via SCOM or by using an agent. Once the data is collected Operational Insights has a number of Intelligence Packs which have pre-configured rules and algorithms to provide analysis in various areas including for SQL Server&lt;/p&gt;</description></item><item><title>Changing Delay Between Responses for SQL Alerts with Powershell</title><link>https://blog.robsewell.com/blog/changing-delay-between-responses-for-sql-alerts-with-powershell/</link><pubDate>Tue, 18 Nov 2014 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/changing-delay-between-responses-for-sql-alerts-with-powershell/</guid><description>&lt;p&gt;So you have read that you should have alerts for severity levels 16 to 24 and 823,824 and 825 on &lt;a class="link" href="http://www.sqlskills.com/blogs/glenn/the-accidental-dba-day-17-of-30-configuring-alerts-for-high-severity-problems/" target="_blank" rel="noopener"
&gt;SQLSkills.com&lt;/a&gt; or maybe you have used &lt;a class="link" href="http://www.brentozar.com/blitz/" target="_blank" rel="noopener"
&gt;sp_blitz&lt;/a&gt; and received the &lt;a class="link" href="http://www.brentozar.com/blitz/configure-sql-server-alerts/" target="_blank" rel="noopener"
&gt;Blitz Result: No SQL Server Agent Alerts Configured&lt;/a&gt; and like a good and conscientious DBA you have set them up.&lt;/p&gt;
&lt;p&gt;Hopefully you also have &lt;a class="link" href="https://www.simple-talk.com/blogs/author/13359-jonathan-allen/" target="_blank" rel="noopener"
&gt;Jonathan Allens blog&lt;/a&gt; on your feed and if you look at his historical posts and seen this one where &lt;a class="link" href="https://www.simple-talk.com/blogs/2011/06/27/alerts-are-good-arent-they/" target="_blank" rel="noopener"
&gt;lack of a delay in response broke the Exchange Server!&lt;/a&gt;&lt;/p&gt;</description></item><item><title>#tsql2sday #60 – Something New Learned – Problem Step Recorder</title><link>https://blog.robsewell.com/blog/tsql2sday-60-something-new-learned-problem-step-recorder/</link><pubDate>Tue, 11 Nov 2014 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/tsql2sday-60-something-new-learned-problem-step-recorder/</guid><description>&lt;h3 id="what-is-t-sql-tuesday"&gt;What is T-SQL Tuesday?
&lt;/h3&gt;&lt;p&gt;&lt;a class="link" href="http://chrisyatessql.wordpress.com/2014/11/05/t-sql-tuesday-60-something-new-learned/" target="_blank" rel="noopener"
&gt;&lt;img src="https://chrisyatessql.files.wordpress.com/2012/10/sql-tuesday1.jpg"
loading="lazy"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;T-SQL Tuesday is a monthly blog party hosted by a different blogger each month. This blog party was started by Adam Machanic (&lt;a class="link" href="http://sqlblog.com/blogs/adam_machanic/" target="_blank" rel="noopener"
&gt;blog&lt;/a&gt;|&lt;a class="link" href="http://twitter.com/adammachanic" target="_blank" rel="noopener"
&gt;twitter&lt;/a&gt;). You can take part by posting your own participating post that fits the topic of the month and follows the requirements Additionally, if you are interested in hosting a future T-SQL Tuesday, contact Adam Machanic on his blog.&lt;/p&gt;</description></item><item><title>Generating T-SQL Randomly with Powershell</title><link>https://blog.robsewell.com/blog/generating-t-sql-randomly-with-powershell/</link><pubDate>Wed, 05 Nov 2014 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/generating-t-sql-randomly-with-powershell/</guid><description>&lt;p&gt;I have a lab on my laptop running various servers so that I can problem solve and learn and recently I wanted to add several months of data into a database. I had created a stored procedure to take some parameters perform some logic and insert the data.&lt;/p&gt;
&lt;p&gt;To execute the stored procedure in T-SQL I simply run this&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;EXECUTE [dbo].[usp_Insert_DriveSpace] 'Server1','C','2014-11-05','100','25'
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;which uses the server name, drive letter, date, capacity and free space to add the data&lt;/p&gt;</description></item><item><title>Emailing Disk Space Alerting With Powershell</title><link>https://blog.robsewell.com/blog/emailing-disk-space-alerting-with-powershell/</link><pubDate>Tue, 04 Nov 2014 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/emailing-disk-space-alerting-with-powershell/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2014/11/image_thumb.png" alt="Featured image of post Emailing Disk Space Alerting With Powershell" /&gt;&lt;p&gt;A DBA doesn’t want to run out of space on their servers, even in their labs! To avoid this happening I wrote a Powershell script to provide some alerts by email.&lt;/p&gt;
&lt;p&gt;This is the script and how I worked my way through the solution. I hope it is of benefit to others.&lt;/p&gt;
&lt;p&gt;The script works in the following way&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Iterates through a list of servers&lt;/li&gt;
&lt;li&gt;Runs a WMI query to gather disk information&lt;/li&gt;
&lt;li&gt;If the free space has fallen below a threshold, checks to see if it has emailed before and if not emails a warning&lt;/li&gt;
&lt;li&gt;Resets if free space has risen above the threshold&lt;/li&gt;
&lt;li&gt;Logs what it does but manages the space the logs use&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;As you will have seen before I use a Servers text file in my scripts. This is a text file with a single server name on each line. You could also use a query against a DBA or MDW database using Invoke-SQLCMD2, which ever is the most suitable for you.&lt;/p&gt;</description></item><item><title>Number of VLFs and Autogrowth Settings Colour Coded to Excel with PowerShell</title><link>https://blog.robsewell.com/blog/number-of-vlfs-and-autogrowth-settings-colour-coded-to-excel-with-powershell/</link><pubDate>Mon, 06 Oct 2014 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/number-of-vlfs-and-autogrowth-settings-colour-coded-to-excel-with-powershell/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2014/10/image_thumb.png" alt="Featured image of post Number of VLFs and Autogrowth Settings Colour Coded to Excel with PowerShell" /&gt;&lt;p&gt;So you have read up on VLFs&lt;/p&gt;
&lt;p&gt;No doubt you will have read &lt;a class="link" href="http://www.sqlskills.com/blogs/kimberly/transaction-log-vlfs-too-many-or-too-few/" target="_blank" rel="noopener"
&gt;this post by Kimberly Tripp&lt;/a&gt; and this &lt;a class="link" href="http://www.sqlskills.com/blogs/kimberly/8-steps-to-better-transaction-log-throughput/" target="_blank" rel="noopener"
&gt;one&lt;/a&gt; and maybe &lt;a class="link" href="https://www.simple-talk.com/sql/database-administration/sql-server-transaction-log-fragmentation-a-primer/" target="_blank" rel="noopener"
&gt;this one too&lt;/a&gt; and you want to identify the databases in your environment which have a large number of VLFs and also the initial size and the autogrowth settings of the log files.&lt;/p&gt;
&lt;p&gt;There are several posts about this and doing this with PowerShell &lt;a class="link" href="https://www.simple-talk.com/sql/database-administration/monitoring-sql-server-virtual-log-file-fragmentation/" target="_blank" rel="noopener"
&gt;like this one&lt;/a&gt; or &lt;a class="link" href="http://www.youdidwhatwithtsql.com/audit-vlfs-on-your-sql-server/1358/" target="_blank" rel="noopener"
&gt;this one&lt;/a&gt;. As is my wont I chose to output to Excel and colour code the cells depending on the number of VLFs or the type of Autogrowth.&lt;/p&gt;</description></item><item><title>PowerShell Snippets A Great Learning Tool</title><link>https://blog.robsewell.com/blog/powershell-snippets-a-great-learning-tool/</link><pubDate>Tue, 09 Sep 2014 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/powershell-snippets-a-great-learning-tool/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2014/09/image9.png" alt="Featured image of post PowerShell Snippets A Great Learning Tool" /&gt;&lt;p&gt;When I talk to people about Powershell they often ask how can they easily learn the syntax. Here’s a good tip&lt;/p&gt;
&lt;p&gt;Open PowerShell ISE and press CTRL + J&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/assets/uploads/2014/09/image9.png" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2014/09/image_thumb9.png"
loading="lazy"
alt="image"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;You will find a number of snippets that will enable you to write your scripts easily.  Johnathan Medd PowerShell MVP has written a good post about snippets on the &lt;a class="link" href="http://blogs.technet.com/b/heyscriptingguy/archive/2014/01/25/using-powershell-ise-snippets-to-remember-tricky-syntax.aspx" target="_blank" rel="noopener"
&gt;Hey, Scripting Guy! blog&lt;/a&gt; so I will not repeat that but suggest that you go and read that post. It will show you how quickly and easily you will be able to write more complex Powershell scripts as you do not have to learn the syntax but can use the snippets to insert all the code samples you require.&lt;/p&gt;</description></item><item><title>Find Out Which Indexes are on which Filegroups using PowerShell And How To Find Other Information</title><link>https://blog.robsewell.com/blog/find-out-which-indexes-are-on-which-filegroups-using-powershell-and-how-to-find-other-information/</link><pubDate>Sun, 07 Sep 2014 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/find-out-which-indexes-are-on-which-filegroups-using-powershell-and-how-to-find-other-information/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2014/09/image8.png" alt="Featured image of post Find Out Which Indexes are on which Filegroups using PowerShell And How To Find Other Information" /&gt;&lt;p&gt;A short post today to pass on a script I wrote to fulfil a requirement I had.&lt;/p&gt;
&lt;p&gt;Which indexes are on which filegroups. I found a blog post showing how to &lt;a class="link" href="http://basitaalishan.com/2013/03/03/list-all-objects-and-indexes-per-filegroup-partition/" target="_blank" rel="noopener"
&gt;do it with T-SQL&lt;/a&gt; but as is my wont I decided to see how easy it would be with PowerShell. I also thought that it would make a good post to show how I approach this sort of challenge.&lt;/p&gt;</description></item><item><title>Refreshing Availability Group Database with PowerShell</title><link>https://blog.robsewell.com/blog/refreshing-availability-group-database-with-powershell/</link><pubDate>Thu, 04 Sep 2014 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/refreshing-availability-group-database-with-powershell/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2014/09/image1.png" alt="Featured image of post Refreshing Availability Group Database with PowerShell" /&gt;&lt;p&gt;Following last weeks post on &lt;a class="link" href="https://blog.robsewell.com/refreshing-a-sql-mirrored-database-using-powershell-2/" target="_blank" rel="noopener"
&gt;Refreshing A Mirrored Database with PowerShell&lt;/a&gt; I thought I would write the script to refresh an Availability Group Database.&lt;/p&gt;
&lt;p&gt;An availability group supports a failover environment for a discrete set of user databases, known as availability databases, that fail over together. An availability group supports a set of primary databases and one to eight sets of corresponding secondary databases.You can read more about Availability groups &lt;a class="link" href="http://msdn.microsoft.com/en-GB/library/ff877884.aspx?WT.mc_id=DP-MVP-5002693" target="_blank" rel="noopener"
&gt;here&lt;/a&gt;&lt;/p&gt;</description></item><item><title>Refreshing A SQL Mirrored Database Using Powershell</title><link>https://blog.robsewell.com/blog/refreshing-a-sql-mirrored-database-using-powershell/</link><pubDate>Mon, 25 Aug 2014 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/refreshing-a-sql-mirrored-database-using-powershell/</guid><description>&lt;p&gt;SQL mirroring is a means of providing high availability for your SQL database. It is available in Standard Edition and although the feature is deprecated it is still widely utilised. &lt;a class="link" href="http://msdn.microsoft.com/en-gb/library/ms189852.aspx?WT.mc_id=DP-MVP-5002693" target="_blank" rel="noopener"
&gt;You can read more about it on MSDN here&lt;/a&gt; and &lt;a class="link" href="http://www.brentozar.com/archive/2013/07/database-mirroring-faq/" target="_blank" rel="noopener"
&gt;Jes Borland wrote a useful post answering many questions here&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;There are situations where you may need to refresh these databases. Disaster Recovery is an obvious one but also during development to provide testing or development environments to test your High Availability implementations, run through disaster scenarios, create run books or ensure that the code changes still work with mirroring. There are other scenarios but this post covers the automation of restoring a mirrored database from a backup.&lt;/p&gt;</description></item><item><title>Enable CLR with Powershell</title><link>https://blog.robsewell.com/blog/enable-clr-with-powershell/</link><pubDate>Mon, 05 May 2014 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/enable-clr-with-powershell/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2014/05/050514_0904_enableclrwi2.png" alt="Featured image of post Enable CLR with Powershell" /&gt;&lt;p&gt;I had an email last night from someone who attended my PowerShell Box of Tricks session at &lt;a class="link" href="http://sqlsouthwest.co.uk/sqlsat269/" target="_blank" rel="noopener"
&gt;SQL Saturday Exeter&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;He was getting an error whilst trying to set CLR Enabled during an automatic install and asked if I had any ideas. The error he had was related to Invoke-SQLcmd and the method he was calling the PowerShell script&lt;/p&gt;
&lt;p&gt;I was unable to replicate his problem on my servers so I looked at other methods that may assist as well as following up with him to try and understand what was causing his issue. In doing so I worked out the following method to change the CLR Enabled setting by SMO and thought it worth a blog post to share&lt;/p&gt;</description></item><item><title>Listing the SQL Server SysAdmins With PowerShell</title><link>https://blog.robsewell.com/blog/listing-the-sql-server-sysadmins-with-powershell/</link><pubDate>Mon, 14 Apr 2014 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/listing-the-sql-server-sysadmins-with-powershell/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2014/04/2014-04-12_152433.jpg" alt="Featured image of post Listing the SQL Server SysAdmins With PowerShell" /&gt;&lt;p&gt;A very short blog today just to pass on this little script.&lt;/p&gt;
&lt;p&gt;I was required to list all of the SysAdmins across a large estate. Obviously I turned to PowerShell 🙂&lt;/p&gt;
&lt;p&gt;I iterated through my server list collection and then created a server SMO object and used the EnumServerRoleMembers method to display all of the sysadmin members&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/assets/uploads/2014/04/2014-04-12_152433.jpg" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2014/04/2014-04-12_152433.jpg"
loading="lazy"
alt="2014-04-12_152433"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;This will work on SQL2000 – SQL2012. You can see how you can easily change the rolename in the script to enumerate other server roles.&lt;/p&gt;</description></item><item><title>How I Check Hundreds of SQL Agent Jobs in 60 Seconds with Powershell</title><link>https://blog.robsewell.com/blog/how-i-check-hundreds-of-sql-agent-jobs-in-60-seconds-with-powershell/</link><pubDate>Mon, 31 Mar 2014 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/how-i-check-hundreds-of-sql-agent-jobs-in-60-seconds-with-powershell/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2014/03/033114_2017_howicheckhu6.png" alt="Featured image of post How I Check Hundreds of SQL Agent Jobs in 60 Seconds with Powershell" /&gt;&lt;h2 id="editors-note"&gt;Editors Note
&lt;/h2&gt;&lt;p&gt;This is still all valid but nowadays you would be much better off using dbatools to gather the information and the ImportExcel module to add it to an Excel sheet :-)&lt;/p&gt;
&lt;h1 id="original-post"&gt;Original Post
&lt;/h1&gt;&lt;p&gt;Checking that your Agent Jobs have completed successfully is a vital part of any DBA’s responsibility. It is essential to ensure that all of the hard work you have put into setting up the jobs can be quickly and easily checked. In a large estate this can be very time consuming and if done manually prone to human error. I have repeatedly mentioned &lt;!-- raw HTML omitted --&gt;John Sansoms Blog Post entitled “The Best DBAs Automate Everything” &lt;!-- raw HTML omitted --&gt;and I follow that advice. Today I will share with you one fo the first scripts that I wrote.&lt;/p&gt;</description></item><item><title>Rationalisation of Database with Powershell and T-SQL part two</title><link>https://blog.robsewell.com/blog/rationalisation-of-database-with-powershell-and-t-sql-part-two/</link><pubDate>Mon, 03 Mar 2014 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/rationalisation-of-database-with-powershell-and-t-sql-part-two/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2014/03/030314_2100_rationalisa1.png" alt="Featured image of post Rationalisation of Database with Powershell and T-SQL part two" /&gt;&lt;p&gt;In the &lt;a class="link" href="https://blog.robsewell.com/rationalisation-of-database-with-powershell-and-t-sql-part-one/" target="_blank" rel="noopener"
&gt;previous post&lt;/a&gt; I showed the script to create an Excel Workbook, colour coded showing the last used date for all of the databases on servers in my sqlservers.txt file. After gathering that information over several months, there is then a requirement for someone to make a decision as to which databases can be removed.&lt;/p&gt;
&lt;p&gt;Obviously there will be some databases that are read-only or if not set specifically as read-only may only be used for reference without data being added. You should hopefully have knowledge of these databases and be able to take them off the list quickly.&lt;/p&gt;</description></item><item><title>Rationalisation of Database with Powershell and T-SQL part one</title><link>https://blog.robsewell.com/blog/rationalisation-of-database-with-powershell-and-t-sql-part-one/</link><pubDate>Tue, 25 Feb 2014 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/rationalisation-of-database-with-powershell-and-t-sql-part-one/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2014/02/usage-excel.jpg" alt="Featured image of post Rationalisation of Database with Powershell and T-SQL part one" /&gt;&lt;p&gt;I have recently been involved in a project to rationalise databases. It is easy in a large organisation for database numbers to rapidly increase and sometimes the DBA may not be aware of or be able to control the rise if they don’t have knowledge of all of the database servers on the estate.&lt;/p&gt;
&lt;p&gt;There are lots of benefits of rationalisation to the business. Reduced cpu usage = reduced heat released = lower air-con bill for the server room and less storage used = quicker backups and less tapes used or better still less requirement for that expensive new SAN. You may be able to consolidate data and provide one version of the truth for the business as well. Removing servers can release licensing costs which could then be diverted elsewhere or pay for other improvements.&lt;/p&gt;</description></item><item><title>Why You Should Visit the Sponsors at #SQLSatExeter and Other Community Events</title><link>https://blog.robsewell.com/blog/why-you-should-visit-the-sponsors-at-%23sqlsatexeter-and-other-community-events/</link><pubDate>Mon, 10 Feb 2014 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/why-you-should-visit-the-sponsors-at-%23sqlsatexeter-and-other-community-events/</guid><description>&lt;p&gt;SQL Saturdays and other community events rely on sponsors and you know that you will often get entered into a raffle for a prize in exchange for your contact details and there will be freebies of various types from many vendors but there is more that you can get from visiting the sponsors.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;FREE COFFEE&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;At &lt;a class="link" href="http://www.sqlsaturday.com/269/" target="_blank" rel="noopener"
&gt;SQL Saturday Exeter on the 22nd March 2014&lt;/a&gt;  we are putting free coffee amongst the sponsors. Yes, it’s a ruse in some ways to put you in the same room as the sponsors whilst your mind is buzzing with all the new SQL learning you have been doing and you are feeling confident and inspired about SQL and what you can achieve.&lt;/p&gt;</description></item><item><title>Viewing SQL Endpoint Permissions with PowerShell</title><link>https://blog.robsewell.com/blog/viewing-sql-endpoint-permissions-with-powershell/</link><pubDate>Sun, 09 Feb 2014 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/viewing-sql-endpoint-permissions-with-powershell/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2014/02/ps1.jpg" alt="Featured image of post Viewing SQL Endpoint Permissions with PowerShell" /&gt;&lt;p&gt;A quick and simple post today as I have been very busy. I needed to list the users with permissions on mirroring endpoints today so I wrote this script and figured it was worth sharing.&lt;/p&gt;
&lt;p&gt;It’s a simple script which takes a server name from a Read-Host prompt. Displays the available endpoints and asks which one you want and shows you the permissions&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$Server = Read-Host &amp;quot;Please Enter the Server&amp;quot;
$Endpoints = $srv.Endpoints |select Name -ExpandProperty Name
$EndpointName = Read-Host &amp;quot;Please Enter the Endpoint Name `n Available Names are `n $Endpoints&amp;quot;
$srv = New-Object ('Microsoft.SqlServer.Management.Smo.Server') $server
$Endpoint = $srv.Endpoints[$EndpointName]
$Endpoint.enumObjectPermissions()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and heres a screenshot of the results&lt;/p&gt;</description></item><item><title>Using PowerShell to get Azure Endpoint Ports</title><link>https://blog.robsewell.com/blog/using-powershell-to-get-azure-endpoint-ports/</link><pubDate>Mon, 02 Dec 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/using-powershell-to-get-azure-endpoint-ports/</guid><description>&lt;p&gt;A quick blog today. I was reading &lt;a class="link" href="http://www.mssqltips.com/sqlservertip/3076/how-to-read-the-sql-server-database-transaction-log/" target="_blank" rel="noopener"
&gt;this blog post about How to read the SQL Error Log&lt;/a&gt; and I thought I would try some of the examples. I started my Azure VM using &lt;a class="link" href="https://blog.robsewell.com/?p=534" target="_blank" rel="noopener"
&gt;the steps in my previous post&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I ran&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Get-AzureVM -ServiceName TheBestBeard -Name Fade2black
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and then&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; Get-AzureVM -ServiceName TheBestBeard -Name Fade2black|Get-AzureEndpoint |Format-Table -AutoSize
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and bingo I had my SQL Port to put in SSMS and can go and play some more with SQL&lt;/p&gt;</description></item><item><title>Dropping All Tables From A SQL Database with PowerShell</title><link>https://blog.robsewell.com/blog/dropping-all-tables-from-a-sql-database-with-powershell/</link><pubDate>Sat, 30 Nov 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/dropping-all-tables-from-a-sql-database-with-powershell/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2013/11/image7.png" alt="Featured image of post Dropping All Tables From A SQL Database with PowerShell" /&gt;&lt;p&gt;This post could also have been titled confusion with &lt;code&gt;foreach&lt;/code&gt; or &lt;code&gt;For-EachObject&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;The scenario – Having created a blank database a number of users and permissions for an external consultant to create a test database for an application I got a phone call.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Please can you drop all the tables from the database as we need to re-run the installer with some different parameters&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Sure, I thought. No problem. I will use PowerShell. A simple script is all I need&lt;/p&gt;</description></item><item><title>Starting My Azure SQL Server VMs with PowerShell</title><link>https://blog.robsewell.com/blog/starting-my-azure-sql-server-vms-with-powershell/</link><pubDate>Wed, 27 Nov 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/starting-my-azure-sql-server-vms-with-powershell/</guid><description>&lt;p&gt;The last post about &lt;a class="link" href="https://blog.robsewell.com/?p=505" target="_blank" rel="noopener"
&gt;Launching Azure VMs with PowerShell&lt;/a&gt; made someone ask me to explain how I start my Azure VMs normally so here goes.&lt;/p&gt;
&lt;p&gt;When I decide to write a blog post or develop and test a script or run through demos from a presentation or blog post I fire up my Azure Virtual machines with PowerShell. This is how I do it&lt;/p&gt;
&lt;p&gt;Open PowerShell and check that I am connected to my default subscription by running &lt;code&gt;Get-AzureSubscription&lt;/code&gt;&lt;/p&gt;</description></item><item><title>What Runs on the SQL Server when you run a PowerShell script?–Question from #SQLRelay</title><link>https://blog.robsewell.com/blog/what-runs-on-the-sql-server-when-you-run-a-powershell-scriptquestion-from-%23sqlrelay/</link><pubDate>Sat, 23 Nov 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/what-runs-on-the-sql-server-when-you-run-a-powershell-scriptquestion-from-%23sqlrelay/</guid><description>&lt;p&gt;Last week I ran a PowerShell lab at SQL Relay in Cardiff. There are still a few places available for SQL Relay week 2. &lt;a class="link" href="http://www.sqlrelay.co.uk/" target="_blank" rel="noopener"
&gt;Take a look here for more details&lt;/a&gt; and follow the twitter &lt;a class="link" href="https://twitter.com/search?q=%23sqlrelay" target="_blank" rel="noopener"
&gt;hashtag #SQLRelay&lt;/a&gt; for up to date information&lt;/p&gt;
&lt;p&gt;The link for my slides and demos from the second part are here &lt;a class="link" href="https://t.co/Fik2odyUMA" title="https://t.co/Fik2odyUMA"
target="_blank" rel="noopener"
&gt;https://t.co/Fik2odyUMA&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Whilst we were discussing &lt;a class="link" href="https://blog.robsewell.com/checking-for-a-database-backup-with-powershell/" target="_blank" rel="noopener"
&gt;Show-LastDatabaseBackup&lt;/a&gt; Kev Chant &lt;a class="link" href="https://twitter.com/KevChant" target="_blank" rel="noopener"
&gt;@KevChant&lt;/a&gt; asked where it was getting the information from and I answered that PowerShell was running SQL commands under the hood against the server and if you ran profiler that is what you would see. We didn’t have time to do that in Cardiff but I thought I would do it today to show what happens&lt;/p&gt;</description></item><item><title>#TSQL2sDay Why My Head is Always in The Cloud</title><link>https://blog.robsewell.com/blog/tsql2sday-why-my-head-is-always-in-the-cloud/</link><pubDate>Sun, 10 Nov 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/tsql2sday-why-my-head-is-always-in-the-cloud/</guid><description>&lt;p&gt;&lt;a class="link" href="http://www.sqlchicken.com/2013/11/t-sql-tuesday-48-cloud-atlas/" target="_blank" rel="noopener"
&gt;&lt;img src="https://i1.wp.com/www.sqlchicken.com/wp-content/uploads/2013/11/20121003200545_thumb.jpg?resize=175%2C175"
loading="lazy"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Todays post is my first for the TSQL2sDay series. For those not familiar this is rotating blog party that was started by Adam Machanic &lt;a class="link" href="http://twitter.com/adammachanic" target="_blank" rel="noopener"
&gt;(@AdamMachanic&lt;/a&gt; &lt;a class="link" href="http://sqlblog.com/blogs/adam_machanic/" target="_blank" rel="noopener"
&gt;blog&lt;/a&gt;) back in 2009. If you want to catch up on all the fun to date check out this nice archive (&lt;a class="link" href="http://t.co/g3tzA9nP27" target="_blank" rel="noopener"
&gt;link&lt;/a&gt;) put together by Steve Jones &lt;a class="link" href="http://twitter.com/way0utwest" target="_blank" rel="noopener"
&gt;(@way0utwest&lt;/a&gt; &lt;a class="link" href="http://voiceofthedba.com/" target="_blank" rel="noopener"
&gt;blog&lt;/a&gt;). Thank you Steve!!!&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="http://owenrichardson.com/2011/07/07/cloud-computing/" target="_blank" rel="noopener"
&gt;&lt;img src="https://owenrichardson.files.wordpress.com/2011/07/wpid-photo-jul-7-2011-1738.jpg?w=432&amp;amp;h=650&amp;amp;resize=207%2C310"
loading="lazy"
alt="Azure Ballon - Credit http://owenrichardson.com/"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;This one is hosted by Jorge Segarra &lt;a class="link" href="https://twitter.com/SQLChicken" target="_blank" rel="noopener"
&gt;@SQLChicken:&lt;/a&gt;  &lt;a class="link" href="http://www.sqlchicken.com/2013/11/t-sql-tuesday-48-cloud-atlas/" target="_blank" rel="noopener"
&gt;who said&lt;/a&gt; This month’s topic is all about the cloud. What’s your take on it? Have you used it? If so, let’s hear your experiences. Haven’t used it? Let’s hear why or why not? Do you like/dislike recent changes made to cloud services? It’s clear skies for writing! So let’s hear it folks, where do you stand with the cloud?&lt;/p&gt;</description></item><item><title>SQL Saturday Exeter&amp;ndash;What&amp;rsquo;s the Point? My Experience of 2013 SQLSatExeter</title><link>https://blog.robsewell.com/blog/sql-saturday-exeterndashwhatrsquos-the-point-my-experience-of-2013-sqlsatexeter/</link><pubDate>Sun, 10 Nov 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/sql-saturday-exeterndashwhatrsquos-the-point-my-experience-of-2013-sqlsatexeter/</guid><description>&lt;p&gt; &lt;/p&gt;
&lt;p&gt;Disclaimer – I am on the committee organising the next &lt;a class="link" href="http://sqlsouthwest.co.uk/sqlsat269/" target="_blank" rel="noopener"
&gt;SQL Saturday Exeter&lt;/a&gt;. To be kept up to date about SQL Saturday #269 in the South West, follow &lt;a class="link" href="https://twitter.com/sqlsatexeter" target="_blank" rel="noopener"
&gt;@SQLSatExeter&lt;/a&gt; and&lt;a class="link" href="https://twitter.com/search?q=%23sqlsatexeter&amp;amp;src=hash&amp;amp;f=realtime" target="_blank" rel="noopener"
&gt;#SQLSatExeter&lt;/a&gt; on twitter and see details at the bottom. This post is about my experience at this years event.&lt;/p&gt;
&lt;p&gt;In March this year the SQL South West User Group hosted SQL Saturday #194 in Exeter. I was a new member to the User Group having finally been able to join them for the first time in January. At that meeting Chris Testa O’Neill presented a session and was very passionate about the SQL Community and the benefit of the SQL Saturdays and other events.  I am always keen to learn new things and find ways of developing my skills. As I haven’t won the lottery I also look out for good deals as well!!&lt;/p&gt;</description></item><item><title>Launching Azure VM After Starting With PowerShell</title><link>https://blog.robsewell.com/blog/launching-azure-vm-after-starting-with-powershell/</link><pubDate>Sat, 26 Oct 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/launching-azure-vm-after-starting-with-powershell/</guid><description>&lt;p&gt;So this morning I decided I was going to run through this blog post on understanding query plans &lt;a class="link" href="http://sqlmag.com/t-sql/understanding-query-plans" target="_blank" rel="noopener"
&gt;http://sqlmag.com/t-sql/understanding-query-plans&lt;/a&gt;. I logged into my Azure Portal to check my balance and clicked start on the machine and then immediately clicked connect.&lt;/p&gt;
&lt;p&gt;D’oh&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/assets/uploads/2013/10/image3.png" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2013/10/image3.png"
loading="lazy"
alt="image"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Of course the RDP session wouldn’t open as the machine was not up so I went and made a coffee. Whilst doing that I thought of a way of doing it with PowerShell&lt;/p&gt;</description></item><item><title>Searching for Installed Windows Update With PowerShell</title><link>https://blog.robsewell.com/blog/searching-for-installed-windows-update-with-powershell/</link><pubDate>Mon, 30 Sep 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/searching-for-installed-windows-update-with-powershell/</guid><description>&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/?p=480" target="_blank" rel="noopener"
&gt;Yesterdays Post Show-WindowsUpdatesLocal&lt;/a&gt; does enable you to search for an installed update as follows&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Show-WindowsUpdatesLocal|Where-Object {$_.HotFixID -eq ‘KB2855336’} |Select Date, HotfixID, Result,Title|Format-Table –AutoSize
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/assets/uploads/2013/09/image108.png" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2013/09/image108.png"
loading="lazy"
alt="image"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I thought I would be able to do it quicker especially if I was searching a server with a lot of updates so I thought I would create a function to answer the  question Is this update installed on that server&lt;/p&gt;
&lt;p&gt;It is very similar to &lt;a class="link" href="https://blog.robsewell.com/?p=480" target="_blank" rel="noopener"
&gt;Show-WindowsUpdatesLocal&lt;/a&gt; but does not include the Title or Description on the grounds that if you are searching for it you should know those!!&lt;/p&gt;</description></item><item><title>Show Windows Updates Locally With PowerShell</title><link>https://blog.robsewell.com/blog/show-windows-updates-locally-with-powershell/</link><pubDate>Sun, 29 Sep 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/show-windows-updates-locally-with-powershell/</guid><description>&lt;p&gt;I wanted to be able to quickly show the Windows Updates on a server. This came about during a discussion about auditing.&lt;/p&gt;
&lt;p&gt;Of course, there is no point in re-inventing the wheel so I had a quick Google and  found a couple of posts on from  &lt;a class="link" href="http://blogs.technet.com/b/heyscriptingguy/archive/2009/03/09/how-can-i-list-all-updates-that-have-been-added-to-a-computer.aspx" target="_blank" rel="noopener"
&gt;Hey Scripting Guy&lt;/a&gt; blog and one from &lt;a class="link" href="http://blogs.technet.com/b/tmintner/archive/2006/07/07/440729.aspx" target="_blank" rel="noopener"
&gt;Tim Minter&lt;/a&gt;. Neither quite did what I wanted so I modified them as follows.&lt;/p&gt;
&lt;p&gt;We start by creating a Update object and find the total number of updates and setting them to a variable &lt;code&gt;$History&lt;/code&gt; which we pass to the &lt;code&gt;QueryHistory&lt;/code&gt; Method. This enables us to show all the updates&lt;/p&gt;</description></item><item><title>Finding Text In All Files In A Folder With PowerShell</title><link>https://blog.robsewell.com/blog/finding-text-in-all-files-in-a-folder-with-powershell/</link><pubDate>Wed, 25 Sep 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/finding-text-in-all-files-in-a-folder-with-powershell/</guid><description>&lt;p&gt;Whilst writing my &lt;a class="link" href="https://blog.robsewell.com/?p=434" target="_blank" rel="noopener"
&gt;PowerShell Box of Tricks GUI&lt;/a&gt; I realised that I had hard-coded the path to the sqlservers.txt file in several functions and I wanted one place where I could set this. At the top of the GUI script I added a variable and in the ReadMe explained this needed to be set but I needed to change it in all of the functions where it was referenced.&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="http://blogs.technet.com/b/heyscriptingguy/archive/2011/08/04/use-an-easy-powershell-command-to-search-files-for-information.aspx" target="_blank" rel="noopener"
&gt;The Hey Scripting Guy Blog came to the rescue&lt;/a&gt;&lt;/p&gt;</description></item><item><title>The PowerShell Box Of Tricks GUI</title><link>https://blog.robsewell.com/blog/the-powershell-box-of-tricks-gui/</link><pubDate>Tue, 24 Sep 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/the-powershell-box-of-tricks-gui/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2013/09/image86.png" alt="Featured image of post The PowerShell Box Of Tricks GUI" /&gt;&lt;p&gt;When I started as a DBA at MyWork I faced a challenge. Many hundreds of databases, dozens of servers and no idea what was on where. It was remembering this situation when new team members were appointed that lead me to write the &lt;a class="link" href="https://blog.robsewell.com/using-powershell-to-find-a-database-amongst-hundreds/" target="_blank" rel="noopener"
&gt;Find-Database script&lt;/a&gt; and I had written a simple GUI using &lt;code&gt;Read-Host&lt;/code&gt; to enable the newbies to see the functions I had created&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/assets/uploads/2013/09/image85.png" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2013/09/image85.png"
loading="lazy"
alt="image"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Whilst writing this series of posts I decided that I would create a new GUI&lt;/p&gt;</description></item><item><title>Add User to SQL Server Database Role with PowerShell and Quickly Creating Test Users</title><link>https://blog.robsewell.com/blog/add-user-to-sql-server-database-role-with-powershell-and-quickly-creating-test-users/</link><pubDate>Mon, 23 Sep 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/add-user-to-sql-server-database-role-with-powershell-and-quickly-creating-test-users/</guid><description>&lt;p&gt;There is a newer &lt;a class="link" href="https://blog.robsewell.com/blog/quickly-creating-test-users-in-sql-server-with-powershell-using-the-sqlserver-module-and-dbatools/" target="_blank" rel="noopener"
&gt;up to date version of this post here&lt;/a&gt; using the &lt;a class="link" href="https://dbatools.io" target="_blank" rel="noopener"
&gt;dbatools module&lt;/a&gt; and the sqlserver module&lt;/p&gt;
&lt;p&gt;But if you want to continue with this way read on!!&lt;/p&gt;
&lt;p&gt;Having created &lt;a class="link" href="https://blog.robsewell.com/creating-a-windows-user-and-adding-to-a-sql-server-role-with-powershell/" target="_blank" rel="noopener"
&gt;Windows Users&lt;/a&gt; or &lt;a class="link" href="https://blog.robsewell.com/creating-sql-user-and-adding-to-server-role-with-powershell/" target="_blank" rel="noopener"
&gt;SQL Users&lt;/a&gt; using the last two days posts, today we shall add them to a role on a database.&lt;/p&gt;
&lt;p&gt;As I discussed &lt;a class="link" href="https://blog.robsewell.com/checking-sql-server-user-role-membership-with-powershell/" target="_blank" rel="noopener"
&gt;previously&lt;/a&gt; I believe that to follow good practice I try to ensure that database permissions are granted by role membership and each role is created with the minimum amount of permissions required for successful execution of the task involved.&lt;/p&gt;</description></item><item><title>Creating SQL User and adding to Server Role with PowerShell</title><link>https://blog.robsewell.com/blog/creating-sql-user-and-adding-to-server-role-with-powershell/</link><pubDate>Sat, 21 Sep 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/creating-sql-user-and-adding-to-server-role-with-powershell/</guid><description>&lt;p&gt;Another post in the &lt;a class="link" href="https://blog.robsewell.com/tags/#box-of-tricks" target="_blank" rel="noopener"
&gt;PowerShell Box of Tricks&lt;/a&gt; series.&lt;/p&gt;
&lt;p&gt;In yesterdays post &lt;a class="link" href="https://blog.robsewell.com/creating-a-windows-user-and-adding-to-a-sql-server-role-with-powershell/" target="_blank" rel="noopener"
&gt;Creating a Windows User and Adding to SQL Role&lt;/a&gt; we created a Windows User, today it’s a SQL User. Again it is nice and simple and allows you to pipe input from other sources enabling you to easily and quickly repeat any process that needs SQL Users.&lt;/p&gt;
&lt;p&gt;It is pretty similar as you would expect. We create a Login Object, set the Logintype to  SqlLogin add the Password and create it with the Create Method. It is then added to the Role Specified&lt;/p&gt;</description></item><item><title>Creating a Windows User and adding to a SQL Server Role with PowerShell</title><link>https://blog.robsewell.com/blog/creating-a-windows-user-and-adding-to-a-sql-server-role-with-powershell/</link><pubDate>Fri, 20 Sep 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/creating-a-windows-user-and-adding-to-a-sql-server-role-with-powershell/</guid><description>&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/assets/uploads/2013/09/image67.png" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2013/09/image67.png"
loading="lazy"
alt="image"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The function does some simple error checking. If the login already exists on the server it will just add it to the role and if the role has been mistyped it will let you know. It does this by checking if the Role object is Null for the Roles and the Contains Method for the Logins&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/assets/uploads/2013/09/image98.png" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2013/09/image98.png"
loading="lazy"
alt="image"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;Add-WindowsAccountToSQLRole FADE2BLACK ‘FADE2BLACK\Test’ public
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;###########################################################
#
# NAME: Add-WindowsAccountToSQLRole.ps1
# AUTHOR: Rob Sewell https://blog.robsewell.com
# DATE:11/09/2013
#
# COMMENTS: Load function to create a windows user and add them to a server role
#
# USAGE: Add-WindowsAccountToSQLRole FADE2BLACK 'FADE2BLACK\Test' dbcreator
# Add-WindowsAccountToSQLRole FADE2BLACK 'FADE2BLACK\Test' public
Function Add-WindowsAccountToSQLRole ([String]$Server, [String] $User, [String]$Role) {
$Svr = New-Object ('Microsoft.SqlServer.Management.Smo. Server') $server
# Check if Role entered Correctly
$SVRRole = $svr.Roles[$Role]
if ($SVRRole -eq $null) {
Write-Output &amp;quot; $Role is not a valid Role on $Server&amp;quot;
}
else {
#Check if User already exists
if ($svr.Logins.Contains($User)) {
$SqlUser = New-Object -TypeName Microsoft. SqlServer.Management.Smo.Login $Server, $User
$LoginName = $SQLUser.Name
if ($Role -notcontains &amp;quot;public&amp;quot;) {
$svrole = $svr.Roles | where {$_.Name -eq $Role}
$svrole.AddMember(&amp;quot;$LoginName&amp;quot;)
}
}
else {
$SqlUser = New-Object -TypeName Microsoft. SqlServer.Management.Smo.Login $Server, $User
$SqlUser.LoginType = 'WindowsUser'
$SqlUser.Create()
$LoginName = $SQLUser.Name
if ($Role -notcontains &amp;quot;public&amp;quot;) {
$svrole = $svr.Roles | where {$_.Name -eq $Role}
$svrole.AddMember(&amp;quot;$LoginName&amp;quot;)
}
}
}
}
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;</description></item><item><title>Displaying the Windows Event Log with PowerShell</title><link>https://blog.robsewell.com/blog/displaying-the-windows-event-log-with-powershell/</link><pubDate>Wed, 18 Sep 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/displaying-the-windows-event-log-with-powershell/</guid><description>&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;I’ll start by saying this is a bit of a cheat. PowerShell has a perfectly good cmdlet called &lt;a class="link" href="http://technet.microsoft.com/en-us/library/hh849834.aspx?WT.mc_id=DP-MVP-5002693" target="_blank" rel="noopener"
&gt;Get-EventLog&lt;/a&gt; and plenty of &lt;a class="link" href="http://technet.microsoft.com/en-us/library/ee176846.aspx?WT.mc_id=DP-MVP-5002693" target="_blank" rel="noopener"
&gt;ways to use it&lt;/a&gt;&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;#####################################################################
#
# NAME: Show-EventLog.ps1
# AUTHOR: Rob Sewell http://newsqldbawiththebeard.wordpress.com
# DATE:06/08/2013
#
# COMMENTS: Load function for Showing the windows event logs on a server
# ————————————————————————
# Define a server an event log the number of events and display
# pipe to this and then to out-gridview to only show Errors - where {$_. entryType -match &amp;quot;Error&amp;quot;}
Function Show-EventLog ($Server, $log, $Latest) {
Get-EventLog -computername $server -log $log -newest $latest | Out-GridView
}
&lt;/code&gt;&lt;/pre&gt;</description></item><item><title>Showing and Killing SQL Server Processes with PowerShell</title><link>https://blog.robsewell.com/blog/showing-and-killing-sql-server-processes-with-powershell/</link><pubDate>Tue, 17 Sep 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/showing-and-killing-sql-server-processes-with-powershell/</guid><description>&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;Create a Server Object and notice that there is a Method named EnumProcesses by piping it to &lt;code&gt;Get-Member&lt;/code&gt; and then look at the Properties and Methods of EnumProcesses&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;#######################################################################
#
# NAME: Show-SQLProcesses.ps1
# AUTHOR: Rob Sewell http://sqldbawithabeard.com
# DATE:06/08/2013
#
# COMMENTS: Load function for Showing Processes on a SQL Server
####################################
Function Show-SQLProcesses ($SQLServer)
{
$server = new-object &amp;quot;Microsoft.SqlServer.Management.Smo.Server&amp;quot; $SQLServer
$Server.EnumProcesses()|Select Spid,BlockingSpid, Login, Host,Status,Program, Command,Database,Cpu,MemUsage |Format-Table -wrap -auto
$OUTPUT= [System.Windows.Forms.MessageBox]::Show(&amp;quot;Do you want to Kill a process?&amp;quot; , &amp;quot;Question&amp;quot; , 4)
if ($OUTPUT -eq &amp;quot;YES&amp;quot; )
{
$spid = Read-Host &amp;quot;Which SPID?&amp;quot;
$Server.KillProcess($Spid)
}
else
{
}
}
&lt;/code&gt;&lt;/pre&gt;</description></item><item><title>Show The Last Backups On A Server with PowerShell</title><link>https://blog.robsewell.com/blog/show-the-last-backups-on-a-server-with-powershell/</link><pubDate>Sun, 15 Sep 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/show-the-last-backups-on-a-server-with-powershell/</guid><description>&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;The &lt;code&gt;Show-LastServerBackup&lt;/code&gt; function iterates through each database on the server and takes each of the three properties mentioned in &lt;!-- raw HTML omitted --&gt;yesterdays post&lt;!-- raw HTML omitted --&gt;. However this time I created an empty hash table and added each result to it as follows&lt;/p&gt;
&lt;p&gt;I created the hash table with &lt;code&gt;@()&lt;/code&gt; and then assign each property to a variable inside the loop and add it to a temporary PSObject with some custom NoteProperties to fit the data&lt;/p&gt;</description></item><item><title>Checking For A Database Backup with PowerShell</title><link>https://blog.robsewell.com/blog/checking-for-a-database-backup-with-powershell/</link><pubDate>Sat, 14 Sep 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/checking-for-a-database-backup-with-powershell/</guid><description>&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;############################################################################# ################
#
# NAME: Show-LastServerBackup.ps1
# AUTHOR: Rob Sewell http://newsqldbawiththebeard.wordpress.com
# DATE:06/08/2013
#
# COMMENTS: Load function for Showing Last Backup of each database on a server
# ————————————————————————
Function Show-LastDatabaseBackup ($SQLServer, $sqldatabase) {
$server = new-object &amp;quot;Microsoft.SqlServer.Management.Smo.Server&amp;quot; $SQLServer
$db = $server.Databases[$sqldatabase]
Write-Output &amp;quot;Last Full Backup&amp;quot;
$LastFull = $db.lastbackupdate
if ($lastfull -eq '01 January 0001 00:00:00')
{$LastFull = 'NEVER'}
Write-Output $LastFull
Write-Output &amp;quot;Last Diff Backup&amp;quot;
$LastDiff = $db.LastDifferentialBackupDate
if ($lastdiff -eq '01 January 0001 00:00:00')
{$Lastdiff = 'NEVER'}
Write-Output $Lastdiff
Write-Output &amp;quot;Last Log Backup&amp;quot; $lastLog = $db. LastLogBackupDate
if ($lastlog -eq '01 January 0001 00:00:00')
{$Lastlog = 'NEVER'}
Write-Output $lastlog
}
&lt;/code&gt;&lt;/pre&gt;</description></item><item><title>Searching the SQL Error Log with PowerShell</title><link>https://blog.robsewell.com/blog/searching-the-sql-error-log-with-powershell/</link><pubDate>Fri, 13 Sep 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/searching-the-sql-error-log-with-powershell/</guid><description>&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;############################################################################# ################
#
# NAME: Search-SQLErrorLog.ps1
# AUTHOR: Rob Sewell http://newsqldbawiththebeard.wordpress.com
# DATE:22/07/2013
#
# COMMENTS: Load function for Searching SQL Error Log and exporting and displaying to CSV
# ————————————————————————
Function Search-SQLErrorLog ([string] $SearchTerm , [string] $SQLServer) {
$FileName = 'c:\TEMP\SQLLogSearch.csv'
$Search = '*' + $SearchTerm + '*'
$server = new-object &amp;quot;Microsoft.SqlServer.Management.Smo.Server&amp;quot; $SQLServer
$server.ReadErrorLog(5)| Where-Object {$_.Text -like $Search} | Select LogDate, ProcessInfo, Text |Export-Csv $FileName
$server.ReadErrorLog(4)| Where-Object {$_.Text -like $Search} | Select LogDate, ProcessInfo, Text |ConvertTo-Csv |Out-File $FileName -append
$server.ReadErrorLog(3)| Where-Object {$_.Text -like $Search} | Select LogDate, ProcessInfo, Text |ConvertTo-Csv |Out-File $FileName -append
$server.ReadErrorLog(2)| Where-Object {$_.Text -like $Search} | Select LogDate, ProcessInfo, Text |ConvertTo-Csv |Out-File $FileName -append
$server.ReadErrorLog(1)| Where-Object {$_.Text -like $Search} | Select LogDate, ProcessInfo, Text |ConvertTo-Csv |Out-File $FileName -append
$server.ReadErrorLog(0)| Where-Object {$_.Text -like $Search} | Select LogDate, ProcessInfo, Text |ConvertTo-Csv |Out-File $FileName -append
Invoke-Item $filename
}
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;</description></item><item><title>List Databases (and Properties) on SQL Server with PowerShell</title><link>https://blog.robsewell.com/blog/list-databases-and-properties-on-sql-server-with-powershell/</link><pubDate>Wed, 11 Sep 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/list-databases-and-properties-on-sql-server-with-powershell/</guid><description>&lt;p&gt;Another post in the &lt;a class="link" href="https://blog.robsewell.com/tags/#box-of-tricks" target="_blank" rel="noopener"
&gt;PowerShell Box of Tricks&lt;/a&gt; series. Here is another script which I use to save me time and effort during my daily workload enabling me to spend more time on more important (to me) things!&lt;/p&gt;
&lt;p&gt;Todays question which I often get asked is What databases are on that server?&lt;/p&gt;
&lt;p&gt;This is often a follow up to a question that requires the &lt;a class="link" href="https://blog.robsewell.com/using-powershell-to-find-a-database-amongst-hundreds/" target="_blank" rel="noopener"
&gt;Find-Database script&lt;/a&gt;. It is often asked by support teams investigating issues. It can also be asked by developers checking the impact of other services on their DEV/UAT environments, by change managers investigating impact of changes, by service managers investigating the impact of downtime, when capacity planning for a new service and numerous other situations.&lt;/p&gt;</description></item><item><title>Reading Todays SQL Error Log With PowerShell</title><link>https://blog.robsewell.com/blog/reading-todays-sql-error-log-with-powershell/</link><pubDate>Wed, 11 Sep 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/reading-todays-sql-error-log-with-powershell/</guid><description>&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;Show-LatestSQLErrorLog fade2black|Out-File -FilePath c:\temp\log.txt
Invoke-Item c:\temp\log.txt
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;############################################################################# ################
#
# NAME: Show-Last24HoursSQLErrorLog.ps1
# AUTHOR: Rob Sewell http://newsqldbawiththebeard.wordpress.com
# DATE:22/07/2013
#
# COMMENTS: Load function for reading last days current SQL Error Log for Server
# ————————————————————————
Function Show-Last24HoursSQLErrorLog ([string]$Server) {
$srv = New-Object ('Microsoft.SqlServer.Management.Smo.Server') $server
$logDate = (get-date).AddDays(-1)
$Results = $srv.ReadErrorLog(0) |Where-Object {$_.LogDate -gt $logDate}| format-table -Wrap -AutoSize
$Results
}
&lt;/code&gt;&lt;/pre&gt;</description></item><item><title>Dropping SQL Users with PowerShell</title><link>https://blog.robsewell.com/blog/dropping-sql-users-with-powershell/</link><pubDate>Tue, 10 Sep 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/dropping-sql-users-with-powershell/</guid><description>&lt;p&gt;As you may have noticed, I love PowerShell!&lt;/p&gt;
&lt;p&gt;I have developed a series of functions over time which save me time and effort whilst still enabling me to provide a good service to my customers. I keep them all in a functions folder and call them whenever. I call it my &lt;a class="link" href="https://blog.robsewell.com/tags/#box-of-tricks" target="_blank" rel="noopener"
&gt;PowerShell Box of Tricks&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I am going to write a short post about each one over the next few weeks as I write my presentation on the same subject which I will be presenting to SQL User Groups.&lt;/p&gt;</description></item><item><title>Alter SQL Mirroring Endpoint Owner with Powershell</title><link>https://blog.robsewell.com/blog/alter-sql-mirroring-endpoint-owner-with-powershell/</link><pubDate>Sun, 08 Sep 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/alter-sql-mirroring-endpoint-owner-with-powershell/</guid><description>&lt;!-- raw HTML omitted --&gt;
&lt;blockquote&gt;
&lt;p&gt;Login domain\user’ has granted one or more permissions. Revoke the permission before dropping the login (Microsoft SQL Server, Error: 15173)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/assets/uploads/2013/09/mirroring-endpoitn-check.jpg" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2013/09/mirroring-endpoitn-check.jpg"
loading="lazy"
alt="mirroring endpoitn check"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/assets/uploads/2013/09/alter-endpoint.jpg" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2013/09/alter-endpoint.jpg"
loading="lazy"
alt="alter endpoint"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/assets/uploads/2013/09/alterendpointps.jpg" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2013/09/alterendpointps.jpg"
loading="lazy"
alt="alterendpointPS"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;$svrs = ## list of servers Get-Content from text fiel etc
foreach ($svr in $svrs) {
$server = New-Object Microsoft.SQLServer.Management.Smo.Server $svrs
foreach ($endpoint in $server.Endpoints['Mirroring']) {
if ($endpoint.Owner = 'Domain\User') {
$endpoint.Owner = 'Domain\NEWUser'
$endpoint.Alter()
}
}
}
&lt;/code&gt;&lt;/pre&gt;</description></item><item><title>Creating SQL Server Database with PowerShell</title><link>https://blog.robsewell.com/blog/creating-sql-server-database-with-powershell/</link><pubDate>Sun, 08 Sep 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/creating-sql-server-database-with-powershell/</guid><description>&lt;p&gt;This morning I have been setting up my Azure Servers in preparation for my presentation to the Cardiff SQL User Group this month.&lt;/p&gt;
&lt;p&gt;I used my scripts from &lt;a class="link" href="https://blog.robsewell.com/spinning-up-and-shutting-down-windows-azure-lab-with-powershell/" target="_blank" rel="noopener"
&gt;My Post on Spinning Up Azure SQL Boxes&lt;/a&gt; to create two servers and then I wanted to create some databases&lt;/p&gt;
&lt;p&gt;I decided it was time to write a Create-Database function using a number of scripts that I have used to create individual databases.&lt;/p&gt;</description></item><item><title>Using PowerShell to find a database amongst hundreds</title><link>https://blog.robsewell.com/blog/using-powershell-to-find-a-database-amongst-hundreds/</link><pubDate>Sat, 07 Sep 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/using-powershell-to-find-a-database-amongst-hundreds/</guid><description>&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/assets/uploads/2013/09/image34.png" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2013/09/image34.png"
loading="lazy"
alt="image"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I create an empty hash table and then populate it with the results&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/assets/uploads/2013/09/image35.png" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2013/09/image35.png"
loading="lazy"
alt="image"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Set a results variable to the names from the hash table and count the number of records&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/assets/uploads/2013/09/image36.png" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2013/09/image36.png"
loading="lazy"
alt="image"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;and call it like this&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/assets/uploads/2013/09/image37.png" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2013/09/image37.png"
loading="lazy"
alt="image"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Note that the search uses the contains method so no need for wildcards&lt;/p&gt;
&lt;p&gt;Results come out like this&lt;/p&gt;</description></item><item><title>Checking Drive Sizes with PowerShell</title><link>https://blog.robsewell.com/blog/checking-drive-sizes-with-powershell/</link><pubDate>Fri, 06 Sep 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/checking-drive-sizes-with-powershell/</guid><description>&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2013/09/image31.png"
loading="lazy"
alt="image"
&gt;&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/assets/uploads/2013/09/image32.png" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2013/09/image32.png"
loading="lazy"
alt="image"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;and here are the results from my Azure VM. (See &lt;a class="link" href="https://blog.robsewell.com/spinning-up-and-shutting-down-windows-azure-lab-with-powershell/" target="_blank" rel="noopener"
&gt;My previous posts on how to create your own Azure VMs with PowerShell&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://blog.robsewell.com/assets/uploads/2013/09/image33.png" target="_blank" rel="noopener"
&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2013/09/image33.png"
loading="lazy"
alt="image"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;#############################################################################
#
# NAME: Show-DriveSizes.ps1
# AUTHOR: Rob Sewell http://sqldbawiththebeard.com
# DATE:22/07/2013
#
# COMMENTS: Load function for displaying drivesizes
# USAGE: Show-DriveSizes server1
###########################################
Function Show-DriveSizes ([string]$Server) {
$Date = Get-Date
Write-Host -foregroundcolor DarkBlue -backgroundcolor yellow &amp;quot;$Server - - $Date&amp;quot;
#interogate wmi service and return disk information
$disks = Get-WmiObject -Class Win32_logicaldisk -Filter &amp;quot;Drivetype=3&amp;quot; -ComputerName $Server
$diskData = $disks | Select DeviceID, VolumeName ,
# select size in Gbs as int and label it SizeGb
@{Name = &amp;quot;SizeGB&amp;quot;; Expression = {$_.size / 1GB -as [int]}},
# select freespace in Gbs and label it FreeGb and two deciaml places
@{Name = &amp;quot;FreeGB&amp;quot;; Expression = {&amp;quot;{0:N2}&amp;quot; -f ($_.Freespace / 1GB)}},
# select freespace as percentage two deciaml places and label it PercentFree
@{Name = &amp;quot;PercentFree&amp;quot;; Expression = {&amp;quot;{0:P2}&amp;quot; -f ($_.Freespace / $_. Size)}}
$diskdata
}
&lt;/code&gt;&lt;/pre&gt;</description></item><item><title>SQL Server Operators and Notifications with Powershell – Strange Enumerate issue fixed by @napalmgram</title><link>https://blog.robsewell.com/blog/sql-server-operators-and-notifications-with-powershell-strange-enumerate-issue-fixed-by-@napalmgram/</link><pubDate>Thu, 05 Sep 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/sql-server-operators-and-notifications-with-powershell-strange-enumerate-issue-fixed-by-@napalmgram/</guid><description>&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2013/09/2013-09-04_125056.jpg"
loading="lazy"
alt="alt"
&gt;&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;$server | Get-Member
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;$Server.JobServer|gm
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;$Server.JobServer.Operators | gm
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2013/09/2013-09-04_125717.jpg"
loading="lazy"
alt="alt"
&gt;&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2013/09/2013-09-04_130052.jpg"
loading="lazy"
alt="alt"
&gt;&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2013/09/2013-09-04_174005.jpg"
loading="lazy"
alt="alt"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2013/09/2013-09-04_173953.jpg"
loading="lazy"
alt="alt"
&gt;&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;&lt;img src="https://i0.wp.com/sqldbawithabeard.com/wp-content/uploads/2013/09/2013-09-04_174056.jpg"
loading="lazy"
alt="alt"
&gt;&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;&lt;img src="https://i0.wp.com/sqldbawithabeard.com/wp-content/uploads/2013/09/2013-09-04_174112.jpg"
loading="lazy"
alt="alt"
&gt;&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2013/09/2013-09-05_113931.jpg"
loading="lazy"
alt="alt"
&gt;&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;&lt;img src="https://blog.robsewell.com/assets/uploads/2013/09/2013-09-05_114601.jpg"
loading="lazy"
alt="alt"
&gt;&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;############################################################################# ################
#
# NAME: Show-SQLServerOperators.ps1
# AUTHOR: Rob Sewell https://blog.robsewell.com
# DATE:03/09/2013
#
# COMMENTS: Load function for Enumerating Operators and Notifications
# ————————————————————————
Function Show-SQLServerOperators ($SQLServer) {
Write-Output &amp;quot;############### $SQLServer ##########################&amp;quot;
Write-Output &amp;quot;#####################################################`n&amp;quot;
$server = new-object &amp;quot;Microsoft.SqlServer.Management.Smo.Server&amp;quot; $SQLServer
foreach ($Operator in $server.JobServer.Operators) {
$Operator = New-Object (&amp;quot;$SMO.Agent.Operator&amp;quot;) ($server.JobServer, $Operator)
$OpName = $Operator.Name
Write-Output &amp;quot;Operator $OpName&amp;quot;
Write-Output &amp;quot;`n###### Job Notifications ######&amp;quot;
$Operator.EnumJobNotifications()| Select JobName | Format-Table
Write-Output &amp;quot;#####################################################`n&amp;quot;
Write-Output &amp;quot;`n###### Alert Notifications #######&amp;quot;
$Operator.EnumNotifications() | Select AlertName | Format-Table
Write-Output &amp;quot;#####################################################`n&amp;quot;
}
}
&lt;/code&gt;&lt;/pre&gt;</description></item><item><title>SQL login object permissions via PowerShell</title><link>https://blog.robsewell.com/blog/sql-login-object-permissions-via-powershell/</link><pubDate>Wed, 04 Sep 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/sql-login-object-permissions-via-powershell/</guid><description>&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;############################################################################# ################
#
# NAME: Show-SQLServerPermissions.ps1
# AUTHOR: Rob Sewell http://newsqldbawiththebeard.wordpress.com
# DATE:06/08/2013
#
# COMMENTS: Load function for Enumerating Server and Database Role permissions or object permissions
#
# USAGE Show-SQLServerPermissions Server1
# ————————————————————————
Function Show-SQLServerPermissions ($SQLServer) {
$server = new-object &amp;quot;Microsoft.SqlServer.Management.Smo.Server&amp;quot; $SQLServer
$selected = &amp;quot;&amp;quot;
$selected = Read-Host &amp;quot;Enter Selection
1.) Role Membership or
2.) Object Permissions&amp;quot;
Switch ($Selected) {
1 {
Write-Host &amp;quot;#### Server Role Membership on $Server ############################################## `n`n&amp;quot;
foreach ($Role in $Server.Roles) {
if ($Role.EnumServerRoleMembers().count -ne 0) {
Write-Host &amp;quot;############### Server Role Membership for $role on $Server #########################`n&amp;quot;
$Role.EnumServerRoleMembers()
}
}
Write-Host &amp;quot;################################################################ ######################&amp;quot;
Write-Host &amp;quot;################################################################ ######################`n `n `n&amp;quot;
foreach ($Database in $Server.Databases) {
Write-Host &amp;quot;`n#### $Database Permissions on $Server ###############################################`n&amp;quot;
foreach ($role in $Database.Roles) {
if ($Role.EnumMembers().count -ne 0) {
Write-Host &amp;quot;########### Database Role Permissions for $Database $Role on $Server ################`n&amp;quot;
$Role.EnumMembers()
}
}
}
}
2 {
Write-Host &amp;quot;################## Object Permissions on $Server ################################`n&amp;quot;
foreach ($Database in $Server.Databases) {
Write-Host &amp;quot;`n#### Object Permissions on $Database on $Server #################################`n&amp;quot;
foreach ($user in $database.Users) {
foreach ($databasePermission in $database. EnumDatabasePermissions($user.Name)) {
Write-Host $databasePermission.PermissionState $databasePermission.PermissionType &amp;quot;TO&amp;quot; $databasePermission.Grantee
}
foreach ($objectPermission in $database. EnumObjectPermissions($user.Name)) {
Write-Host $objectPermission.PermissionState $objectPermission.PermissionType &amp;quot;ON&amp;quot; $objectPermission.ObjectName &amp;quot;TO&amp;quot; $objectPermission. Grantee
}
}
}
}
}
}
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;</description></item><item><title>Checking SQL Server User Role Membership with PowerShell</title><link>https://blog.robsewell.com/blog/checking-sql-server-user-role-membership-with-powershell/</link><pubDate>Mon, 02 Sep 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/checking-sql-server-user-role-membership-with-powershell/</guid><description>&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;############################################################################# ################
#
# NAME: Show-SQLUserPermissions.ps1
# AUTHOR: Rob Sewell http://newsqldbawiththebeard.wordpress.com
# DATE:06/08/2013
#
# COMMENTS: Load function to Display the permissions a user has across the estate
# NOTE - Will not show permissions granted through AD Group Membership
#
# USAGE Show-SQLUserPermissions DBAwithaBeard
Function Show-SQLUserPermissions ($user)
{
[System.Reflection.Assembly]::LoadWithPartialName('Microsoft.SqlServer.SMO') | out-null
# Suppress Error messages - They will be displayed at the end
$ErrorActionPreference = &amp;quot;SilentlyContinue&amp;quot;
#cls
$Query = @&amp;quot;
SELECT
IL.ServerName
FROM [dbo].[InstanceList] IL
WHERE NotContactable = 0
AND Inactive = 0
AND DatabaseEngine = 'Microsoft SQL Server'
&amp;quot;@
Try
{
$Results = (Invoke-Sqlcmd -ServerInstance HMDBS02 -Database DBADatabase -Query $query -ErrorAction Stop).ServerName
}
catch
{
Write-Error &amp;quot;Unable to Connect to the DBADatabase - Please Check&amp;quot;
}
# Create an array for the username and each domain slash username
$logins = @(&amp;quot;DOMAIN1\$user&amp;quot;,&amp;quot;DOMAIN3\$user&amp;quot;, &amp;quot;DOMAIN4\$user&amp;quot; ,&amp;quot;$user&amp;quot; )
Write-Output &amp;quot;#################################&amp;quot;
Write-Output &amp;quot;Logins for `n $logins displayed below&amp;quot;
Write-Output &amp;quot;################################# `n&amp;quot;
#loop through each server and each database and display usernames, servers and databases
Write-Output &amp;quot; Server Logins&amp;quot;
foreach($server in $Results)
{
$srv = New-Object ('Microsoft.SqlServer.Management.Smo.Server') $server
foreach($login in $logins)
{
if($srv.Logins.Contains($login))
{
Write-Output &amp;quot;`n $server , $login &amp;quot;
foreach ($Role in $Srv.Roles)
{
$RoleMembers = $Role. EnumServerRoleMembers()
if($RoleMembers -contains $login)
{
Write-Output &amp;quot; $login is a member of $Role on $Server&amp;quot;
}
}
}
else
{
}
}
}
Write-Output &amp;quot;`n#########################################&amp;quot;
Write-Output &amp;quot;`n Database Logins&amp;quot;
foreach($server in $servers)
{
$srv = New-Object ('Microsoft.SqlServer.Management.Smo.Server') $server
foreach($database in $srv.Databases)
{
foreach($login in $logins)
{
if($database.Users.Contains($login))
{
Write-Output &amp;quot;`n $server , $database , $login &amp;quot;
foreach($role in $Database.Roles)
{
$RoleMembers = $Role.EnumMembers()
if($RoleMembers -contains $login)
{
Write-Output &amp;quot; $login is a member of $Role Role on $Database on $Server&amp;quot;
}
}
}
else
{
continue
}
}
}
}
Write-Output &amp;quot;`n#########################################&amp;quot;
Write-Output &amp;quot;Finished - If there are no logins displayed above then no logins were found!&amp;quot;
Write-Output &amp;quot;#########################################&amp;quot;
}
&lt;/code&gt;&lt;/pre&gt;</description></item><item><title>Checking for SQL Server logins with PowerShell</title><link>https://blog.robsewell.com/blog/checking-for-sql-server-logins-with-powershell/</link><pubDate>Sat, 31 Aug 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/checking-for-sql-server-logins-with-powershell/</guid><description>&lt;p&gt;As some of you may know, I love PowerShell!&lt;/p&gt;
&lt;p&gt;I use it all the time in my daily job as a SQL DBA and at home whilst learning as well.&lt;/p&gt;
&lt;p&gt;Not only do I use PowerShell for automating tasks such as Daily Backup Checks, Drive Space Checks, Service Running Checks, File Space Checks, Failed Agent Job Checks, SQL Error Log Checks, DBCC Checks and more but also for those questions which come up daily and interfere with concentrating on a complex or time consuming task.&lt;/p&gt;</description></item><item><title>SQL Express Migration Auto Close Setting</title><link>https://blog.robsewell.com/blog/sql-express-migration-auto-close-setting/</link><pubDate>Sat, 31 Aug 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/sql-express-migration-auto-close-setting/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2013/08/image_thumb.png" alt="Featured image of post SQL Express Migration Auto Close Setting" /&gt;&lt;p&gt;With over 700 databases to look after at MyWork automation is high on my list of priorities. I have two PowerShell scripts which run regularly checking SQL Error logs. One checks for the output from DBCC CHECKDB and one for errors. They then email the results to the DBA team.&lt;/p&gt;
&lt;p&gt;This week we noticed that a new database was creating a lot of entries. It appeared to be starting up every few minutes. A bit of investigation by my colleague revealed that this database had been created on SQL Express and migrated to SQL Server.&lt;/p&gt;</description></item><item><title>sp_BlitzIndex™ ouput to Excel with Powershell</title><link>https://blog.robsewell.com/blog/sp_blitzindex-ouput-to-excel-with-powershell/</link><pubDate>Sun, 23 Jun 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/sp_blitzindex-ouput-to-excel-with-powershell/</guid><description>&lt;p&gt;I am impressed with the output from &lt;a class="link" href="http://www.brentozar.com/blitzindex/" target="_blank" rel="noopener"
&gt;sp_BlitzIndex™&lt;/a&gt; and today I tried to save it to an excel file so that I could pass it on to the developer of the service. When I opened it in Excel and imported it from the csv file it didn’t keep the T-SQL in one column due the commas which bothered me so I decided to use Powershell to output the format to Excel as follows&lt;/p&gt;</description></item><item><title>Powershell can read email &amp; insert excel file attachment into a SQL Database</title><link>https://blog.robsewell.com/blog/powershell-can-read-email-insert-excel-file-attachment-into-a-sql-database/</link><pubDate>Thu, 20 Jun 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/powershell-can-read-email-insert-excel-file-attachment-into-a-sql-database/</guid><description>&lt;p&gt;So at our SQL SouthWest User Group session last week we had sessions from Jonathan &lt;a class="link" href="https://twitter.com/fatherjack" target="_blank" rel="noopener"
&gt;@fatherjack&lt;/a&gt; and Annette &lt;a class="link" href="https://twitter.com/Mrsfatherjack" target="_blank" rel="noopener"
&gt;@Mrsfatherjack&lt;/a&gt; on SSRS and SSIS respectively. During Annettes SSIS session a question was asked about reading email attachments and then loading them into a database. No-one had an answer using SSIS but I said it could be done with Powershell . So I have written the following script.&lt;/p&gt;
&lt;p&gt;What it does is open an Outlook com object, search for an email with a certain subject and save it in the temp folder and then import it into a SQL database. This needs to be done on a machine with Outlook and Excel installed. It is possible to process the email using EWS in an Exchange environment and other people have written scripts to do so.&lt;/p&gt;</description></item><item><title>Add Adventure Works Database to Windows Azure VM</title><link>https://blog.robsewell.com/blog/add-adventure-works-database-to-windows-azure-vm/</link><pubDate>Sun, 19 May 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/add-adventure-works-database-to-windows-azure-vm/</guid><description>&lt;p&gt;This has been an interesting journey. The Adventure Works database is frequently used in blogs and reference books and I wanted to install it in my Windows Azure Learning Lab and I also wanted to automate the process.&lt;/p&gt;
&lt;p&gt;The easiest way is to download the Windows Azure MDF file from  &lt;a class="link" href="http://msftdbprodsamples.codeplex.com/" target="_blank" rel="noopener"
&gt;http://msftdbprodsamples.codeplex.com/&lt;/a&gt; jump through all the security warnings in Internet Explorer and save the file and then create the database as follows&lt;/p&gt;</description></item><item><title>Checking SQL Error Logs, Event Logs and Stopping Services with Powershell</title><link>https://blog.robsewell.com/blog/checking-sql-error-logs-event-logs-and-stopping-services-with-powershell/</link><pubDate>Sun, 19 May 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/checking-sql-error-logs-event-logs-and-stopping-services-with-powershell/</guid><description>&lt;p&gt;It was patching time this week at MyWork so I thought I would share some Powershell scripts I use to speed up the process.&lt;/p&gt;
&lt;p&gt;I keep these in their own folder and cd to it. Then I can just type the first few letters and tab and Powershell completes it. Nice and easy and time saving&lt;/p&gt;
&lt;p&gt;The first thing I do is to stop the SQL services with the StopSQLServices.ps1&lt;/p&gt;</description></item><item><title>Lessons Learnt from my first talk at SQL SouthWest</title><link>https://blog.robsewell.com/blog/lessons-learnt-from-my-first-talk-at-sql-southwest/</link><pubDate>Fri, 17 May 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/lessons-learnt-from-my-first-talk-at-sql-southwest/</guid><description>&lt;p&gt;Edit 2022 -&lt;/p&gt;
&lt;p&gt;Find your User Groups here &lt;a class="link" href="https://www.meetup.com/en-AU/pro/azuredatatechgroups" target="_blank" rel="noopener"
&gt;Azure Data Community&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The timing was good enough that I could offer to do a talk based on my &lt;a class="link" href="https://blog.robsewell.com/azure/spinning-up-and-shutting-down-windows-azure-lab-with-powershell/" target="_blank" rel="noopener"
&gt;previous post on Windows Azure&lt;/a&gt; for my SQL User Group &lt;a class="link" href="http://sqlsouthwest.co.uk/" target="_blank" rel="noopener"
&gt;SQL SouthWest&lt;/a&gt; when Jonathan and Annette.( &lt;a class="link" href="https://twitter.com/fatherjack" target="_blank" rel="noopener"
&gt;@FatherJack&lt;/a&gt; and &lt;a class="link" href="https://twitter.com/Mrs_Fatherjack" target="_blank" rel="noopener"
&gt;@MrsFatherJack&lt;/a&gt;) put out a call for volunteers (Edit Sept 2020 - Brave enough to say now that Jonathan just told me I was doing it !! In the nicest possible way).&lt;/p&gt;</description></item><item><title>Spinning up and shutting down Windows Azure Lab with Powershell</title><link>https://blog.robsewell.com/blog/spinning-up-and-shutting-down-windows-azure-lab-with-powershell/</link><pubDate>Tue, 14 May 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/spinning-up-and-shutting-down-windows-azure-lab-with-powershell/</guid><description>&lt;p&gt;So at SQL Bits I went to &lt;a class="link" href="http://sqlbits.com/Speakers/Chris_Testa-O_Neill" target="_blank" rel="noopener"
&gt;Chris Testa-O’Neill’s&lt;/a&gt; session on certification. This has inspired me to start working on passing the MCSE exams. My PC at home doesn’t have much grunt and my tablet wont run SQL. I considered some new hardware but I knew I would have a hard time getting authorisation from the Home Financial Director (Mrs F2B) despite my all the amazing justification and benefits I could provide!!&lt;/p&gt;</description></item><item><title>Documenting SQL Server the easy way with Power Doc</title><link>https://blog.robsewell.com/blog/documenting-sql-server-the-easy-way-with-power-doc/</link><pubDate>Thu, 09 May 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/documenting-sql-server-the-easy-way-with-power-doc/</guid><description>&lt;p&gt;You know how it is. Question questions questions. As a DBA you are the fount of all knowledge. You are the protector of the data after all so obviously you know every little thing that is needed to be known.&lt;/p&gt;
&lt;p&gt;Frequently, I am asked&lt;/p&gt;
&lt;p&gt;How many processors does that server have?&lt;br&gt;
How much RAM is on that server? What type?&lt;br&gt;
What OS? Which Patches were installed&lt;/p&gt;
&lt;p&gt;or more SQL based questions about configuration&lt;/p&gt;</description></item><item><title>12 Things I learnt at SQLBits XI</title><link>https://blog.robsewell.com/blog/12-things-i-learnt-at-sqlbits-xi/</link><pubDate>Tue, 07 May 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/12-things-i-learnt-at-sqlbits-xi/</guid><description>&lt;ul&gt;
&lt;li&gt;
&lt;h3 id="the-quality-of-the-speakers-and-sessions-is-exceptional"&gt;The quality of the speakers and sessions is exceptional
&lt;/h3&gt;&lt;p&gt;&lt;a class="link" href="http://sqlbits.com/information/Agenda.aspx" target="_blank" rel="noopener"
&gt;http://sqlbits.com/information/Agenda.aspx&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;h3 id="the-helpers-are-awesome"&gt;The Helpers are awesome
&lt;/h3&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a class="link" href="https://i2.wp.com/sqldbawithabeard.com/wp-content/uploads/2013/05/clip_image001.jpg" target="_blank" rel="noopener"
&gt;&lt;img src="https://i1.wp.com/sqldbawithabeard.com/wp-content/uploads/2013/05/clip_image001_thumb.jpg?resize=313%2C502"
loading="lazy"
alt="clip_image001"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h3 id="often-sessions-fill-up-very-quickly--get-there-early"&gt;Often Sessions fill up very quickly – Get there early
&lt;/h3&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a class="link" href="http://t.co/y2S9IDnama" target="_blank" rel="noopener"
&gt;&lt;img src="https://i2.wp.com/sqldbawithabeard.com/wp-content/uploads/2013/05/clip_image002.jpg?resize=372%2C211"
loading="lazy"
alt="clip_image002"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h3 id="the-guidebook-app-is-pretty-good-but-with-a-map-it-would-be-better"&gt;The GuideBook app is pretty good but with a map it would be better
&lt;/h3&gt;&lt;p&gt;&lt;a class="link" href="http://guidebook.com/" target="_blank" rel="noopener"
&gt;http://guidebook.com/&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;h3 id="you-can-learn-as-much-outside-of-the-sessions-as-you-can-in-them"&gt;You can learn as much outside of the sessions as you can in them
&lt;/h3&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a class="link" href="https://plus.google.com/photos/109984741094039234638/albums/5874913179986208577" target="_blank" rel="noopener"
&gt;&lt;img src="https://i2.wp.com/lh6.googleusercontent.com/-3d8PCx0AlFA/UYfqxH0fHhI/AAAAAAAAd-E/k_EnX5cpOZY/w960-h641-no/DSC_5670.JPG?resize=622%2C415&amp;amp;ssl=1"
loading="lazy"
&gt;&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h3 id="there-are-amazing-prizes"&gt;There are amazing prizes
&lt;/h3&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a class="link" href="https://www.facebook.com/photo.php?fbid=599765410034832&amp;amp;set=pb.330145840330125.-2207520000.1367904819.&amp;amp;type=3&amp;amp;theater" target="_blank" rel="noopener"
&gt;&lt;img src="https://i0.wp.com/fbcdn-sphotos-c-a.akamaihd.net/hphotos-ak-snc6/602577_599765410034832_674054200_n.jpg?resize=616%2C392&amp;amp;ssl=1"
loading="lazy"
&gt;&lt;/a&gt;&lt;/p&gt;</description></item><item><title>Powershell won’t save when running as a scheduled job</title><link>https://blog.robsewell.com/blog/powershell-wont-save-when-running-as-a-scheduled-job/</link><pubDate>Tue, 07 May 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/powershell-wont-save-when-running-as-a-scheduled-job/</guid><description>&lt;h3 id="or-how-sqlbits-put-me-in-touch-with-laerte-and-solved-a-problem"&gt;Or, How SQLBits put me in touch with Laerte and solved a problem
&lt;/h3&gt;&lt;p&gt;I have a scheduled Powershell job which I use to create an Excel file colour coded for backup checks. (I will blog about it another time) It works brilliantly on my desktop and saves the file to a UNC path and emails the team the location. It works brilliantly when run in Powershell on the server. When I schedule it to run though it doesn’t do so well. The job completes without errors but no file is saved.&lt;/p&gt;</description></item><item><title>Those Pesky ‘s</title><link>https://blog.robsewell.com/blog/those-pesky-s/</link><pubDate>Mon, 11 Feb 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/those-pesky-s/</guid><description>&lt;h3 id="changing-domain-names-in-a-column"&gt;Changing Domain Names in a Column
&lt;/h3&gt;&lt;p&gt;A quick little post for today. Not particularly SQL related but the points at the end are relevant.&lt;/p&gt;
&lt;p&gt;I had a task when moving a service to a new development area to change the domain name within columns in several tables from “DOMAIN1\USER” to “DOMAIN2\USER”&lt;/p&gt;
&lt;p&gt;In SQL I was able to do this quite easily as follows&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;USE [DATABASENAME]
GO
-- Declare variables
DECLARE @Live nvarchar(10)
DECLARE @Dev nvarchar(10)
-- Set the variable to the Domains
Set @Live = 'Live Domain'
Set @Dev = 'Dev Domain'
--Update tables
UPDATE [TABLENAME]
SET [User] = REPLACE([User], @Live, @Dev)
GO
UPDATE [TABLENAME]
SET [Group] = REPLACE([Group], @Live, @Dev)
GO
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I also had to do the same for some Oracle databases too and this is where the fun started!&lt;/p&gt;</description></item><item><title>You Have To Start Somewhere</title><link>https://blog.robsewell.com/blog/you-have-to-start-somewhere/</link><pubDate>Sun, 10 Feb 2013 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/you-have-to-start-somewhere/</guid><description>&lt;img src="https://blog.robsewell.com/assets/uploads/2013/02/medium_33194896_thumb.jpg" alt="Featured image of post You Have To Start Somewhere" /&gt;&lt;p&gt;![medium_33194896]({{ &amp;ldquo;/assets/uploads/2013/02/medium_33194896_thumb.jpg&amp;rdquo; | relative_url }})&lt;/p&gt;
&lt;p&gt;The hardest part is looking at the blank page and beginning to type. It’s much easier to go and play with the settings of the site, to look at plugins and other cool things. The only other blog I have written was &lt;a class="link" href="http://wombatsdojogle.wordpress.com" target="_blank" rel="noopener"
&gt;http://wombatsdojogle.wordpress.com&lt;/a&gt;. This was a little easer as there was always ‘something’ that needed to be written about. Whether it was training or route planning or every day on the road I had material and an obvious thing to write.&lt;/p&gt;</description></item><item><title>Post: Chat</title><link>https://blog.robsewell.com/blog/post-chat/</link><pubDate>Fri, 08 Jan 2010 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/blog/post-chat/</guid><description>&lt;p&gt;Abbott: Strange as it may seem, they give ball players nowadays very peculiar names.&lt;/p&gt;
&lt;p&gt;Costello: Funny names?&lt;/p&gt;
&lt;p&gt;Abbott: Nicknames, nicknames. Now, on the St. Louis team we have Who&amp;rsquo;s on first, What&amp;rsquo;s on second, I Don&amp;rsquo;t Know is on third&amp;ndash;&lt;/p&gt;
&lt;p&gt;Costello: That&amp;rsquo;s what I want to find out. I want you to tell me the names of the fellows on the St. Louis team.&lt;/p&gt;
&lt;p&gt;Abbott: I&amp;rsquo;m telling you. Who&amp;rsquo;s on first, What&amp;rsquo;s on second, I Don&amp;rsquo;t Know is on third&amp;ndash;&lt;/p&gt;</description></item><item><title>git</title><link>https://blog.robsewell.com/git/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/git/</guid><description/></item><item><title>Links</title><link>https://blog.robsewell.com/links/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/links/</guid><description/></item><item><title>Search</title><link>https://blog.robsewell.com/search/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/search/</guid><description/></item><item><title>Twitter</title><link>https://blog.robsewell.com/twitter/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.robsewell.com/twitter/</guid><description/></item></channel></rss>